..:;.
t'>J
           1 OOOOOOI             PROGRA14 CNS30                                                                ,
        FORTRA'l VI!D: LIC:NSEO R:STR!CT:O RIGHTS AS STATED IN LICENSE •••••••••~•••••••, SEE OO~MENTATION PACKAGE, 04-1011499 •

           2            C         SY: Y. S. CHEN         CN: 8/13/1985                                       2
           3            C                                                                                    3
           4            C•••••( CLRVILIN!AR N-S CODE FO~ 3-0 INCOMPR:SSIBLE F~O~S l•••••••••••               4
           5            C                                                                                    5
           6 000006I             COMMON                                                                      6
           7                   1/VAR/UC21,1S,1C),V(21,18,10l,P(21,18,10),0KC2f,18,1Cl,                       7
           8                   2 OE(21,18,1Cl,ERRU,ER,V,E~RM,ERRK,ERRE,:RRW,                                 8
           9                   3 PF(21,18,10),W(21,18,10),TM(21,13,10)                                       9
         10                    1/?RCP/ VIS:C21,18,10),CENC21,18,10),VISC,D!NIN,FLOWIN                       10
         11                    1/PCCR/ CU{21,18,10l,DV(21,18,10l,OWC21,18,10)                               11
         12                    1/TUR/ S:GK,SIGE,CMU,C1,C2,CMU1,CMU2,:,CK,HINUM,SMNU14,ANV1C800l,            12
         13                    2 YN(30Gl,YN1CeOCl,SINX(800),SINY(300l,SINZ(80Cl,ANw1(300),                  13
         14                    3 YPLN(2CO),T~UN(800l,:ecceOO),J3C(300l,K3C(800l,IITY(800),                  14
         15                    4 TiLwC!COl,G2NC21,13,1C),MCC21,18,10)~1JLOC21,1S,1C),!ITO                   15
         16                    1/COEF/ A°C21,18,10),SUC21,18,10),SPC21,18,10l,SUKC21,18,10>,                16
         17                    2     SFKC21,18,10),AEC21,18,1Q),Aw(21,18,10),ANC21,18,10l,                  17
         18                    3     ASC21,1!,10),AT(21,18,10),A3(21,1e,1G),APC(21,1!,10)                   18
         1 9 000006I             COM,-ON                                                                    19
         20                    1/T~AN/ XC21,18,10l,YC21,15,10l,ZC21,18,10),TJOC21,1~,10),                   20
         21                    2    CXC21,18,10l,CYC21,18,10l,CZC21,1S,1~l,                                 21
         22                    3     EXC21,13,10),EYC21,1S,10l,EZC21,18,1Cl,                                22
         23                    3    SX(21,13,10l,SYC21,18,1Cl,SZC21,18,1C)                                  23
         24                    1/LIMT/ L,M,LT,MT,L1,L2,,-1,M2,LC,M0,ISWU,ISWV,!SwP,!SWK,ISWE,               24
         25                    2     ALu,,LV,ALP,ILK,ALE,ALVIS,ALW,N,N1,N2,NC,ISww,IG,NT,ALC,DTT            25
         26 000006I              COMMC"'I                                                                   26
         27                    1/TTRAN/TXXEC21,18,10l,TXXW(21,18,1Cl,TYYNC21,18,1Ql,                        27
         28                    2     TYYSC21,1e,1Cl,TZZTC21,18,10l,TZZSC21,18,10),                          28
         29                    3     TYXE(21,1e,10>,TYXW(21,1o,10),TYZT(21,18,10),                          29
         30                    4     TYZSC21,18,1C),TXYNC21,1B,10),TXYSC21,18,10),                          30
         31                    5     TXZTC21,1S,1C),TXZBC21,18,10),TZXEC21,18,10),                          31
         32                    6     TZXwC21,18,1C),TZYNC21,18,10),TZYSC21,18,10l                           32
         33                    1/UNSTOY/U0C21,1S,1Cl,VCC21,13,1C),~OC21,18,10),0KOC21,18,1Cl,               33
         34                    2    CEOC21,18,10),DENOC21,18,10)~TMOC21,18,10)                              34
         35 000006I              LOGICAL !NSCU,INSOV,INSCP,INSOK,INSCE,INPRO,INSOW,INSOT                    35
         36             C•••••[ I~PUT ~ATA GU!aE ]********************************************              36
         37                                                                                                 37
         38             C NLIMT        MAXIMUM NO. OF !TtRATIONS LIMIT                                      38
         39             C                                                                                   39
         40             C   IG      = 1     LAMINA~                                                         40
         41             C              2    TU~SUL:NT C~-E ~Cb5Ll                                           41
         42             C                                                                                   42
         43             C ISwP         NO. o~ SWEE?S FOR SOLVING THE?' E,uATION (PP).                       43
         44             C                                                                                   44
         45             C ITT          TCTAL NO. CF TIME STEPS.                                             45
         46             C                                                                                   46
         47             C ALU,ALV,AL~,ALP,ALK,ALE,ALVIS,ALC         UNDER-RELAXATION FACTORS                47
         48             C                                                                                   48
         49             C   RE NL      R:FERENCE QEYNOLOS NUMBER.                                           49
         50             C                                                                                   50
         51             C OTT          TIME ST:P FOR UNSTEACY PROBLEMS.                                     51
         52             C                                                                                   52
         53                                                                                                 53
         54
         55 0000061
         56 OOC030I
                        c-----!NP~T DATA (P~OeL:M CONTROL SETTING)
                                 REACCS,100) NLIMT,IG,ISW?,ITT
                                 QEAC(5,20Cl ~LU,ALV,ALW,ALP,ALK,ALE,ALVIS,ALC
                                                                                                            54
                                                                                                            55         ,
                                                                                                            56       2
         57 00006CI              QElCCS,200) ~ENL,DTT                                                       57       3
 58                C-----CONSHNTS                                                           58
 59    000090I            ER:XT=1.:-3                                                       59     4
 60    00009CI            ISWL=7                                                            60     5
 61    0000A4I            ISWV=7                                                            61     6
 62    OOOOACI            rsw .. =7                                                         62     7
 63    oooog4I            ISWK=5                                                            63     8
 64    OOOOBCI            IS.iE=5                                                           64     9
 65    OOOOC4I            DENIN=1.0                                                         65    10
 66    OOOODOI            VISC=1./~ENL                                                      66    11
 o7    OOOOE2I            SIGL=1.C                                                          67    12
 68    JOOOEEI            SIGK=1.C                                                          68    13
 69    OOOO!=AI           SIGE=1.3                                                          69    14
 70    000106I            CMU=0.09                                                          70    15
 71    000112!            C1=1.43                                                           71    16
 72    OJ011E!            C2=1.92                                                           72    17
 73    ,JQ012AI           E=9.C1Ce9                                                         73    18
 74    00013/JI           CK=C.4                                                            74    19
 75    QJ,)142!           ?!=3.141592654                                                    75    20
 76    00014:I            riI ... LM=1. i:3C                                                76    21
 77    00015AI            SMNLM=1. E-30                                                     77    22
  78   OOJ166I            C.MU1=Cl"L.**0.25                                                 78    23
  79   QQ,J17::I          CMU2=Cl"L**D.75                                                   79    24
  80   00019:.I           :NSCU=.TRUE.                                                      80    25
  81   00019:I            INSCV=.T'lUE.                                                     81    26
  82   :JOOH6I            :NSCP=.TRU:.                                                      82    27
  83   OOCHc!             INSCK=. TRU: •                                                    83    28
  34   00018/JI           !NSCE=.TQUE.                                                      84    29
  85   OO·JBEI            INPl;O=.TRUE.                                                     85    30
  36   0001C6I            INSC~=.T'lUE,                                                     86    31
 87    0001CEI            INSCT=,FALSE.                                                     87    32
 88    OOC106I            IF(IG ,EQ, 2) GC TO 10                                            86    33
  e9   0001:CI            INSCK=.FALSE,                                                     89    35
 90    0001F4I            INSCE=,FALSE,                                                     90    36
  91   0001FC!            IN?RO=.FALSE.                                                     91    37
 92    OOC2G4I       10 CONT!NLE                                                            92    38
  93               C•***•CR:AD I~ INITIAL FLOW FIEL~S FROM RESTART FILE (LU= 8)]********    93
  94   0002C4I            QEAC(8,100) L,M,N,L1,L2,M1,M2,N1,N2                               94    39
 95    000244!            LO=L+1                                                            95    40
  96   000252I              MQ=f,'+1                                                        96    41
 97    000260!              N0=N•1                                                          97    42
  98   00026EI              LT=L-1                                                          98    43
  99   00027CI              MT=f,'-1                                                       ~99    44
100    00028AI              NT=t-,,-1                                                      100    45
1 01               (-----INITIALIZE VAQIA6LES                                              1 01
102    OQC298I            CALL INIT                                                        102    46
103                C-----RESTART FILE                                                      103
104    0002ADI             DO 50 K=1,N                                                     104    47
105    000264!            DO 50 I=1,L                                                      1 05   48
106    0002C!3I           REAC(8,400J                                                      106    49
107    0002E4I             DO SO J=1,'°                                                    107    so
10!3   0002F8I             REAC(8,S00) XCI,J,K),Y(I,J,K),Z(I,J,K),U(I,J,K),V(I,J,K),       108    51
109                     1 W(I,J,K),P(I,J,K),TM(I,J,K),OK(I,J,K),OE(I,J,K),                 109
110                     2    VIS!:T'°, □ ENTM                                              110
111    000538!              UO(I,J,K)=UCI,J,K)                                             111    52
112    000604!              VO(I,J,K)=V(I,J,K)                                             112    53
113    000650!              WQ(I,J,K)=WCI,J,K)                                             11 3   54
114    00069CI              TMO(I,J,K)=T~(I,J,K)                                           114    55
11 5   G006E8!            O~OCI,J,Kl=CK(l,J,K)                                              11 5    56
11 6   0007341            OEO(l,J,Kl=D:CI,J,~)                                              116     57
11 7   0007.SOI           OENC(:,J,K)=O:N(l,J,K)                                            117     58
11 8   O,J07CC!      SO   CO'-TINUE                                                         118     59
119                                                                                         119
120                C-----GET 5CU~OARY CONTROL PARA~ETERS                                    120
1 21   0008141            CHL DIRCOS                                                        121     60
122                C-----S:T :!OU~CARY TUR9ULENC: ~WANTITlES TO ZE~O                        1 22
123    00081C!             DO 121 I=1,L                                                     1 23    61
124    OOC:S30!            co 121 J=1,,'1                                                   124     62
125    ,JQC844l           ;JO 121 K=1,N                                                     125     63
1 26   JJC~56I            !F(~C(I,J,Kl .~:. Cl GC TO 122                                    126     64
127    OJ0:33El           ;;o TO 1,1                                                        127     66
12a    QJJa04I      122 ~~CI,J,K)=C.O                                                       129     67
129    JJOSCOI            8:c(I,J,K)=C.'l                                                   1 29    63
1 30   JJOd!:CI           uCI,J,O=G.O                                                       130     69
131    0J0918!            V(I,J,l()=C.O                                                     131     70
1 32   00CY44I            wC!,J,0=0.C                                                       132     71
1 33   OOC970I      121 co ... r:r--i.:::                                                   133     72
134                C-----CALCULATE G~!D T~4NS~JRMATIO~ CC:FF!CI!~TS                         134
1 35   ,J0095!!I          CA._L T.iANF                                                      135     73
136                C-----T~Q~UL:NT VISCCS!TY                                                1 36
137    OQ09C0l             :FCI~P,C) CALL N:~VIS                                            137     74
1 38               ~-----C~LCULAT: INL:T !"ASS FLCw ~l~E                                    138
1 39   QJC9Q4!             ~Lc~:f\.=C.O                                                     1 39    76
140    0009:0l            r =1                                                              140     77
141    OO•J~:81           CJO 45 J=2,1"                                                     1 41    78
1 42   OOJ9FCI            CO 4; K=2,N                                                       142     79
14 3   000A10l            UC=(U(l,J,K)+t,;(I,J-1,K)+U(I,J,K-1 )+U(I,J-1,K-1))•0.25          143     80
144    OOCACOl            CENC=(C:NCI,J,Kl+JEN(I,J-1,Kl+CEN(I,J,~-1)+CEN(l,J-1,K-1))•0.25   144     81
145    000:!701           ?1=(X(I,J,K)+X(I,J,K-1)-X(I,J-1,K)-X(I,J-1,K-1))•0.5              145     82
146    OCOC20I            ?2=(Y(!,J,K)+Y(I,J,K-1l-Y(:,J-1,K)-Y(I,J-1,K-1))•0.5              146     83
147    OOOC DO l          P3=CZ(!,J,K)+Z(I,J,K-1l-ZCI,J-1,Kl-ZCI,J-1,K-1))•G.5              147     84
148    0000801            Q1=(X(I,J,K)+X(I,J-1,K)-X(!,J,l(,__-1)-X(I,J-1,K-1))•0.5          148     85
149    OOOE30l            ~2=(Y(!,J,K)+YCI,J-1,K)-Y(I,J,K-1)-Y(I,J-1,K-1l)•0.5              149     86
150    OOOE:Ol             ~3=(Z(I,J,~)•Z(I,J-1,Kl-ZCI,J,K-1)-ZCI,J-1,K-1l)•0.5             1 50    87
1 51   OOOF90I             AR:A=SCNT(P1•?1+?2•P2+P3•P3)*SCRT(C1•Q1+~2•~2+C3•C3)             1 51    88
152    00102Cl             FLO~IN=FLOWI~•DENC•AQEA•UC                                       152     89
153    00104A!        45 CONTINUE                                                           153     90
154    00107A!             ITC= 1                                                           154     91
1 55               C-----T~~~SIS~T PROCESS                                                  155
156    0010321        2    CCNTINL:E                                                        156     92
157    001082!             CALL SY~CUT(3,1,2,L,2,~,2,N'                                     157     93
1 58   00100Cl             IT:R=1                                                           1 58    94
159                c-----soL~TIC~ PROCcOL:R=:S START                                        159
160    0010E4I        1   CONTINI.::                                                        160     95
161    0010:41             CALL SY~OUT(1,1,2,LT,2,~T,2,NT)                                  1 61    96
162    J01140l             !F(lNSCUl CALL 50LVECC1,ISwU,ALU,SIGU,ERRU,U,UCl                 162     97
163    ]01184!             !FCINSCV) CALL SOLVE~CZ,ISWV,ALV,SIGU,ERRV,V,VO)                 163     99
164    0011car             IFCINSC~) C~LL S0LVE~(3,ISWW,~LW,S!GU,ERRW,W,WC)                 164    101
165    00120Cl             IFCINSCT) CALL SCLVcQC4,ISWW,ALW,SlGU,ER~W,TM,TM0)               165    103
1 66   0012501             IFC!NSCK) CALL SCLV:0(5,ISWK,ALK,SIGK,ERRK,CK,CKO)               166    105
167    J01294I             IF(INSOEl CALL SCLVEQ(6,lSW:,ALE,SIGE,ERRE,OE,OE0)               167    107
168    0012081             IF(INSC?) CALL SOLvEQCJ,ISWP,ALP,SIGU,ERRM,PP,PP)                168    109
169    00131Cl             !FCINPNCl C~LL NEWVIS                                            169    111
170                C-----CCNVERG:NCE C~ECK                                                  170
1 71   JC133Jl             W~ITEC6,30C) !TER,ERRU,ER~V,!RRW,ERRM,ERRK,ERRE,U(7,2,6)         171    11 3
172    00136CI             ::,QMAX=E••M+=RRU+ERKV+ERRW                                                 172    11 4
173    00138:.I            IFCITER .GE. 2C .AND. ERRMAX .GT. 1.E03) GO TO 99                           173    11 5
174    001332!             IF(ITER .GE. NLIMT .CR. ERR~AX .L~. EREXT) GO TO 99                         174    11 7
175    0013ClC I           ITEil=ITER+1                                                                17 5   11 9
176    0013EAI             GO TO 1                                                                     176    1 20
177                C-----P,I~T CLT SCLUTIONS                                                           1 77
1 78   OJ13E:I         99 CONT!Nl.i:                                                                   178    1 21
179    0013:Er             ~QITE(7,1QC) L,1',N,L1,L2,M1,M2,N1,N2                                       179    122
1 ao   00142C!             DD 901 K=1,N                                                                180    123
1a1    0014401             CO S01 !=1,L                                                                1 81   1 24
132    0014541             wRIT0:<7,t..00)                                                             132    125
133    0014701             CO 902 J=1,M                                                                183    126
1 84   001484!             XV=XC!,J,Kl                                                                 184    127
135    001430!             YV=YCI,~,O                                                                  185    128
1 36   J014JCI             ZV=ZC:,J,Kl                                                                 1E6    129
187    001505!             ~RIT=C7,50C) XV,YV,ZV,U(!,J,KJ,VC!,J,~),W(I,J,~),?(I,J,K),                  187    130
198                                     -rcr,J,~).~K(I,J,K),QE(I,J,Kl,VISECI,J,Kl,DENCI,J,K)           188
189    0016E3I         902 CC~-:"If\Li:                                                                1 89   131
1 90   00170Cr         901 COi\ T!~L:                                                                  190    132
1 91   JQ1730I             r:~T=clTT•!TO                                                               1 91   133
192    0017441             WRITEC7,3CGl ITC,T!~T                                                       192    134
193    :017631             !F(ITO .GE. ITT .OQ. OTT .E~. C.0) GO TO 999                                1°3    135
1 94   QJ1792I             ITC=ITC~1                                                                   194    137
195    0017AO:             GO TO 2                                                                     195    138
1 90   OQ17HI       S99 CONT!Nl.E                                                                      1 96   139
197    OJ17A4I      1'.JO FQ~r,oAT(9I5l                                                                197
H8     001730I      2'.JO FCRMAT(11F7.4)                                                               198
199    00175::!     300 FJR1"AT(1X,!5,7::10,2)                                                         199
200    OC17COI      400 FORl'ATC//l                                                                    2GO
201    0017Ll.H     500 FORl'lT(3F5.4,3:12,4,2X,6:11,4)                                                201
202    001 U6I             STOP                                                                        202    140
203    0017": I            E~Ll                                                                        203    141
NO E~RORS:F7D QOS-01.0C l'A!NOROG       CNS3C     02{21/86 09:45:56          TA6LE" SPACE:     11 KB
STATEMENT 3UFFER:   20 LINES/1321 6YT:S     STACK SPACE: 181 wOROS
SINGL: PRECISION FLOATING PT SUOPORT QE~UIREC FO~ :XECuTION
 1    oooooor                SUBROUTINE DIRCCS                                                 204
 2    000004I               COM"ON                                                             205
 3                        1/TUR/ SIGK,SIGE,CMU,C1,C2,CMU1,CMU2,E,CK,MINUM,SMNUM,ANV1(800),     206
 4                        2 YN(8GC),YN1(80C>,SINX(800),SINY(80C),SINZ(B00),ANw1(800),          207
 5                        3 YPLNCSC0),TAUNC800l,IBC(800),JSC(800),K6C(800>,IITY(800l,          208
 6                        4 TA~W(800),GEN(21,18,10l,MCC21,18,1Cl,IJL0(21,18,10l,IITO           209
 7                        1/TRAN/ X(21,18,10l,Y(21,18,10l,Z(21,1S,1Q),TJ0(21,1!!,10),          210
 8                        2      CXC21,18,10l,CY(21,18,1Cl,CZC21,1S,1C),                       211
 9                        3      EX(21,13,10),EY(21,18,10>,EZ(21,18,10l,                       212
10                        3      SX(21,18,10),SYC21,16,1Cl,SZC21,1S,1C>                        213
11                        1/LI~T/ L,M,LT,"T,L1,L2,M1,M2,LC,MO,ISWU,ISWV,ISWP,ISWK,ISWE,        214
12                        2      ALU,ALV,ALP,ALK,ALE,ALVIS,ALW,N,N1,N2,N0,ISkW,IG,NT,ALC,OTT   215
13                 c-----SET CC"AIN aLOCKAGE CONTROL PARAMETER                                 216
14                 C-----SCALAR :LOCKiG~ :        MC(I,J,K):1                                  217
15                 C-----PRESSURE 3LOC~AGE : MC(I,J,K)=2                                       218
16    ·J'.l0004I            QO 1C I=1,LO                                                       219     1
17    00u01BI               DO 10 J=1,:-t0                                                     2 20    2
1!!   00002CI               CO 10 K=1,NC                                                       221     3
19    OD0040I               MC(I,J,Kl=O                                                        222     4
20    000068I               !F(J,EC,1,0R,J,E:,".OR.K.E~.N) MCCI,J,K)=1                         223     5
21    OGOOC4I               !F(I,GE,L1,ANO,I,LE,L2.ANO,J,GE,M1,AND,J,LE,M2,ANO,                224     7
22                        1      K,GE.N1,ANO,K,LE,N2) MC(I,J,K)=1                              2 25
23    000158I               IF(I,GT,L1,ANO.I.LE,L2,A~D.J.GT.M1.AND.J,LE,M2,AND,                226     9
24                        1      K,GT,N1,ANO,K,LE,N2) MCCI,J,K)=2                              2 27
25                 C-----ADQ 5LCCKAGES A~ NE:~EC HER:                                          228
26    0001:'CI       10 CONTINUE                                                               229    11
27                 C-----CALCULATE BOUNDA~Y GRIC SIZES AND ORIENTATIONS                        230
28    OD0234I               I II =1                                                            231    12
29    00023CI               DO 30 I=2,LT                                                       2 32   13
30    000250I               DO 30 J=2,MT                                                       233    14
31    000264I               00 30 K=2,NT                                                       2 34   15
32    000278I               IF(MCCI,J,K) ,Ne, 0) GO TO 30                                      235    16
33    0002AEI               MCT=MC(I+1,J,Kl+MC(I-1,J,K)+MCCI,J+1,Kl+MC(I,J-1,K)+               236    18
34                        1       MC(I,J,K+1)+MCCI,J,K-1)                                      237
35    0003ACI               Ir(MCT .EC. Ol GO TO 3C                                            238    19
36    0003C2I               IF(~CCI,J+1,K) ,EQ. 0) GO TO 2                                     239    21
37                 C-----NORTH                                                                 240
38    0003FCI               IBC<III>=I                                                         241    23
39    000410I               JSC(III)=J                                                         242    24
40    OO,J424I              KSCCIII)=K                                                         243    25
41    000438!               IITY(III>=1                                                        244    26
42    000448I               I1=I+1                                                             245    27
43    000456I               I2=I-1                                                             246    28
44    000464I               K1=K+1                                                             247    29
45    000472!               K2=K-1                                                             248    30
46    000480!               I"(I .EC:, L 1) I2=I                                               249    31
H     00049EI               IF(I ,EC:. L2) I 1 =I                                              250    33
48    0004SCI               IF(K .!:~. N1) K2=K                                                251    35
49    0004CAI               IF(K ,!:C:, N2) K1=K                                               252    37
50    0004F8I               J1=J-1                                                             253    39
51    000506I               J2=J-2                                                             2 54   40
52    00051'.I              P1=(Y(I1,J,K1)-Y(I1,J,K2))•CZCI1,J,K2)-ZCI2,J,K))-                 255    41
53                        1      CZ(I1,J,K1)-Z(I1,J,K2))*(Y(I1,J,K2)-YCI2,J,K))                256
54    000650I               P2=CZCI1,J,K1)-Z(I1,J,K2l)•(X(I1,J,K2)-XCI2,J,K))-                 257    42
55                        1      (X(I1,J,K1)-X(I1,J,K2l)•CZ(I1,J,K2)-Z(I2,J,K))                258
56    00078CI               P3=(X(!1,J,K1)-X(I1,J,K2)l•(Y(I1,J,K2)-Y(I2,J,K))-                 259    43
57                        1      (Y(I1,J,K1)-Y(I1,J,K2ll•(X(I1,J,K2)-X(I2,J,K))                260
       58    0008C8I            PQ=SQRT(?1•P1+P2•P2+P3•P3)                           261    44
       59    000912!            P1=P1/PC                                             262    45
       60    000924!            P2=F2/PC                                             263    46
       61    000936!            P3=P3/PC                                             264    47
       62    000948!            il1=C1.-P1••2)                                       265    48
       63    00096'-I           R2= (1.-P2••2l                                       266    49
       6/o   000980I            R3=C1 .-F3**2l                                       267    so
       65    00099CI            SINXCIII>=SCRTCR1l                                   268    51
       66    0009C2I            SINYCIII)=SQQT(R2l                                   269    52
       67    0009:6!            SINZCI!Il=SCRTCQ3l                                   270    53
       68    OOOAOAI            Q1=XCI,J,K)-X(I,J1,Kl                                271    54
       69    000A5CI            Q2=Y(I,J,K)-Y(I,J1,K)                                272    S5
       70    OOOAAEI            Q3=ZCI,J,K)-ZCl,J1,K)                                273    56
       71    OOCBOOI            AA=SC~T((C1-?1)••2+(C2-P2l••2•(Q3-P3)••2>            274    57
       72    000B7EI            CC=1.0                                               275    58
       73    OOOBSAI            SS=SCRT(Q1•Q1+Q2•Q2+Q3•C3)                           276    59
       74    0:JOBD6I           COT~=(38•8o•CC•CC-AA•AA)/(2•BB•CC)                   277    60
       75    OOOC18I            YNCII1)=23•~3S(COTH)                                 278    61
       76    OOOC44I            Q1=X(l,J,K)-X(I,J2,K)                                279    62
       77    OOGC96I            C2=Y(I,J,K)-YC!,J2,K)                                280    63
       78    QOOCE8I            Q3=Z(I,J,Kl-ZC!,J2,K)                                281    64
       79    OOOD3AI            3B=SQRT(~1•Q1+C2•Q2+Q3•C3i                           282    65
       80    QOOD86I            AA=S:RT({Q1-?1l••2+(C2-?2l••2+(Q3-P3l••2l            283    66
       81    OOOE02I            COT~=(88•8S+CC•CC-AA•AA)/(2•3B•CC)                   284    67
       82    OOOE44I            YN1 {IIIl=CBS•ABi(COTHl+YN(I!Il)•0.5                 285    68
       83    OOOE84I            IJLCCI,J,Kl=!II                                      2E6    69
       84    OOOEBOI            III=II!+1                                            287    70
       85    OOOE5EI      2     CONTINLE                                             288    71
       86    000:BEI            IFC"CCI,J-1,0 • EQ • 0) GO TO 3                      289    72
       87               C-----SOUTH                                                  290
       88    000EF8I            ISCCII!l=I                                           2 91   74
       89    OOOFOCI            JBCCIIIl=J                                           292    75
       90    OOOF20I            KoC(!IIl=K                                           293    76
       91    OOOF34I            I!TYCII!l=2                                          294    77
       92    000F44I            I1=I+1                                               295    78
       93    000F52I            I2=I-1                                               296    79
       94    000"60!            K1=K+1                                               297    80
       95    OOCF6EI            K2=K-1                                               298    81
       96    JOOF7CI            J1=J+1                                               299    82
       97    OOOF8AI            J2=J+2                                               300    83
       98    OOOF98I            P1=(Y(!1,J,K1)-Y(I1,J,~2li•CZ(I1,J,K2)-Z(I2,J,K))-   301    84
       99                     1     CZ(I1,J,K1)-Z(I1,J,K2ll•(Y(!1,J,K2)-y{I2,J,K))   302
      100    001004!            P2=CZ(I1,J,K1l-Z(I1,J,K2))•(X(I1,J,K2)-X(I2,J,K))-   303    85
      1 01                    1     {X(I1,J,K1)-XCI1,J,K2))•CZCI1,J,K2)-Z(I2,J,K))   3C4
      102    001210!            P3=(X(I1,J,K1)-X(I1,J,K2l)•(Y(I1,J,K2)-Y(I2,J,K))-   305    86
      103                     1     (Y(I1,J,K1)-Y(I1,J,K2l)•(X{I1,J,K2)-X(I2,J,K))   306
      104    00134CI            PQ=SCRT(P1•P1+P2•P2+P3•P3)                           307    87
      1 OS   001396!            ?1 =F1 /Pi;.                                         308    88
      106    0013A3I            P2=P2/PC                                             309    89
      1 07   0013BAI            P3=P3/Pi;.                                           310    90
      108    0013CCI            R1=(1.-P1**2)                                        311    91
      109    0013E8I            K2=(1.-P2••2)                                        312    92
      110    001404!            R3=(1 .-P3**2)                                       313    93
      111    001420!            SINXCIII)=SCRTCR1)                                   314    94
      11 2   001446!            SINY(!II)=S:~T(R2)                                   315    95
      113    00146AI            SINZ{lIIl=SC~T(K3)                                   316    96
      114    00148EI            Q1=XCI,J,K)-X{I,J1,~l                                317    97

""'
-:a
.::.   115    OC14!:0I             C2=Y(I,J,K)-Y(I,J1,~)
00                                                                                       318      93
       116    001532!              :3=Z(I,J,K)-Z(!,J1,K)                                 319      99
       117    00158:.r             AA=SORTC(Q1-~1>••2+(~2-?2>••2+(Q3-P3l••2l             320    100
       118    001602!              CC= 1. 0                                              321    1 01
       119    C0160::I             e3=SQRT(Q1•;1•~2•Q2+~3•03)                            322    102
       120    00165AI              COTr=(83•53+CC•CC-AA•AA)/(2•86•CC)                    323    103
       121    OC169CI              YN(III)=B8•ASSCCCTH)                                  3 24   104
       122    OJ1oC8I              Q1=X(!,J,K)-X(I,J2,()                                 325    105
       123    00171.lI             Q2=Y(I,J,K)-Y(!,J2,K)                                 326    106
       124    O:J176CI             Q3=~(!,J,K)-~(!,J2,K)                                 327    107
       125    00173':I             63=SQ~T(~1•C1+;2•Q2+J3•C3l                            3 28   108
       126    00130A!              A~=SC~T((;1-P1l••2•C~2-P2)••2+(C3-P3)••2)             329    109
       127    o.:.1aaor            COT~=(32•5S•CC•CC-AA•AA)/C2•36•CC)                    330    110
       128    J·:18C8I             Y~1CIIIl=C3S•~SSCCCT~l•YN(I:I)l•0.5                   331    111
       129    ,J019·J3I            IJLC<I,J,O=:r:                                        332    11 2
       130    J•J1934I                                                                   333    113
       131    J:)1942I        3    CONT!Nl.E                                             334    114
       132    ·JJ1 ~.:.2r          .~c~cc:•1,J,~>   .::o. o> ~o ~c   4                   335    11 5
       1 33                 C-----EAST                                                   336
       134    JJ1,7CI              I:lCCr!Il=I                                           337    117
       135    DCn,'.l!             JSC(Eil=J                                             338    11 3
       136    C J19M4I
               1
                                   ~3CCII:l=K                                            339    11 9
       137    C,Jl 9S8:            I:TYC:!!)=3                                           340    120
       1 38   Ou19C3I               J1=~•1                                               341    1 21
       1 39   :::01 9DOI            J2=J-1                                               342    122
       140    0019E4I               ~1=K+1                                               343    123
       141    0019F2!               K2=K-1                                               344    124
       11.2   JC1AJ']I              I=(J .E:. Ml) J2=J                                   345    125
       143    001A1EI               IF(J .E;. ~2) J1=J                                   346    127
       144    OJ1A3C!               iC(K .EC. N1) K2=K                                   347    1 29
       145    ·JC1ASAI              IF(K .cC. ~2) Kl=K                                   348    131
       146    '.J01A78I             I1=I-1                                               349    133
       147    001ASoI               I2=I-2                                               350    1 34
       148    001 A94I              P1=CYCI,J1,K1)-Y(I,J1,K2))•(ZCI,J1,K2l-Z(I,J2,Kl)-   3 51   135
       149                        1     (ZCI,J1,K1)-Z(I,J1,K2))•(Y(!,J1,K2)-Y(I,J2,K))   352
       150    00150•]!              P2=CZCI,J1,K1)-ZCI,J1,K2l)•(X(I,J1,K2)-X(I,J2,K))-   353    136
       1 51                       1     (X(I,J1,K1)-X(I,J1,K2)l•(Z(I,J1,K2)-ZCI,J2,K))   354
       152    OG1J:JC!              P3=(X(I,J1,K1)-XC!,J1,K2ll•(Y(I,J1,K2)-YCI,J2,K))-   355    1 37
       1 53                       1     (Y(I,J1,K1)-Y(!,J1,K2ll•(X(I,J1,K2)-X(I,J2,K))   356
       154    J01 ':43I             PQ=SC~T(P1•P1+P2•P2+P3•P3l.                          357    138
       155    JJ1:92I               P1=F1/Pr;.                                           358    139
       156    001EA4I               P2=P2/PC                                             359    140
       157    OOH3oI                ?3=F3/FC                                             360    141
       158    OJ1 ECSI              R1=(1 .-F1••2)                                       361    142
       159    001!::4!              'l2=(1.-P2••2)                                       3 62   143
       160    '.l01 FOO!            Q3= (1.-~3--2)                                       363    144
       161    001F1CI               S!NXCIIIl=S;RT(Rll                                   364    145
       162    001F42I               SINYCIII)=S;QT(Q2)                                   365    146
       163    O·J1 F60 I            SINZ(III)=SQqT(R3)                                   366    147
       164    001F3AI               C1=X(!,J,K)-X(I1,J,K)                                367    148
       165    001FwCI               C2=YCI,J,K)-YCI1,J,K)                                368    149
       166    00202EI               03=Z(I,J,K)-ZCI1,J,K)                                369    150
       167    0020301               AA=SCRT((Q1-P1l••2+(Q2-P2)••2+(C3-P3)••2)            370    1 51
       168    0020FEI               CC=1.0                                               371    152
       169    J'.)21 OAI            S9=SC~TCC1•C1•C2•Q2+Q3•Q3l                           372    153
       170    0021561               COT~=(:2•a2•cc•CC-AA•AA)/(2•3B•CC)                   373    154
       171    002198!               YN(I!!l=aa•A3S(CCT~)                                 374    1 55
172    0021C4I              C1=X(I,J,Kl-X(I2,J,Kl                              375    156
173    002216!              CZ=YCI,J,Kl-YCI2,J,K)                              376    157
174    002263!              03=ZCI,J,Kl-ZCI2,J,K)                              377    158
175    00228AI              aa=SCRTC01•01+C2•C2+03•C3)                         378    159
176    002306!              AA=SCRTCCC1-P1l••2+CQ2-?2l••2+CC3-P3>••2>          379    160
177    002382!             CCT~=cea•aB+CC•CC-AA•AA)/C2•6B•CC)                  380    1 61
178    0023C4I              YN1CIIIl=CBS•ABSCCOTH)+YNCIIIll•0.5                381    162
179    002404!              IJLCCI,J,K)=III                                    382    163
180    002430!              III=III+1                                          383    164
181    00243:I       4     CONTINUE                                            384    165
182    00243EI              r=c~C(I-1,J,K) .:o. 0) GO TO 5                     385    166
1 83               C-----li::ST                                                386
184    002478!              I5CCI!!l=I                                         387    168
135    00248CI             JHC!IIl=J                                           388    169
186    0024AO~             KoCCIIIl=K                                          389    170
137    0024B4I              IITYCIII)=4                                        390    171
188    J024:4I              J1=J+1                                             391    172
189     JJ2402I             J2=J-1                                             392    173
190    )024:0I             '<. l =K + 1                                        393    174
191    OOZ~EEI             K2=K-1                                              394    175
192    OJ24FC!             !FCJ .:;. ~1) J2=J                                  395    176
193    '.l0251 H            IF(J .EC. ~2l J1=J                                 3 96   178
194    002538!              IF(K .E~. N1) K2=K                                 397    1 80
195    0025SoI              IF(K .EC, N2l K1=K                                 398    182
196    002574I           I 1 =: + 1                                            399    1 84
197    002582I            I2=I+2                                               400    185
198    002590!            P1=(YCI,J1,K1l-YCI,J1,K2))•(Z(I,J1,K2)-ZCI,J2,K)l-   4C1    186
1H                      1     CZCI,J1,~1l-ZCI,J1,K2ll•CYCI,J1,K2l-YCI,J2,Kl)   402
200    0026CCI            P2=Czc:,J1,K1)-Z(I,J1,K2l)•(X(I,J1,K2)-X(I,J2,K))-   403    187
201                     1     CXCI,J1,~1)-XCI,J1,K2)l•(Z(I,J1,K2)-Z(I,J2,Kl)   404
202    002808!            P3=(X(I,J1,K1)-X(I,J1,K2l)•CY(I,J1,K2)-YCI,J2,Kl)-   405    188
203                     1     (YCI,J1,K1)-Y(I,J1,K2))•CXCI,J1,K2)-X(I,J2,K))   406
204    002944I            PC=SCRT(?1•?1+P2•P2+P3•?3)                           407    189
205    00298:I            P1=F1/PC                                             408    190
206    OJ29AOI            P2=P2/P~                                             409    191
207    J02962I            P3=P3/P(;                                            410    192
208    0029C4I            R1 =1, -01 ••2                                       411    1 QJ
209    0029:0I            R2=1,-P2••2                                          412    1 Q4
210    0029FCI            R3=1,-P3••2                                          413    195
211    002A1 3I           SINX(III)=s:-rc.1,                                   414    196
212    002A3:I            SINYCIIIl=SCRTC,2>                                   41 5   197
213    002A62I            SINZCIIIl=SCQT(Q3)                                   416    198
214    002A8oI            Q1:X(I,J,K)-X(I1,J,K)                                417    199
215    002.108!           C2=Y(I,J,K)-Y(I1,J,K)                                418    200
216    00262AI            ~3=ZCI,J,Kl-ZCI1,J,K)                                419    201
217    002B7CI            AA=S~RT((Q1-?1)••2+(Q2-P2)••2+(Q3-P3)••2)            420    202
218    002BFAI            CC=1,0                                               421    203
219    002C06I            99=SQqT(C1•Q1+C2•;2+Q3•C3>                           422    204
220    002C52I            COT~=cae•aa+cc•CC-AA•AA)/C2•B3•CC)                   423    205
221    002C94I            YN(III)=99•ABS(COTH)                                 4 24   206
222    002CCOI            01=X(I,J,K)-X(I2,J,K)                                425    207
223    002012I            Q2=YCI,J,K)-Y(!2,J,K)                                426    203
224    002C64I            Q3=ZCI,J,Kl-ZCI2,J,Kl                                427    209
225    002DB6I            66=SO~TC01•Q1+02•Q2+03•Q3l                           4 28   210
226    002E02I            ~~=SC•TCCC1-?1l••2•C~2-P2)••2+(Q3-?3)••2)            429    211
227    002:7:I            COTM=(86•Bc+CC•CC-AA•AA)/C2•BB•CC)                   430    212
228    002:COI            YN1CIII)=C98•A3SCCOTH)+YNCII!ll•0.5                  431    213
(Jl
0
      229    002FOOI             IJLCCI,J,K>=III                                      432    214
      230    002F2CI             III=III+1                                            433    215
      2 31   002F3AI      5      CONTINUE                                             434    216
      2 32   002F3AI             IF(,.CCI,J,K+1) .EQ. 0) GO TO 6                      435    217
      233               C-----TOP                                                     436
      2 34   002F72I             ISC(III>=I                                           437    219
      235    002F86I             JBC CII I) =J                                        438    220
      236    002F9,H             KBC(III)=K                                           439    221
      237    002FAEI             IITYCIII)=5                                          440    222
      238    002FaEI             I1=I+1                                               441    223
      239    002FCCI             I2=I-1                                               442    224
      240    OC2FDAI             J1=J+1                                               443    225
      241    002FESI             J2=J-1                                               444    226
      242    Ou2FF6I             IF(I •CC:• L1) I2=I                                  445    227
      243    0030141             IFCI • .,..
                                         C,. • L2) I 1 = I                            446    229
      244    003032I             IF(J • EC. M1> J2=J                                  447    231
      245    003050I             IF(J .e,. M2) J1=J                                   448    233
      246    u0306EI             K1=K-1                                               449    235
      247    Ou307CI             K2=K-2                                               450    230
      248    rJQ308AI            P1=CY(I1,J1,K)-YCI1,J2,K))•CZ(I1,J2,K)-Z(I2,J,K))-   4 51   237
      249                      1     (Z(I1,J1,K)-Z(l1,J2,K))•CYC!1,J2,K)-YCI2,J,K))   452
      250    OrJ31C6I            P2=CZCI1,J1,K)-Z(I1,J2,K))•CX(I1,J2,K)-X(I2,J,K))-   453    2 3 !3
      251                      1     (X(l1,J1,K)-X(!1,J2,K))•CZ(I1,J2,K)-ZC!2,J,K))   454
      252    003302I             P3=(XCI1,J1,K)-X(I1,J2,K))•(Y(I1,J2,K)-Y(l2,J,K))-   455    239
      253                      1     (Y(I1,J1,K)-~(I1,J2,K))•(X(!1,J2,K)-X(l2,J,K))   456
      254    00343El             ?Q=SQ~T(P1•?1+P2•?2+P3•P3)                           457    240
      255    00348AI             P1=1'1/PC                                            458    241
      256    00349Cl             P2=P2/PI;.                                           459    242
      257    0034AEI             P3=P3/PC                                             460    243
      258    0034COI             Q1=1.-P1••2                                          461    244
      259    00340CI             R2=1.-P2••2                                          462    245
      260    0034"8I             R3=1.-P3••2                                          463    246
      2 61   003514I             SlNXCIII)=SQRT(R1)                                   4 64   247
      262    00353AI             SI~Y(III>=SQRT(R2)                                   465    248
      263    00355EI             SINZ(IIl)=SQRTCR3)                                   466    249
      264    0035821             01=X(I,J,K)-X(I,J,K1)                                467    250
      265    0035041             Q2=Y(I,J,K)-Y(l,J,K1)                                468    251
      266    0036261             Q3=Z(I,J,K)-ZCI,J,K1)                                469    252
      267    0036781             AA=SQRT((Q1-P1)••2+(Q2-P2)••2+(Q3-P3)••2)            470    253
      268    0036F6I             CC=1.C,                                              4 71   254
      269    0037021             BB=SQRT(Q1•Q1+C2•Q2+Q3•Q3)                           472    255
      270    OOJ74EI             COT~=(Be•BB+CC•CC-AA•AA)/(2•SB•CC)                   473    256
      271    0037901             YN(llI)=36•A9S(COTH)                                 474    257
      272    0037BCI             Q1=X(l,J,K)-X(l,J,K2)                                475    258
      273    00380El             Q2=YCI,J,K)-Y(l,J,K2)                                476    259
      274    0038601             Q3=ZCI,J,K)-Z(I,J,K2)                                477    260
      275    003aa21             SB=SCRTCQ1•Q1+C2•Q2+Q3•03)                           478    261
      276    0038FEI             AA=SQRTCCQ1-P1)••2+(Q2-P2>••2+(Q3-P3)••:;            479    262
      277    00397AI             COTh=CBe•BB+CC•CC-AA•AA)/C2•BS•CC)                   480    263
      278    0039BCl             YN1(IIl)=CBB*ABSCCOTM)+YN(IlI>)•0.5                  481    264
      279    0039FCI             IJLC ( I,J,K) =III                                   482    265
      280    003A28l             III=III+1                                            483    266
      2 81   003A36I      6      CONTINUE                                             484    267
      282    003A36I             IF(,.C(I,J,K-1) • EQ. 0) GO TO 30                    485    268
      283               C-----BOTTOM                                                  486
      234    003A6EI             IBC(III>=I                                           487    270
      285    003A82I             JBCCIII>=J                                           488    271
2B6   003A96I               KBCCIII)=K                                                               489    272
287   003AAAI               I IT YCII I J =6                                                         490    273
288   003ABAI               I1=I+1                                                                   491    274
289   003AC8I               I2=I-1                                                                   492    275
290   003AD6I               J1=J+1                                                                   493    276
291   003AE4I               J2=J-1                                                                   494    277
292   003AF2I               IFCI .cc. L1l I2=I                                                       495    278
293   003810!               IFCI .:C. L2l I1=I                                                       496    280
294   003B2EI               IFCJ .Ee;. M1l J2=J                                                      497    28 2
295   00364CI               IFCJ .E,;:. M2) J1=J                                                     498    284
296   00366AI               K1=K+1                                                                   499    286
297   003678!               K2=K+2                                                                   500    2 87
298   003586!               P1=CY(I1,J1,~l-YC!1,J2,KJJ•CZCI1,J2,KJ-Z(I2,J,K))-                       501    288
299                       1      (ZCI1,J1,K)-ZCI1,J2,KJJ•CYCI1,J2,~)-Y(I2,J,KJ)                      502
300   003CC2I               P2=(ZCI1,J1,KJ-ZCI1,J2,Kl)•(X(I1,J2,Kl-X(I2,J,K))-                       503    289
301                       1      (XCI1,J1,~)-x(I1,J2,K))•(Z(I1,J2,K)-Z(I2,J,K))                      504
302   003CFEI               0 3=(X(I1,J1,K)-x(I1,J2,K))•(Y(I1,J2,K)-Y(I2,J,K))-
                                                                                                     505    290
303                       1      (Y(I1,J1,K)-Y(I1,J2,K))•(X(I1,J2,K)-xCI2,J,K))                      5 06
304   003F3AI               ?Q=SQRT(?1•P1+P2•P2+P3•?3)                                               507    2 91
305   003F86!               P1 =P1 /OC                                                               503    29 2
306   O:J3F98I              P2=P2/PC                                                                 509    293
307   003FAAI               P3=?3/°C                                                                 510    294
308   003FoCI               R1=1.-?1••2                                                              511    2 95
309   003FaBI               qz=1.-P2••2                                                              512    296
310   003FF4I               Q3:1.- 0 3••2                                                            513    297
311   00401 OI              SINX(I!Il=SQ~T(R1)                                                       514    298
312   004036!               SINY(IIIl=SQRT(R2)                                                       515    299
313   OQ405AI               SINZCI!Il=SQqT(R3J                                                       516    300
314   00407EI               Q1=XCI,J,K)-X(I,J,K1)                                                    517    301
315   J04000I               Q2=Y(I,J,K)-Y(I,J,K1)                                                    518    302
316   004122!               Q3=Z(I,J,K)-ZCI,J,K1)                                                    519    303
317   004174!               AA=SQRT((;1-P1l••2+(Q2-P2)••2+(Q3-P3)••2)                                520    304
318   0041F2I               CC=1.0                                                                   5 21   305
319   0041FEI               BB=SQRT(Q1•;1+Q2•Q2+Q3•Q3l                                               522    306
320   00424AI               COTH=CB2•SB+CC•CC-AA•~A)/(2•BB•CC)                                       523    307
321   00428CI               YN( IIIl=SB•ASS(COT~)                                                    524    308
322   004263!               Q1=X(!,J,K)-X(!,J,K2)                                                    525    309
323   00430AI               Q2=YCI,J,K)-YC!,J,K2)                                                    526    310
324   00435CI               Q3=Z(I,J,K)-Z(I,J,K2)                                                    527    311
325   0043A:I               ae=5CRT(~1•C1+C2•Q2+Q3•:3l.                                              528    312
326   OJ43FAI               AA=5QRT((C1-P1l••2+(Q2-P2)••2+CC3-P3J••2>                                529    313
327   0 0 4 4 r'6 I         COTH=(9B•BB+CC•CC-AA•AA)/(2•Ba•cc>                                       530    314
328   0044!'!81             YN1CIIIJ=CBB•ABSCCOTH)+YNCIII)l•0.5                                      5 31   31 5
329   0044F8I               IJLCCI,J,Kl=III                                                          532    316
330   0045241               III=III+1                                                                533    317
331   0045321          30 CONTINLE                                                                   534    318
332   0045301               IITC=III-1                                                               535    319
333   00458EI               ~KITE(6,100) L0,M0,N0,IITO                                               53t,   320
334   0045:!8!        100 FOR,..ATC4!5)                                                              537
335   0045C4I               RETL~N                                                                   538    321
336   0045CCI               ENO                                                                      539    322
NO ERRCRS:F70 ROS-01.0C SUBROUTINE CIRCCS        02/21/8j 09:47:58           TA!LE SPACE:   6   KB
STATEMENT BUFFER:   20 LINES/1321 BYTES    STACK SPACE: 203 WOROS
SINGLE PRECISION FLOATING PT SUPPORT RECUIREO FOR EXECUTION
C,11
N       1    OuOOOOI             SU9i<vUTINE T, l ~, F                                                                                        540
         2   000004I             COMl'CN                                                                                                      5 41
        3                      1/VA,/UC,1,18,1Cl,V(21,15,1Cl,P(21,18,1C),0~(21,18,1C),                                                        542
        4                      2 JE(21,12,10),:QRU,:~RV,€Ri<~,E~RK,EQ~E,=RRW,                                                                 543
        5                      3 ~,(21,18,10l,~(21,13,10),TM(21,18,10)                                                                        544
        6                     1/PQCP/ VISE(21,16,1Cl,~ENC21,18,10),VISC,OEN!N,FLOWIN                                                          545
        7                     1 / PC CV CU(21,13,10),CV(21,13,1C),D~(21,18,10)                                                                546
        8                     1 / TU i< / SIGK,S!~E,C~U,C1,C2,CMU1,CMU2,E,CK,~INUM,SMNUl',ANV1(800),                                          547
        9                      2 Y~(8CC),YN1(8CC),SI~X(e00),SI~Y(30C),SINZ(30C),ANw1(800),                                                    548
       10                     3 YPLN(8C0),TAuNCeoo>,:sccaoJl,J3C(800),~BC(800),IITY(S00),                                                     549
       11                     .:. i!L~(~CJ),G:~C21,1~,1C),MCC21,18,10>,IJL0(21,18,10),IITO                                                    550
       12                     1/C::::~/ ~~C21,1!,10),SU(21,1!,1G),SP(21,18,10),SUKC21,1S,10),                                                 5 51
       13                     2      §PK(21,18,10),AE(21,13,1~l,A~(21,18,10),A~(21,18,10),                                                    552
       14                     3      AS(21,1°,1C),C;(21,13,10),~3(21,1E,1Cl,AP0(21,18,10)                                                     553
       15    J.JCJC4~          C:)~~c.,                                                                                                       554
       1o                     1/   i<!',/ xc21,1a,1c1,,c21,1e,12>,zc21,13,1c>,TJoc21,1e,10>,                                                  555
       17                     2   CXC21,13,10l,CYC21,13,101,C:C21,18,1Cl,                                                                     556
       ,,
       13                     3
                              3
                                  EXC21,1S,1Cl,cYC21,1~,1Cl,EZC21,18,1Cl,
                                  SXC21,1c,1Cl,SYC21,18,10l,SZC21,12,1Cl
                                                                                                                                              557
                                                                                                                                              558
       2G                     1/LI~:/ L,~,LT,"IT,L1,L2,~1,~2,L0,MO,IS~U,IS~V,IS~P,!SWK,IS-E,
       21                     2   ! Lc: , ~ L V, AL O , l LK , l L: , l L VI S , ~ L ,1 , t, , N1 , N., NG , ! 5 W,1 , : G, NT, Al C, 0 T T
                                                                                                                                              559
                                                                                                                                              560
                                                                                                                                                           oo
                                                                                                                                                           .,, ::0
       22    J:JOJ4I
       23
                               CO."l~ON
                               1/TT,~~/TXX:(21,1~,1CJ,Txx.(21,1S,1C),TYYN(21,18,1G),
                                                                                                                                              5t1
                                                                                                                                              562
                                                                                                                                                           .,, E2
       24
       25
                                2
                                3
                                      TYYS(21,13,1Cl,TZZTC21,18,12),TZZBC21,18,10l,
                                      T•Xc(21,13,1Cl,:YXw(21,13,1C),TYZT(21,18,10),
                                                                                                                                              563
                                                                                                                                              564
                                                                                                                                                           8~
                                                                                                                                                           ::o r
       26                       4     TYZ!C21,13,1(1,TXY~(21,13,10),TXYS(21,18,10),                                                           565
       27                       5     TXZT(21,1c,1Cl,,XZ5(21,1e,10>,TZX:(21,18,10l,                                                           566          ,0 .,,
       28                       /;    rzx.c21,1a,1Cl,TZYN(21,13,10),TZYS(21,18,10)                                                            567           c:~
                                                                                                                                                            )II ..,
       29
       30    OOOJC4I
                         C-----CALCL.:U TE Gq:c T;1A~SFO'l1HT:ON CC:F":CENTS
                                   co t.C I=Z,L
                                                                                                                                              568
                                                                                                                                              569     1
                                                                                                                                                            r-.,,
       31
       32
             000018!
             OJ002CI
                                   co 40 J = 2, ~
                                   :o 40 K = 2, ~
                                                                                                                                              570
                                                                                                                                              571
                                                                                                                                                      2
                                                                                                                                                      3     ~~
       33    000040!               P1=(XC!,J,K)+X(!,J-1,K)+XC!,J,K-1l•XCI,J-1,K-1)-X(I-1,J,K)-                                                572     4
       34                       1 X(!-1,J-1,K)-x(I-1,J,K-1)-X(I-1,J-1,K-1))•0.25                                                              573
       35    0001 A4 I             P2=(X(I,J,K)+X(I-1,J,K)+X(I,J,11-1)+X(I-1,J,K-1)-X(I,J-1,K)-                                               574     5
       36                       1 X(I-1,J-1,KJ-x(!,J-1,K-1)-X(I-1,J-1,K-1))•0.25                                                              575
       37    000308:               P3=(X(!,J,K)+X(I-1,J,K)+x(I,J-1,K)+X(I-1,J-1,K)-xCI,J,K-1)-                                                576     6
       38                       1 X(!-1,J,K-1)-XCI,J-1,K-1)-X(I-1,J-1,K-1))•0.25                                                              577
       39    00046CI               ~1=1YC:,J,K)•Y(!,J-1,Kl•YC:,J,K-1)+Y(I,J-1,K-1)-Y(I-1,J,K)-                                                578     7
       40                      1 Y(I-1,J-1,K)-Y(I-1,J,K-1)-Y(I-1,J-1,K-1))•0.25                                                               579
       41    oocscor               ~2=(Y(I,J,Kl•Y(I-1,J,K)•YCI,J,K-1)+Y(I-1,J,K-1)-Y(!,J-1,K)-                                                580     ti
       42                      1 Y(I-1,J-1,KI-YU,J-1,K-1)-Y(I-1,J-1,K-1))•0.25                                                                581
       43    0007341               Q3=(Y(I,J,K)•Y(I-1,J,K)+Y(I,J-1,K)+Y(I-1,J-1,K)-Y(I,J,K-1)-                                                582     9
       44                      1 Y(I-1,J,K-1)-Y(I,J-1,K-1)-Y(I-1,J-1,~-1))•0.25                                                               583
       45    000o~!H               ~1=CZCI,J,K)+ZCI,J-1,Kl+Z(I,J,K-1)+Z(I,J-1,K-1)-Z(I-1,J,Kl-                                                584    10
       46                      1 !C:-1,J-1,Kl-Z(!-1,J,K-1)-Z(I-1,J-1,~-1))•0,25                                                               ~85
       47    OJ09FCI               R2=CZ(I,J,K)+Z(I-1,J,K)+ZCI,J,K-1)+Z(I-1,J,K-1)-ZCI,J-1,K)-                                                586    11
       48                      1 Z(I-1,J-1,Kl-ZCI,J-1,K-1)-Z(!-1,J-1,K-1))•0.25                                                               587
       49    000360!               R3=(ZCI,J,Kl•Z(I-1,J,K)+Z(I,J-1,K)+Z(I-1,J-1,K)-ZCI,J,K-1)-                                                588    12
       50                      1 Z(I-1,J,~-1)-Z(I,J-1,K-1)-ZCI-1,J-1,~-1))•0.25                                                               569
       51    JOOCCloI              PT~=1.C/CP1•C~2•,3-Q3•,2l-P2•(C1•R3-Q3•R1)+P3•CQ1•R2-Q2•R1))                                               590    13
       52    000::1361             SU(I,J,Kl=A9SC1.G/PTR)                                                                                     591    14
       53    000CS6I               AECI,J,K)=PTq•(:2•R3-Q3•R2)                                                                                592    15
       54    OOOOCCI               AW(I,J,K)=-PTR•(P2•R3-D3•R2)                                                                               593    16
       55    OOCE1AI               AN(!,J,K)=DT~•(P2•~3-P3•Q2)                                                                                594    17
       56    JOO:eOI               ASCI,J,K)=-PTR•CC1•K3-,3•R1)                                                                               595    18
       57    JOOEAEI               AT(I,J,K)=PTQ•(P1•R3-P3•R1)                                                                                596    19
       ss    OOOEF4I             A8(I,J,K}=-?TR•(P1•Q3-P3•Q1)                                      597    20
       59    QQOF42I             DU(I,J,K)=~T~•(;1•R2-C2•R1)                                       598    21
       60    OOOFS8!             CV(I,J,K}=-PT~•CP1•R2-P2•R1)                                      599    22
       61    000F:J6I            0WCl,J,K)=PT~•CP1•C2-P2•Q1}                                       600    23
       62    00101CI         40 CONT!Ni,;E                                                         601    24
       63    0010641             CALL WALVALC1,0,2,L,2,M,2,N,AE)                                   602    25
       64    Ou10SCI             CALL WALVAL(1,0,2,L,2,M,2,N,Aw}                                   603    26
       65    0011141             CALL WALVAL(1,C,2,L,2,~,2,N,AN}                                   604    27
       66    00116Cl             CALL WALVALC1,0,2,L,2,M,2,N,AS)                                   605    28
       67    0011 C4!            CALL WALVAL(1,0,2,L,2,~,2,N,AT}                                   606    29
       eS    Q0121Cl             U,LL wALVALC1.C,2,L,2,~,2,N,AS)                                   607    30
       69    0012741             CALL wALVALC1,0,2,L,2,~,2,N,OU)                                   608    31
       70    0012CCI             CALL wALVAL(1,C,2,L,2,M,2,N,OV}                                   609    32
       71    001324!             CALL WALVAL(1,0,2,L,2,~,2,N,DW}                                   610    33
       72    00137CI             CALL wALVALC1.C,2,L,2,~,2,N,SU}                                   611    34
       73    C'.!13:Jt. I        ~c EO I=1,L                                                       612    35
       74    IJ013cSI            co :C J=1,~                                                       613    36
       75    oa1 3=cr            JO eo K: 1, N                                                     614    37
       76    OJ1410I             CXCI,J,K}=(A=CI,J,K)+AE(!,J+1,K)+A:(I,J,K+1}+AE(l,J+1,K+1)+       615    38
       77                       1 AE(I+1,J,K)•A:CI•1,J+1,K)+A2(1+1,J,K+1)+AE(l+1,J+1,K+1))•0.125   616
       73    001 5941            CYCI,J,K)=CA~CI,J,K)+AkCI,J+1,K)+AW(l,J;K+1)+AkCI,J+1,K+1)+       617    39
       79                       1 A~(!+1,J,K)+AW(I+1,J+1,K)+Ak(l+1,J,K•1)+AW(l+1,J+1,K+1))•0.125   618
       ao    J01718I             CZCI,J,K)=(AN(l,J,K)+AN(!,J+1,K)+ANCI,J,K+1)+A~(l,J+1,K+1)+       619    40
       a1                       1 AN(I•1,J,K)•A~(I•1,J+1,K)+AN(I+1,J,K+1)+AN(I+1,J+1,K+1))•0,125   620
       82    00189(!             EX(I,J,K)=(ASCl,J,K)+AS(I,J+1,K)+AS(l,J,K+1)+AS(l,J+1,K+1)+       621    41
       83                       1 AS(I+1,J,K)+AS(I+1,J+1,K)+ASCI+1,J,K+1)+AS(l+1,J+1,K+1)l•0.125   622
       34    001A20I             i:YCI,J,K)=(AT(I,J,K)+ATCl,J+1,K)+4TCI,J,K+1)+ATCI,J+1,K+1)+      623    42
       85                       1 ATC:+1,J,K)+AT(l+1,J+1,K)+AT(I+1,J,K+1)+ATCI+1,J+1,K+1))•0.125   624
        86   001 SA4l            :ZCI,J,K)=CABCl,J,K)+ABCl,J+1,~}+ABCl,J,K+1)+ASCI,J+1,K+1)+       625    43
        87                      1 AB(l+1,J,K)+AB(l+1,J+1,,)+AB(l+1,J,K+1)+AS(l+1,J+1,K+1)l•0.125   626
        38   001D28I             SX(l,J,K)=(CU(l,J,K)+OUCI,J+1,K)+DU(I,J,K+1)+DU(I,J+1,K+1)+       627    44
        39                      1 DU(I+1,J,Kl+DUC1+1,J+1,Kl+OUC!+1,J,K+1)+DUCI+1,J+1,K+1))*0,125   628
        90   001: AC l           SY(l,J,K)=(CV(I,J,K)+DV(l,J+1,K)+JVCl,J,K+1)+0VCI,J+1,K+1)+       629    45
        91                      1 CV(l•1,J,K)+DV(l+1,J+1,K)+ovcr~1,J,K+1)+QV(l+1,J+1,K+1))•0.125   630
        92   0020301             SZ(l,J,K)=CCWCl,J,K)+OwCI,J+1,K)+OW(I,J,K+1)+0w(l,J+1,K+1)+       6 31   46
        93                      1 CW(I+1,J,,J+Ow(l+1,J+1,Kl+OWCI+1,J,K+1)+CWCI+1,J+1,K+1)l•0,125   6 32
        94   0021S4I             TJOCI,J,K)=CSUC!,J,K)+SUCI,J+1,K)+SU(l,J,K+1)+SUCI,J+1,K+1)+      633    47
        95                      1 S~(I+1,J,K)+SU(I+1,J+1,K)+SUCl+1,J,K+1)+SUCl+1,J+1,K+1))•0,125   634
        96   0023381         80 CONT:NLi:                                                          635    48
        97   OG2320I             co 200 I=1,LO                                                     636    49
        98   002394!             DO 200 J=1,"0                                                     637    so
        99   0023aI              00 200 K=1,N0                                                     638    51
      100    00233CI             '.luCI,J,Kl=O.O                                                   639    52
      1 01   0023E8l        200 CO"JTlNl:E                                                         640    53
      1 02   002i.30l            00 160 I=2,LT                                                     641    54
      103    0024441             00 160 J=2,"T                                                     642    55
      104    0024581             DO 160 1(:2,NT                                                    643    56
      1 05   00246C l            CX:=(CX(!+1,J,K)+CX(l,J,Kl)•0.5                                   644    57
      106    0024C8I             cxw=(CX(I-1,J,K)+CXCI,J,K))•0.5                                   645    58
      107    002524!             CXN=CCXCI,J+1,K)+CX(I,J,K)l•0.5                                   646    59
      108    0025801             CXS=(CXCI,J,K)+CX(!,J-1,Kll•0.5                                   647    60
      109    00250Cl             CXT=CCXC!,J,K+1)+CX(l,J,K))•0,5                                   648    61
      110    0026361             CX6=CCXCl,J,K)+CXC!,J,K-1))•0,5                                   649    62
      111    0026901             CY:=CCYCI+1,J,K)+CYCl,J,Kll•0,5                                   650    63
      11 2   0026!:CI            CYW=(CYC!,J,K)+CY(l-1,J,K)l•0,5                                   6 51   64
      11 3   0027481             CYN=(CYCl,J+1,K)+CY(I,J,Kl)•0,5                                   ~52    65
      114    0027A4I             CYS=CCYCI,J,~l+CY(!,J-1,K))•0.5                                   653    66

c.n
w
CJ1   11 5   002800!     CYT=CCYCI,J,K+1)+CYCI,J,K))•0.5                                654     67
~
      116    00285AI     CYo=CCYCI,J,K)+CYCI,J,K-1))•0.S                                655     68
      117    002864!     CZE=CCZCI+1,J,K)+CZCI,J,K)l•O.S                                656     69
      118    0029101     CZW=CCZCI,J,~l•CZCI-1,J,K)l•0.5                                657     70
      119    00296CI     CZN=CCZCI,J+1,K)+CZCI,J,K)l•0.5                                658     71
      120    0029C8I     CZS=CCZCI,J,K)+CZCI,J-1,Kll•0.5                                659     72
      1 21   002A24I     CZT=CCZCI,J,K+1)+CZCI,J,K))•0.5                                660     73
      122    OJ2A7EI     CZ3=(CZCI,J,K)+CZCI,J,K-1ll•O.S                                661     74
      1 23   002A08I     EXE=(EXCI+1,J,K)•:X(I,J,Kll•0.5                                662     75
      1 24   002334!     EX~=(:XCI,J,K)+:XCI-1,J,K)l•0.5                                663     76
      125    002590!     EXN=CEXCI,J+1,K)+EXCI,J,K)l•0.5                                664     77
      126    002:!ECI    EXS=CEXCI,J,K)+EXCI,J-1,Kl)•0.5                                665     78
      127    002C48I     EXT=(EX(I,J,K+1)+EX(I,J,Kl)•0.5                                666     79
      128    002CC.2I    EX3=CeX(I,J,K)+EXC!,J,K-1)l•0.5                                667     80
      129    OJ2CFCI     EYE=(EY(I+1,J,K)•EY(I,J,K)l•0.5                                668     81
      130    002058:::   EY~=CEYC!,J,Kl+EY(I-1,J,K)l•0.5                                669     82
      1 31   002064!     EYN=(EYCI,J+1,K)+EY(I,J,K))•0.5                                670     83
      132    OJ2E10!     EYS=(EY(I,J,~>•EYCI,J-1,K)l•0.5                                6 71    84
      133    002E6CI     EYT=(:Y(I,J,K+1)•:Y(I,J,Kl)•0.5                                672     85
      1 34   002EC6I     EY6=CEY(I,J,K)+:YC!,J,K-1))•0.5                                073     86
      135    002F20I     EZE=CEZ(I+1,J,K)+:ZCI,J,Kll•O.S                                e74     87
      136    'J02F7CI    EZW=(EZCI,J,K)+EZ(!-1,J,K)l•0.5                                675     88
      137    002FC8I     EZN=CEZCI,J+1,K)•EZC!,J,K))•0.5                                6 76    89
      138    0030341     EZS=CEZCI,J,K)+EZCI,J-1,~ll•0.5                                677     90
      1 39   003090!     EZT=CEZCI,J,K+1h+EZCI,J,Kl)•0.5                                678     91
      140    0030:AI     :ZB=C:ZCI,J,K)+E!CI,J,K-1))•0.S                                679     92
      141    003144 I    SX:=CSXCI+1,J,K)+SX(!,J,Kll•0.5                                660     93
      1 42   OJ31 AOI    SXW=(SXCI,J,K)+SXCI-1,J,Kl)•0.5                                681     94
      143    0031=cr     5XN=(SX(I,J+1,K)+SX(!,J,K)l•0.5                                682     95
      144    00325SI     SXS=(SX(I,J,K)+SXCI,J-1,Kll•0.5                                683     96
      145    003234!     SXT=(SX(I,J,K+1)•5X(I,J,K))•0.5                                684     97
      146    J0330EI     SXS=CSXCI,J,Kl•SX(I,J,K-1))•0.5                                685     93
      147    0033681     SY~=(SY(I+1,J,K)+SYCI,J,Kll•0.5                                686     99
      148    J03.3C4I    SYW=(SY(I,J,K)+SYCI-1,J,Kll•0.5..._                            687    100
      149    003420!     5YN=(SYCI,J+1,K)+SY(I,J,K)l•0.5                                688    101
      1 50   0034 7C I   SYS=(SY(I,J,K)+SYCI,J-1,K)l•0.5                                689    1o 2
      1 51   003408!     SYT=(SYCI,J,K+1)+5YCI,J,Kl)•0.5                                690    103
      1 52   OJ3532I     SYS=(SY(I,J,Kl+SYCI,J,K-1))•0.5                                691    104
      1 53   00358CI     SZE=CSZ(!+1,J,K)+SZ(I,J,K)l•0.5                                692    105
      154    •J035E8I    SZW=CSZCI,J,Kl•SZ(I-1,J,K)_)•0.5                               693    106
      155    00364<tI    SZN=CSZCI,J+1,K)•SZCI,J,Kll•0.5                                694    107
      156    0036AOI     SZS=CSZCI,J,K)+SZCI,J-1,K))•0.5                                695    108
      157    0036i'CI    SZT=CSZC!,J,K+1)+SZCI,J,Kl)•0.5                                696    109
      1 58   003756!     SZS=CSZCI,J,K)+SZCI,J,K-1))•0.5                                697    110
      159    003HOI      TXXECI,J,Kl=CXE•CXCI,J,K)+CYE•CYC!,J,K)+CZE•CZ(I,J,K)          698    111
      160    00385EI     TXX•CI,J,K)=Cxw•CXCI,J,K)+CY~•CYCI,J,K)+CZW•CZCI,J,K)          699    112
      161    00390CI     TYYNCI,J,Kl=EXN•EX(I,J,K)+EYN*EYCI,J,K)+EZN•EZCI,J,K)          700    113
      162    0039SAI     TYYSCI,J,K)=EXS•EXCI,J,K)+EYS•EY(I,J,K)+EZS•EZCI,J,K)          701    114
      163    003A68I     TZZTCI,J,K)=SXT•SXCI,J,K)+SYT•SYC!,J,K)+SZT•SZCI,J,K)          702    11 5
      164    003o16I     TZZ~(I,J,K)=Sxa•SX(I,J,K)+SYB•SYCI,J,K)+SZB•SZCI,J,K)          703    116
      165    003aC4I     TYXECI,J,Kl=CEXE•CXCI,J,K)+EYE•CYCI,J,K)+EZE•CZ(I,J,K))•0.25   704    117
      166    003C78I     TYXwCI,J,Kl=CEX~•CXCI,J,K)+EYW•CYCI,J,K)+EZW•CZ(I,J,K))•0.25   705    118
      167    003D2CI     TYZTCI,J,K)=CEXT•SXCI,J,K)+EYT•SY(I,J,K)+EZT•SZCI,J,K))•0.25   706    119
      168    003DEOI     TYZ~CI,J,Kl=(EXe•SXCI,J,K)+EYB•SYCI,J,K)+EZS•SZCI,J,Kl)•0.25   707    120
      169    003E94I     TXYNC!,J,K)=(CXN•EXCI,J,K)+CYN•EYCI,J,K)+CZN•EZCI,J,K)l•0.25   708    121
      170    003J:48I    TXYSC!,J,K)=(CXS*EXCI,J,K)•CYS•EYCI,J,K)+CZS•EZCI,J,Kl)•0.?5   709    122
      1 71   003FFCI     TXZTCI,J,K)=(CXT*SX(I,J,K)•CYT•SYCI,J,K)+CZT•SZ(I,J,K))•0.25   710    123
       172    0040o0I           TXZ8CI,J,K)=(CXe•SX(I,J,K)+CYa•SY(I,J,K)+CZS•SZ(I,J,Kf)•0.25           711   124
       173    004164!           TZXE(I,J,K)=(SXE•CXCI,J,K)+SYE•CY(I,J,K)+SZE•CZCI,J,K))•0.25           712   125
       174    004218!           TZXw(I,J,K)=(SXW•CX(I,J,K)+SYW•CY(I,J,K)+SZW•CZCI,J,K))•0.25           713   1 26
       175    0042CCI           TZYN(I,J,Kl=CSXN•EXCI,J,Kl+SYN*EYCI,J,K)+SZN•EZCI,J,Kl)*0.25           714   127
       176    004380!           TZYSCI,J,KJ=CSXS*EXCI,J,K)+SYS•EYCI,J,KJ+SZS•EZCI,J,Kl)•0.25           715   128
       177    004434!     160   CONTINL:E                                                              716   129
       178    00447CI           CALL WALVAL(1.0,2,LT,2,MT,2,NT,TXXE)                                   717   130
       179    0044::l4I         CALL WALVAL(1,0,2,LT,2,MT,2,NT,TXXW)                                   718   131
       1 80   00452CI           CALL wALVAL(1.C,2,LT,2,MT,2,NT,TYYN)                                   719   132
       1 81   004584!           CALL WALVAL(1,0,2,LT,2,MT,2,NT,TYYS)                                   720   133
       182    00450CI           CALL WALVAL(1,0,2,LT,2,MT,2,NT,TZZT)                                   721   1 34
       183    004634!           CALL ~ALVAL(1.0,2,LT,2,MT,2,NT,TZZ9l                                   722   135
       184    00468CI           CALL wALVALC1.0,2,LT,2,MT,2,~T,TYXEl                                   723   1 36
       185    0046E4I           CALL WALVAL(1,0,2,LT,2,MT,2,NT,TYXW)                                   724   137
       136    00473CI           CALL ~ALVAL(1,0,2,LT,2,MT,2,NT,TYZT)                                   725   138
       1 87   004794!           CALL WALVAL(1.G,2,LT,2,MT,2,NT,TYlol                                   726   139
       188    OC47ECI           CALL wALVAL(1,0,2,LT,2,MT,2,NT,TXYN)                                   727   140
       189    OJ4S44I           CALL wALVAL(1,0,2,LT,2,MT,2,NT,TXYS)                                   728   141
       190    OC489CI           CALL WALVAL(1.0,2,LT,2,MT,2,NT,TXZT)                                   729   142
       n1     G048F4I           CALL wALVAL(1,Q,2,LT,2,MT,2,NT,TX!9)                                   730   143
       192    00494CI           CALL wALVAL(1.C,Z,LT,2,MT,2,NT,TZXE)                                   731   144
       193    C049A4I           CALL WALVAL(1.0,2,LT,2,MT,2,NT,TZXw)                                   732   145
       1 94   OC49FCI           CALL WALVAL(1.0,2,LT,2,MT,2,NT,TZYN)                                   733   146
       1 95   004A54I           CALL WALVAL(1,0,2,LT,2,MT,2,NT,TZYS)                                   734   147
       196    004AACI           Ri:TuRN                                                                735   148
       197    004AS4I           END                                                                    736   149
       NO ERRORS:F70 K05-01,0C SUeROUTINE TRANF          02/21/86 0~:50:44      TABLE SPACE:   10 K8
       STATEMENT BUFF:~:   20 LINES/1321 BYTES     STACK S?ACE: 199 wO~CS
       SINGLE PRECISION FLCATING PT SU?PGRT ~ECU!RED FOR EXECUTION




(,Tl
(,Tl
01
er.,        1   OOJQ,JiJI                 Su3,<CUT!Nc         !'-HT                                               737
            2   OGC004I                   COMl"ON                                                                 738
            3                            1/V.lR/UC21,1S,10l,VC21,1S,10l,P(21,18,10),uKC21,18,1C),                 739
            4                            2 OEC21,18,10),:Q~u,E~KV,ERRM,E~RK,ER~E,E~<W,                            740
            5                            3 °,C21,18,1vl,•C21,18,10l,TM(21,15,10)                                  7 41
            6                            1/P~CP/ v:S:(21,1c,1Jl,C:~(21,18,10l,VISC,0:NIN,FLOWIN                   742
            7                            1/PCCR/ DUC21,1!,1Cl,uVC21,18,1Cl,DW(21,18,10)                           743
            8   .JOGOJ4!                  C CM,YQI',                                                              744
            9                            ,,~r~T/          L,M,LT,~T,L1,L2,~1,M2,LC,~J,ISwu,ISWV,ISwP,ISWK,ISwE,   745
        10                              2     :LU,lLV,.lL',lL~,AL:,ALV!S,ALW,~,~1,N2,NC,rs.w,IG,NT,ALC,OTT        746
        11                        c-----:',I7:.:iL!Zc v.:i~I.l3L:S                                                747
        12      JCJC·J .. r               :o 1C I=1,LC                                                            748
        13      o::~-:1ar                 ::o 1-~ J:1,YI~                                                         749     2
        14      CCJJ2CI                   :c ,,: ~=1,"<J                                                          750     3
        15      :i:JC40I                  l..C!,J,l()=Q •.J                                                       751     4
        1o      J .~ ·: ,J ~ C!           vc:,J,K)='~.:                                                           752     5
        17      :c,:29a4                  i.CI,J,K)=0.0                                                           753     6
        13      :0J JCi:.!
                      1
                                          P(I,J,K)=O.C                                                            754     7
        19      ::ncr=or                  ??C!,J,O=J,C                                                            755     8
        20      JJC11C!                   ::~C!,J,O=C.G                                                           756     9
        21      JJ,:·11+~!                :c<I,J,1'-)=C.,J                                                        757    1a
        22      J::1?;.:                  C::\C:,J,Kl=D:~I\                                                       7 58   11
        23      JJ(: 1.) Q !              v:s:c:,J,~>=v:sc                                                        759    12
        2:.     -J2J1     :c I      1c    cc,;n,;1..c:                                                            760    13
        25      ·JUJ21.:.!                ~::Tl.:; :-.I                                                           7 61   14
        26      oc~2,~:                   =~=                                                                     762    15

       ~G   Q~CQS:~7   Q2S-01.0C SUSRCuTIN:: !NIT       02/21/36 a~:51 :07                         TA8LE SPIC!:
       STAT M!NT 30~ ER:   2 □ LIN:S/1321 aYT~S   STACK SPA(!: 126 ~CQCS
       s:~G: ?~~C!S ON FLCGTIN~ ?T su~PSRT Q:~UI~=~ FCR EXECUTIO~
  1   000000 I             SUBROUTINE NEWVIS                                                          763
  2   000004!              COMl'ON                                                                    764
  3                      1/VAR/UC21,1d,10l,VC21,13,1Cl,PC21,18,10l,DK(21,18,1Cl,                      765
  4                      2 CE(21,16,10l,E,RU,EQ~V,EQRM,ERRK,ERRE,ERRW,                                766
  5                      3 PP(21,13,1Cl,W(21,18,10),TM(21,18,1Q)                                      767
  0                      1/PRC 0 / VISEC21,1S,10),CEN(21,18,10l,VISC,DENIN,FLCWIN                     768
 7                       1/PCCQ/ CU(21,18,10l,DV(21,13,1CJ,OWC21,18,10l                               769
 8                       1/TUR/ SIGK,SIGE,CMU,C1,C2,CMU1,CMU2,E,CK,rlINUM,SMNU~,ANV1 (~00),           770
  9                      2 YN(80C),YN1(80Cl,SINX(800l,SINY(800),SINZC800l,ANW1(800),                  771
10                       3 YPLN(8COl,T!UN(8QCl,I,C(80Jl,J5CC8COl,K8C(800l,IITY(800l,                  772
11                       4 T~LW(~C0l,G:N(21,13,1Cl,MCC21,1c,10l,IJLOC21,18,10),IITO                   773
12    000004!              CCMMON                                                                     774
13                       1/LI~T/ L,M,LT,MT,L1,L2,M1,M2,L0,M0,IS~U,!5WV,ISWP,ISWK,ISWE,                775
14                       2       ALU,ALV,ALP,JLK,~Lc,ALVIS,ALW,N,N1,N2,N0,ISWW,IG,NT,ALC,OTT          776
15                C-----EVALUATE TU~!JLENT VISC~SITY                                                  777
16    :;JJ004I             CC 10 l=1,L                                                                778     1
11 Jooo1a:                 co 10 J=1,~·                                                               779     2
18    J0002CI              '.)Q 10 K=1,',                                                             780     3
19    ,JJ,JQ40!            IFCcKCI,J,K) .Le. SMNU~) cK(I,J,K)=SMNUM                                   781     4
20    00009EI              .f(CcCI,J,K) .LE. SMN~I') DECI,J,Kl=SMNUI'                                 782     6
21    OOOOFCI              r~cc:CI,J,K) .LE. SWNUM) GO TO 12                                          783     8
22    000134!              ru;vrs=c~N(!,J,Kl•CMU•DK(I,J,Kl••2/DE(I,J,K)+vrsc                          7 84   10
23    0001C2I              GG TO 14                                                                   785    11
24    0001C8I       12 TURVIS=VISC                                                                    786    12
25    000104!       14    CONTINL,:                                                                   787    13
20    000104!              VISE(I,J,K)=VISiCI,J,Kl•ALVIS•(TURVIS-VISE(I,J,K))                         788    14
27    000252!       10 CC'<TINL:                                                                      789    15
28    00029AI              ~ i: TL RIii                                                               790    16
29    OOJ2AOI              ENO                                                                        791    17

NO ERRORS:=7c ROS-01.CC SU3ROUTINc N:~VIS         02/21/8e C9:51:23         TABLE SPACE:       5 KB
STATEMENT BUFFER:   20 LINES/1321 3YT~S     STACK SPACE: 203 ~OROS
SINGLE PR:CISICN =LCATING ?T SUPPORT ,s:ur~:O FCR EXECUTION
C.11
00      1   OOOOOOI             SUSKOUTINE S0LVEQ(IE,ISWF,ALF,SIGF,EQRF,F,c0)                     792
        2   OO'J004I            OIMENS!CN F(21,18,10),F1(21,18,10),F0(21,18,10)                   793
        3   0000041             COM,-,ON                                                          794
        4                     1/VAKIU(21,18,10l,V(21,18,10l,P(21,18,10),0K(21,18,1C),             795
        5                     2 OE(21,18,10l,E~RU,E~QV,ER~M,ERRK,ERRE,ERRW,                       796
        6                     3 PP(21,18,10),~(21,18,10),TM(21,18,10)                             797
        7                     1/?RCP/ vISEC21,1e,10>,0~N(21,18,10),V!SC,OENIN,FLOWIN              798
        8                     1/PCCR/ CUC21,18,10l,DVC21,18,1C),CW(21,18,10)                      799
        9                     1/TUA/ SIGK,SIGE,CMU,C1,C2,CMU1,CMU2,E,CK,HINUM,SMNUM,ANV1C800),    800
       10                     2 YN(80Cl,YN1(800l,SINXC800l,SINYC800),SINZ(800l,ANW1(800),         801
       11                     3 YPLNC8C0),TAUN(800),I~C(800),JBCC800),~BCC800),IITY(800),         802
       12                     4 TAUW(8C0l,GENC21,18,1C),MC(21,18,10),IJL0(21,18,1C),IITO          803
       13                     1/CO:F/ AP(21,18,10),SU(21,19,1Cl,SPC21,18,10),SUK(21,18,10),       804
       14                     2     SPK(21,18,1C),A:(21,18,10),AW(21,18,10),AN(21,18,10),         805
       15                     3     ASC21,13,10),AT(21,18,1Cl,A6(21,13,1C),APOC21,18,10)          806
       16   000u04I             COM'10N                                                           8C7
       17                     1/TR,N/ XC21,18,10),YC21,18,1Cl,ZC21,1~,1Cl,TJOC21,18,10),          808
       18                     2     CX(21,18,10),CY(21,18,10l,CZC21,1e,,o>,                       8C9
       19                     3     cXC21,1S,1Cl,:YC21,18,1Cl,EZC21,13,10l,                       810
       20                     3     SX(21,13,10l,SYC21,13,10>,SZC21,13,10)                        811
       21                     1/L!'1T/ L,M,LT,MT,L1,L2,M1,M2,LC,MO,ISwu;rswv,ISWP,ISWK,IS~E,      812
       22                     2     ALu,ALV,ALP,ALK,ALE,ALVIS,ALW,~,N1,N2,NC,ISww,IG,NT,ALC,OTT   813
       23   OG0004I             COMl'ON                                                           814
       24                     1/TTGAN/TXXc(21,18,10),TXXw(21,18,10),TYYN(21,18,10),               815
       25                     2     TYYSC21,13,1GJ,TZZTC21,1B,1C),TZZBC21,18,10),                 816
       26                     3     TYXE(21,18,1C),TYXW(21,1B,10),TYZT(21,18,10),                 817
       27                     4     TYZBC21,18,1C),TXY~C21,15,10),TXYSC21,18,10),                 818
       28                     5     TXZTC21,18,1Cl,TXZSC21,1o,1C>,TZXE(21,18,10l,                 a19
       29                     6     TZXW(21,1S,10l,TZYN(21,18,10),TZYS(21,1S,10)                  820
       30              C------TRANSPCRT E~UATIONS LINERAIZATION ANO SOLVER                        8 21
       31   000004I             E~RF=O,C                                                          822     1
       32   OOB30I              PI=3.141592654                                                    823     2
       33              c-----?~ESSURE cc~~ECT!ON SOLVER STARTS FROM 10                            8 24
       34   003B3CI             IF(IE ,EQ, 0) GO TO 10                                            825     3
       35              C-----U, V, w, TM, K & : EQUATIONS                                         826
       36   OOB52I              IS=2                                                              827     5
       37   00335AI             IT=LT                                                             828     6
       38   OOB66I              JS=2                                                              829     7
       39   JJ3B6EI             JT="'T                                                            830     8
       40   OOB7AI              KS=2                                                              a 31    9
       41   003382!             KT=~T                                                             832    10
       42   00388:I             GO TO ~21,29,29,29,29,21,21,21), IE                               833    11
       43   0036CAI       21 CONTINUE                                                             8 34   12
       44   003BCAI             00 22 I=IS,IT                                                     835    13
       45   003BE2I             DO 22 J=JS,JT                                                     836    14
       46   0035FAI             00 22 K=!,;S,KT                                                   837    15
       47   003C1~I      22 F1CI,J,Kl=VIS:(I,J,K)/SIGF                                            838    16
       48              C-----EVALUAT: LINK CC=FF, ANC SOURCE TERMS                                839
       49   003CACI             00 20 I=IS,IT                                                     840    17
       50   003CC4I             00 20 J=JS,JT                                                     841    18
       51   003COCI             00 20 K=KS,KT                                                     842    19
       52   003CF4I             GAE=O.S•CF1(I+1,J,K)+F1CI,J,Kl)                                   843    20
       53   003050I             GAW=0,5•(F1CI-1,J,K)+F1CI,J,K))                                   844    21
       54   0030ACI             GAN=0,5•CF1CI,J+1,K)+F1(I,J,K))                                   845    22
       55   003E08I             GAS=0,5•CF1(l,J-1,K)+F1CI,J,K))                                   846    23
       56   003:64I             GAT=0.5•CF1(I,J,K+1)+F1(!,J,K))                                   847    24
       57   003E~EI             GAa=0,5•(F1C!,J,K-1)+F1CI,J,K))                                   848    25
        58    003F18I     DENE=O.S•CDEN(I+1,J,K)+OENCI,J,K))                          849    26
        59    003F74I     DENw=O.S•(DEN(I-1,J,K)+OEN(I,J,K))                          850    27
        60    003FOOl     CENN=O.S•COENCl,J+1,K)+OENCl,J,K))                          8 51   28
        61    00402Cl     OENS=O.S•COEN(l,J-1,K)+DEN(l,J,K))                          852    29
        62    0040881     DENT=O.S•CDEN(l,J,K+1)+DEN(l,J,K))                          853    30
        63    0040E2I     OENS=0.5•CDEN(l,J,K-1)+0EN(I,J,K))                          854    31
        64    00413Cl     UE=C.S•CU(I+1,J,K)+U(l,J,K))                                855    32
        65    0041981     UW=G.5•CUCI-1,J,K)+UCl,J,K))                                856    33
        66    0041F4I     UN=C.5•CUCl,J+1,K)+UCI,J,K))                                857    34
        67    0042501     US=G.S•CU(l,J-1,K)+U(l,J,K))                                858    35
        68    0042ACI     UT=C.5•CU(I,J,K+1)+UCI,J,K))                                859    36
        69    0043061     UB=0.5•CU(l,J,K-1)+U(I,J,K))                                860    37
        70    0043601     VE=0.5•CV(I+1,J,K)+VCl,J,K))                                861    3S
        71    00433CI     VW=C.S•CV(!-1,J,K)+V(I,J,K))                                862    39
        72    0044131     V~=C.S•(VCI,J+1,K) ♦ V(!,J,K))                              863    40
        73    004474!     VS=C.5•CV(!,J-1,K)+V(I,J,K))                                864    41
         74   004400!     VT=C.5•CVCI,J,K+1)+VCI,J,K))                                865    42
         75   00452AI     VB=C.5•CVCI,J,K-1)+V(I,J,K))                                866    43
         76   !)04534!    WE=C.5•(W(I+1,J,K)+W(I,J,K)l                                867    44
         77   0045EOI     WW=C.5•CW(l-1,J,K) ♦ W(I,J,K))                              868    45
         78   00463CI      wN=C.5•(w(I,J+1,K)+W(I,J,K))                               869    46
         79   004699!      WS=C.S•CW(I,J-1,K)+WCI,J,K))                               870    47
         80   OC46F4l      WT=C.5•(WCI,J,K+1)+W(I,J,K))                               871    48
         91   00474EI      ~3=C.5•(WCI,J,K-1)+W(I,J,K))                               872    4~
         52   0047A8I      Cc=CENE•(UE•CXC~,J,K)+VE•CY(l,J,K)+We•CZ(I,J,K))           873    50
         83   00483Cl      CW=CENW•(UW•CX(I,J,K)+vw•CY(I,J,K)+ww•CZ(I,J,K))           874    51
         84   004800!      CN=CeNN•(UN•=XCI,J,K)~VN•EY(I,J,K)+WN•:ZCl,J,K))           875    52
         35   0049641      CS=DE~S•(uS•:X(l,J,K)+VS•EY(I,J,K)+wS•EZ(l,J,K))           876    53
         86   0049F8I      CT=CENT•(UT•SX(I,J,K)+VT•SY(I,J,K)+~T•SZCI,J,K))           877    54
         87   004A9Cl      C3=CENE•CUB•SXCI,J,K)+VB•SYCl,J,K)+WB•SZCl,J,K))           878    55
         88   0040201      ODE=GAE•TXXECI,J,K)+GAN•TXYNCI,J,Kl-GAS•TXYS(I,J,K)+       879    56
         89              1     GAT•TXZT(l,J,K)-GAS•TXZSCI,J,K)                        880
         90   004COAI      D0W=GA••TXXWCI,J,K)+GAS•TXYSCI,J,K)-GA~•TXYNCI,J,K)-       881    57
         91              1     GAT•TXZTCl,J,K)+GAB•TXZB(l,✓ ,K)                       882
         92   004C"4I      DD~=GAN•TYYN(I,J,K)+GAE•TYXECl,J,K)-GAW•TYXWCl,J,K)+
         93
        94    0040D:1
                         1     GAT•TYZTCI,J,K)-GA8•TYZB(l,J,K)
                           DDS=GAS•TYYSCI,J,K)+GAW•TYX•Cl,J,K)-GAE•TYXE(l,J,K)-
                                                                                      883
                                                                                      884
                                                                                      885
                                                                                             53

                                                                                             59
                                                                                                  ~i
                                                                                                  .,, 5
                                                                                                             -
         95              1     GAT•TY!TCI,J,K)+GA8•TYZB(l,J,K)                        886
         96   004EC31      DDT=GAT•TZZT(I,J,K)+GAE•TZX:CI,J,K)-GAW•TZXW(l,J,K)+       887    60   02
         97              1     GAN•TZYN(I,J,K)-GAS•TZJS(I,J,K)                                    0 )>
         98   004Fo2I      DO~=GA8 ■ TZZ2(I,J,K)+GAw•TZXW(I,J,K)-GAE•TZXE(l,J,K)-
                                                                                      BBB         '1   r-
                                                                                      889    61
         99              1     GAN ■ TZYN(I,J,K)+GAS•T!YS(l,J,K)                      890              "t,
       100    00509CI     CP0=ABS(CE-CW+CN-CS+CT-C3)                                  891    62        ~
       1 01   )050:21     AE(I,J,K)=(AMAX1CA9SC0.5•CE),00E)-0.5•CEl•TJO(l,J,K)        892    63    ., IO
       102    oo;186I     AW(I,J,K)=(AMAX1(ABS(0.5•CW),OD~)+0.5•CW)•TJO(l,J,K)        893    64
                                                                                                   -m
       103
       104
              00522AI
              0052CEI
                          AN(l,J,K)=(AMAX1 (ASS(0.5•CN),OON)-0.5 ■ CN) ■ TJO(l,J,K)
                          ASCI,J,Kl=CA~AX1(ABSC0.5•CSl,DDS)+0.5•CSl•TJO(l,J,K)
                                                                                      894
                                                                                      895
                                                                                             65
                                                                                             66
                                                                                                   j~
       105    0053721     ATCl,J,K)=(A~AX1(AoSCO.S•CT),DOT)-0.5•CT)•TJOCl,J,K)        896    67
       1 06   0054161     ABC!,J,K)=(AMAX1CASS(0.5•CB),0CS)+0.5•C8)•TJO(l,J,K)        897    63
       107    005434!     DDNE=GAE•TYXECI,J,K)+GAN•TXYN(l,J,K)                        898    69
       1 08   00551Al     DCSE=-GAE•TYXE(l,J,K)-GAS•TXYSCI,J,K)                       899    70
       109    005582!     OONw=-GAW•TYXW(!,J,K)-GAN•TXYNCI,J,K)                       900    71
       110    0055:Al     OOSW=GAW•TYXWCI,J,K)+GAS•TXYSCl,J,K)                        901    72
       111    0056441     OOET=GAE•TZX:CI,J,K)+GAT•TXZT(I,J,Kl                        902    73
       11 2   0056AA1     DOEB=-GAE•TZXE(l,J,K)-GAB•TXZBCI,J,K)                       903    74
       113    0057121     ODWT=-GAW•TZXW(l,J,Kl-GAT•TXZT(l,J,K)                       904    75
       11 4   00577Al     OOWB=GA••TZXWCI,J,K)+GAB*TXZ5Cl,J,K)                        905    76
C.11
cc
~
0   11 5    00570A!             OJ~T=GA~•TZYN(I,J,KJ+GAT•TYZT(I,J,K)                                         906     77
    116     00583A!             G0Nc=-G~~•TZY~(!,J,(l-GA3•TYZBCI,J,Kl                                        907     78
    117     0058A2I             DDST=-G~S•TZYS(I,J,K)-GAT•TYZTCI,J,Kl                                        908     79
    11 a    OG590AI             D'.)Se=GAS•T:vsc:,J,K)+GA3•TYZS(I,J,K)                                       909     80
    119     OC596AI             S~(I,J,K)=CP0•FC:,J,K)+OONE•FC!+1,J+1,K)+CCS=•F(I+1,J-1,K)+                  910     81
    120                       1           c:N~•=cr-1,J+1,()+D0Sw•FCI-1,J-1,K)•                               911
    1 21                      2           GC:T•=c:•1,J,K+1)•8~Ec•FCI+1,J,K-1)+                               912
    122                       3           J'.)~T•=cr-1,J,K+1)•00118•FCI-1,J,K-1)+
    123                       .           :CNT•=C:,J+1,(+1)+JCNE•FCI,J+1,K-1)+
                                                                                                             913
                                                                                                             914
    1 24                      s           CCST•FC:,J-1,(•1)•00S:•FCI,J-1,(-1)                                915
    125     oosca2r             ~V(!,J,Kl=CP0•VC:,J,Kl•CCN:•VCI•1,J+1,K)+COS:•V(I+1,J-1,K)+                  916     62
    126                       1           OCNo•V(!-1,J+1,K)+J:SW•V(I-1,J-1,K)+                               917
    127                       2           :Ci:T•V(!•1,J,K+1l•:JCE3•V(I+1,J,K-1)+                             918
    1 ze                      3             c: . . r•vc:-1,J,ic,•1>•.::Jwa•vc:-1,J,1<.-1>+                   919
    129                                     CC~T•VC!,J•1,~+1l•JCN:•VCI,J+1,K-1)+                             920
    1 3C                      5             c:sr•vc:,J-1,(+1l•c □ s:•vcr,J-1,(-1l                            9 21
    1 31    OCSFi.CI               :oC:,J,K)=CPJ•~C:,J,()+C2~:•~(I+1,J•1,K)+OCSE•~CI+1,J-1,K)+               922     83
    1 32                      1             ==~~-~,:-1,J•1,(>+:cs~•~<:-1,J-1,~>•                             923
    133                       2             C:C:T•\olC:+1,J,K+1 l•C8:S•.iC:+1,J,K-1 )+                       924
    134                       3             JJwT•~(!-1,J,K+1)+JJw3•w(I-1,J,K-1)+                             925
    135                       I.                                              t,
                                            '.): N7 • w ( I, J +1 , K +1 ) +DJ 3 • 11 ( I, J + 1 ;K -1 l +   926
    1 36                      5             c:ST•wCI,J-1,~•1)•~JS3•wC:,J-1,~-1)                              "27
    137     006216!                ?~(I,J,Kl=CPJ•JK(I,J,K)• □ CN:•OK(I+1,J+1,~l•COSE•OK(I•1,J-1,K) ♦         928     84
    1 33                      1               CSNw•SK(I-1,J+1,K)+CDSw•CK CI-1,J-1,K)+                        929
    139                       2               ::ET•~"'(I•1 ,J,K+1 )+OOEa•OK ,r .. 1,J,K-1 ) ♦                930
    140                       3               CJWT•CK ( :-1 ,J,K•1) +JCW5•JK ( I-1 ,J, K-1 ) ♦               931
    1 1.1                     4               C~NT•CKC:,J+1,K•1)°CO~S•CKC!,J+1,l-1)+                         932
    142                       5               DCST•DKC!,J-1,K•1l+D~S3•C~C!,J-1,K-1)                          933
    143      J064=0I            SUK CI,J,Kl=CPQ                                                              9 34    85
    144      006SOCI            5?K(I,J,K)=-CPG-APCCI,J,~l                                                   935     86
    145     006564!             ucxr=uE·ui.                                                                  936     87
    146      DJ6576I            U:GA=UN-US                                                                   937     aa
    147      006589!            uSC!=uT-L;S                                                                  938     89
    148      00659AI            VCXI=V:-V•                                                                   939     90
    149      006SACI            V::CA=VN-VS                                                                  940     91
    150      0065S'::I          VSCI=VT-vs                                                                   941     92
    1 51    OOeS'.JO!           .cxr=~E-w.i                                                                  942     93
    1 S2    00e5::2I            1.:JA=i.~-11s                                                                943     -g4
    153     OJ65FI.I            •SCI=i,;r- .. s                                                              944     95
     -~
    1 <,
    155
            006606!
            .JC6694!
                                UX=LCX!•CXCI,J,Kl•UEOA•EX(I,J,K)+uSCI•SX(I,J,K)
                                UY=LCX!•CY(I,J,K)+u::A•:Y(I,J,K)+uscr•SY(I,J,K)
                                                                                                             945
                                                                                                             946
                                                                                                                     96
                                                                                                                     97
    1 56    Q,J6722I            uZ=LCXI•CZ(I,J,K)+U:O~•EZ(I,J,~)+uscr•S!CI,J,K)                              947     98
    157     006780!             VX=VCX!•CX(!,J,K)+VEDA•EX(!,J,K)+vscr•SX(I,J,K)                              948     99
    158     OJ683EI             VY=~CXI•CY(I,J,K)+VEDA•:YCI,J,K)+VSCI•SYCI,J,Kl                              949    100
    159     0068CCI             VZ=VCX!•CZCI,J,K)+VECA•:ZCI,J,K)+VSCI•SZCI,J,K)                              950    101
    1 60    O'.J69SAI           ~x=i.CXI•CX(I,J,K)+WE8A•!X(I,J,K)•wSC!•SX(I,J,K)                             9 51   102
    161     0069ESI             WY=i.CXI•CYC!,J,K)•WEDA•EYCI,J,K)+wSCI•SY(I,J,K)                             952    103
    162     '.),J6A76I          •Z=i.CXI•CZC!,J,Kl+WEO~•EZC!,J,Kl+wSCI•SZCI,J,K)                             953    104
    163     00o504I             G:NCI,J,Kl=VIS:CI,J,Kl•CCUY+VX)••2+(VZ+WYl••2+(wX+UZ)••2+                    954    105
    1 64                      1               2•(UX•UX+VY•VY+~Z•WZ))                                         955
    HS      00e3E6I        20 CCNT!NUE                                                                       956    1 06
    166
    167     OOoC2EI
                         (---------------------------------------------------------------------
                           29 CONTINUE
                                                                                                             957
                                                                                                             958    107
    168                  C-----CALCULATE SCURCE TER~S                                                        959
    169     006C2EI             GO TO (1,2,3,4,5,6,7), !E                                                    960    108
    170                  c-----u-, v-, .. -s~uRCES                                                           961
    171     006C6oI        1    CC"4T!Nl.E                                                                   962    109
       172    006C66I          DO 1 5 I=!S,IT                                                  963    110
       173    006C7EI          DO 1 5 J=JS,JT                                                  964    111
       174    006C96I          DO 1 5 K=KS,i<T                                                 965    11 2
       175    006OEI           GA==0.5•(F1{I+1,J,K)+F1CI,J,K))                                 966    113
       176    00600AI          GA~=C.5•CF1(I-1,J,K)+~1cr,J,K))                                 967    114
       177    006!J66I         GA~=0.5•CF1(I,J+1,~)+F1(I,J,K))                                 968    11 5
       178    006!JC2I         GAS=0.5•CF1(I,J-1,K)+F1CI,J,K))                                 969    116
       179    006!:EI          G~T=0.S•(F1CI,J,K+1)+F1CI,J,K))                                 970    117
       180    006E?o!          GAB=0.5•(F1CI,J,K-1)+F1CI,J,K))                                 971    118
       1a 1   006ED2!          PCXI=(P(I+1,J,~)+ (I+1,J+1,K)+PC!+1,J,K+1)+p(I+1,J+1,K+1)-
                                                0
                                                                                               972    119
       182                 1      ?(I,J,K)-P(I,J+1,K)-P(!,J,K+1)-P(I,J+1,K+1))•0.25            973
       183    007036!        PE~A=(?(!,J+1,K)+P(I+1,J+1,K)+P(!,J+1,K+1)+P(I+1,J+1,K+1)-        974    1 20
       1 84                1      P(!,J,K)-C(I+1,J,K)-PCI,J,K+1)-P(I+1,J,K+1))•C.25            975
       1e5    0J719AI        ?SCI=CP(I,J,K+1)+P(I+1,J,K+1)+P(I,J+1,K+1)+P(I+1,J+1,K+1)-        976    1 21
       136                 1      ?(!,J,~)-P(I+1,J,K)-P(!,J+1,K)-PCI+1,J+1,K))•C.25            977
       187    0G72FEI        UCE=UCI+1,J,K)-u(I,J,~)                                           978    122
       1 as   J07354!        ucw=U(I,J,K)-J(I-t,J,K)                                           979    123
       189    0073A:.I       UC~=CUCI+1,J•1,K)+U(I+1,J,K)-U(I-1,J+1,K)-U(I-1,J,K))•0.25        980    1 24
       1 90   :JCJ7466I      UCS=(U(I+1,J,K)+ucr•1,J-1,K)-u(I-1,J,K)-u{I-1,J-1,K))•0.25        9 81   125
       1 91   007522!        UCT=CUCI+1,J,K+1)+U(!+1,J,~)-U(I-1,J,K+t)-U(I-1,J,K))•0.25        982    1 26
       192    00750,U          UC3=Cu(I+1,J,K)•ucr+1,J,K-1)-U(I-1,J,K)-u(I-1,J,K-1)) ■ 0.25    983    127
       1 93   JJ7o92I          ut~=(u(I+1,J+1,K)+UCI,J+1,K)-U(I+1,J-1,K)-U(I,J-1,K))•0.25      984    1 28
       194    0::i774!:I       UE~=CU(!,J+1,K)+U(I-1,J+1,K)-U(I,J-1,K)-U(I-1,J-1,K)) ■ 0.25    985    129
       195    00730l!          UEN=UCI,J•1,K)-u{I,J,K)                                         986    130
       196    007860!          UcS=U(I,J,K>-ucr,J-1,K)                                         987    1 31
       197    007886!          UET=(UCI,J+1,K+1)+U(!,J+1,Kl-U(I,J-1,K+1)-U(I,J-1,K)l•0.25      988    1 32
       198    0Q706EI          UE3=(U(I,J+1,K)+u(I,J•1,K-1)-U(I,J-1,K)-u<I,J-1,K-1))•0.25      989    133
       n9     007A26!          LlS:=(U(I•1,J,K+1)+U(I,J,K+1)-U(!+1,J,K-1)-U{I,J,K-1))•0.25     990    134
       200    007ADAI          usw={U(I,J,K+1)+ucr-1,J,K+1)-U(I,J,K-1)-U(I-1,J,K-1))•0.25      991    135
       201    0079 3: !        us~=(UCI,J+1,K+1)+UCI,J,K+1)-U(I,J+1,K-1)-U(I,J,~-1))•0.25      992    1 36
                                                                                                              oo

                                                                                                             i~
       202    OC7C42I          USS=(u{I,J,K+1)+u(I,J-1,K+1)-U(I,J,K-1)-U{I,J-1,K-1))•0.25      993    1 37
       203    007CF6I          UST=UC!,J,K+1)-U{I,J,K)                                         994    1 38
       204    00704AI          USS=U(I,J,K)-U(I,J,K-1)                                         995    139
       205    007C9EI          VC:=V(I+1,J,K)-VCI,J,K)                                         996    140
       206
       207
              0070F4I
              007E4AI
                               VCW=V(I,J,K)-V(I-1,J,K)
                               VCN=(V(I+1,J+1,K)+V(I+1,J,K)-V(!-1,J+1,K)-V(I-1,J,K))•0.25
                                                                                               997    141         ~
                                                                                                                  ,-
                                                                                               998    142
       208    0071=G6I         VCS=(V(I+1,J,K)+V(I+1,J-1,K)-V(I-1,J,K)-V(I-1,J-1,K))•0.25      999    14 3
       209    001cc2r          VCT=(V(I+1,J,K+1)+V(!+1,J,K)-V(I-1,J,K+1)-V(I-1,J,K))•0.25                    ,0 "U
                                                                                              1000    144
       210
       211
              00807,H
              '.)J9132!
                               VC3=(V(I+1,J,K)+V(I•1,J,K-1)-V(I-1,J,K)-V(I-1,J,K-1)) ■ 0.25
                               VE:=(V(I+1,J+1,K)+V(I,J+1,K)-V(I+1,J-1,K)-V(I,J-1,K))•0.25
                                                                                              1001
                                                                                              1002
                                                                                                      145    ~i;
                                                                                                             r-
                                                                                                              111
                                                                                                      146
       212    0081i:EI         VEW=(VCI,J+1,K)+V(!-1,J+1,K)-V(I,J-1,K>-vcr-1,J-1,K))•0.25     1003    147
       21 3
       214
              J082AAI
              008300!
                               VcN=V(I,J+1,K)-VCI,J,K)
                               VES=VC!,J,K)-V(I,J-1,K)
                                                                                              1004    148    ~i'A
                                                                                              1C05    149
       21 5   0083561          V:T=(VCI,J+1,K+1)+V(I,J+1,K)-V(I,J-1,K+1)-VCI,J-1,K))•0.25     1006    150
       216    00840EI          Ve3=(VCI,J+1,K)+V(!,J+1,K-1)-V(I,J-1,K)-V(I,J-1,K-1)l•0.25     1007    1 51
       21 7   0J84C6I          VSE=(V(I+1,J,K+1)+VCI,J,K+1)-V(!+1,J,K-1)-V(!,J,K-1))•0.25     10'09   1 52
       218    00357AI          VSw=CV(I,J,K+1)+V(I-1,J,K+1)-V(I,J,K-1)-vcr-1,J,K-1l)•0.25     1009    153
       219    00862i:1         VSN=(V(!,J+1,K•1)+VCI,J,K+1)-V(I,J+1,K-1)-V(I,J,K-1))•0.25     1010    154
       220    0086:2!          VSS=CV(I,J,K+1)+VCI,J-1,K+1)-VCI,J,K-1)-V(I,J-1,K-1)) ■ 0.25   1011    1 55
       2 21   008796!          VST=V(I,J,K+1)-V(I,J,K)                                        1012    1 56
       222    0087:AI          VS3=VCI,J,K)-V(!,J,K-1)                                        1013    1 57
       223    00l:l63EI        WCE=W(I+1,J,K)-WCI,J,K)                                        1014    1s a
       224    0J8894I          wCW=WCI,J,K)-w(I-1,J,K)                                        1015    159
       225    0081:lEAI        wCN=(w(I+1,J+1,K)+W(I+1,J,K)-w(I-1,J+1,K)-w(I-1,J,K))•0.25     1016    160
       226    0089A6I          wCS=(W(I+1,J,K)+w(I+1,J-1,K)-W(I-1,J,K)-W(I-1,J-1,K))•0.25     1017    161
       227    J08A62I          wCT=(w(I+1,J,K+1)+W(I+1,J,K)-W(I-1,J,K+1)-W(I-1,J,K))•0.25     1018    16 2
       228    o:Be1AI          wCB=(w(I+1,J,K)+w(I+1,J,K-1)-w(I-1,J,K)-W(I-1,J,K-1))•0.25     1019    163

....
0)
C')
~
      Z29    0058D21     WEE=(W(I+1,J+1,K)+WCI,J+1,K)-w(I+1,J-1,K)-w(I,J-1,K))•0.25          1020     164
      2 30   008C3El     WEW=(W(l,J+1,K)+W(I-1,J+1,K)-W(I,J-1,K)-WCI-1,J-1,K))•0.25          1021     165
      2 31   008D4Al     WEN=W(I,J+1,K)-W(I,J,K)                                             1C22     166
      2 32   008DAOI     wES=W(I,J,K)-WCI,J-1,K)                                             1C23     167
      233    0030F6I     wET=(WCI,J+1,K+1)+W(I,J+1,K)-W(I,J-1,K+1)-W(I,J-1,K))•0.25          1024     168
      234    008EAEI     WE~=CwCI,J+l,Kl+WCI,J+l,K-1)-WC!,J-1,K)-W(I,J-1,K-1))•0.25          1025     169
      235    008F66I     wS:=(w(I+1,J,K+1)+W(I,J,K+1)-W(I+1,J,K-1)-WCI,J,K-1)l•0.25          1C26     170
      236    00901AI     •SW=(W(I,J,K+1)+w(I-1,J,K+1)-W(I,J,K-1)-W(I-1,J,K-1))•0.25          1Ci27    171
      237    0090CEI     wSN=(W(I,J+1,K+1)+w(I,J,K+1)-W(I,J+1,K-1)-W(I,J,K-1))•0.25          1028     172
      2 38   0091821     WSS=(w(I,J,K+1)+W(I,J-1,K+1)-W(!,J,K-1)-w(I,J-1,K-1))•0.25          1029     173
      239    009236!     •ST=wCI,J,K+1)-W(I,J,K)                                             1030     174
      240    00928Al     w53=WCI,J,K)-W(I,J,K-1)                                             1 o 31   175
      2 41   0092::EI    SUCI,J,K)=SUCI,J,K)-PCXI•CXCI,J,K)-P OA• X(I,J,K)-PSCI•SXC!,J,K)    1032     17!)
      242    009334!     CVCI,J,K)=DVCI,J,K)-PCXI•CYCI,J,K)-P ilA• YCI,J,K)-PSCI•SYCI,J,K)   1 033    177
      243    00948AI     DW(I,J,K)=OwCI,J,K)-PCXI•Cl(I,J,K)-P DA• ZCI,J,K)-PSCI•SZCI,J,K)    1034     178
      244    009560!     CX:=(CX(!+1,J,K)+CXCI,J,K))•0.5                                     1C35     1 79
      245    0095!3CI    cxw=(CX(I-1,J,K)+(X(I,J,K))•0.5                                     1036     180
      246    0096181     CXN=CCX(I,J+1,K)+CXCI,J,Kl)•0.5                                     1037     181
      247    0096741     CXS=CCXCI,J,K)+CXCI,J-1,K))•0.5                                     1038     132
      248    u096COI     CXT=(CX(!,J,K+1)+CXCI,J,K))•0.5                                     1039     183
      249    o:in 2AI    CXB=(CXCI,J,K)+CX(!,J,K-1))•0.5                                     1C40     184
      250    Oi.l97S4I   EX:=(EX(I+1,J,K)+EX(I,J,K))•0.5                                     1041     185
      251    0097EOI     EXw=(EX(I,J,K)+~X(I-1,J,K))•0.5                                     1042     186
      252    00983CI     EXN=(EXCI,J+1,K)+EXCI,J,Kll•0.5                                     1043     1 !!7
      253    0098981     EXS=C:X(l,J,K)+~X(I,J-1,K))•0.5                                     1C44     188
      254    0098F4I     EXT=(EXCI,J,K+1)•EXCI,J,Kl)•0.5                                     1045     189
      255    00994El     EX3=CEX(!,J,K)+EXCI,J,K-1))•0.5                                     1046     190
      256    0099A8I     SXE=(SX(I+1,J,K)+SX(I,J,K)l•0.5                                     1047     191
      257    009A04I     SX~=(SXCI,J,K)+SX(I-1,J,K))•0.5                                     1048     192
      258    009A60I     5XN=(SXC!,J+1,K)+SX(I,J,K))•0.5                                     1C49     193
      259    009ABCI     SXS=(SXCI,J,K)+SXCI,J-1,Kll•0.5                                     1 C50    194
      260    009818!     SXT=(SXCI,J,K+1)+5XCI,J,K))•0.5                                     1C51     195
      261    009B72I     SXB=CSXCI,J,K)+SXCI,J,K-1))•0.5                                     1052     196
      262    009BCCI     CE=GAE•CUCE•CXE+UEE•EXE+USE•SXE->                                   1053     197
      263    009COOI     ~w=GAW•(UCW•CXW+UEW•Exw+usw•SXw)                                    1054     198
      264    009C34I     ~N=GAN•CUCN•CXN+UEN•=xN+USN•SXN)                                    1055     199
      265    009C68I     CS=GAS•(UCS•CXS+UES•EXS+USS•SXS)                                    1 C56    200
      266    009C9CI     QT=GAT•CUCT•CXT+UET•EXT+UST•SXT)                                    1057     201
      267    009CDOI     QS=GAB•(UC9•CX9+U=B•:XS+usa•SXS)                                    1058     202
      268    009D04I     SOC1=CXCI,J,K)•CCE-Qw)+EXLI,J,K)•(QN-QS)+SXCI,J,K)•CQT-CB)          1059     203
      269    0090A4I     Qc=GAE•(VCE•Cx:•VEE•:XE•vSE•SXE)                                    1C60     204
      270    0090081     Qw=GAW•(VCW•CXW+VEW•EX~•vsw•SXW)                                    1061     205
      271    009:0Cl     QN=GAN*(VCN•CXN+VEN•EXN+VSN•SXN)                                    1062     206
      272    009!:401    CS=GAS•CVCS•CXS+VES•EXS+VSS•SXS)                                    1063     207
      273    009E74I     QT=GAT•(VCT•CXT+V!:T•EXT+VST•SXT)                                   1064     208
      274    009EA8I     Q6=G~B•CVCB•CX8+VEB•EXB+VSS•SX8)                                    1065     209
      275    009EOC:I    SDC2=CYCI,J,Kl•CJE-QW)+EYCI,J,K)•CCN-QS)+SY(I,J,K)•CQT-QS)          1066     210
      276    009F7CI     QE=GAE•CWCE•CxE+WEE•Exe•wsE•SXE)                                    1067     211
      277    009FBOI     Q~=GAW*(WCW•CXW+WEW•EXW+WSW•SXW)                                    1068     212
      278    009FE4l     ;N=GAN•(WCN•CXN+W:N•EX~+WSN•SXN)                                    1069     213
      279    OOA018I     QS=GAS•CWCS•CXS+WES•EXS+WSS•SXS)                                    1070     214
      280    00A04CI     CT=GAT•CWCT•CXT+WET•EXT+WST•SXT)                                    1071     215
      281    00A080I     Q6=GAB•CWCB•CX8+wEB•EXB+wSB•SXB)                                    1072     216
      232    00AOB4I     SOC3=CZCI,J,K)•CQE-QW)+EZCI,J,K)•(CN-QS)+SZCI,J,K)•CQT-Q8)          1073     217
      283    00A154I     S0CI,J,K)=SU(I,J,K)+soc1~soc2+soc3+APOCI,J,K)•FOCI,J,K)             1074     218
      284    00A206I     CYE=CCYCI+1,J,K)+CYCI,J,K)l•0.5                                     1075     219
      285    00A262I     CYW=CCYCI,J,K)+CYCI-1,J,Kll•0.5                                     1076     220
      286    OOA2BEI    CYN=(CYCI,J+1,K)+CYCI,J,Kll•0.5                              1077     221
      287    00A31AI    CYS=(CYCI,J,K)+CY(I,J-1,Kll•0.5                              1078     222
      288    OOA376I    CYT=(CYCI,J,K+1l+CYCI,J,K)l•0.5                              1079     223
      289    00A3DOI    CYe=CCY(I,J,K)+CY(I,J,K-1))•0.5                              1080     224
      290    00A42AI    EYE=CEYCI+1,J,Kl+EYCI,J,Kll•0,5                              10 81    225
      291    00A486I    EYW=(EY(!,J,K)+EY(!-1,J,Kll•0.5                              1082     226
      292    00A4E2I    EYN=CEYCI,J+1,K)+EYCI,J,Kll•0,5                              1083     227
      2 93   00A53EI    EYS=CEYCI,J,Kl+EYCI,J-1,Kll•0,5                              1084     228
      294    OOA59AI    EYT=CEY(I,J,K+1)+EYCI,J,Kll•0.5                              1085     229
      295    OOA5F4I    EY3=CEYCI,J,~l•EYCI,J,K-1ll•0.5                              1086     230
      296    00Ae4:I    SYE=(SY(I+1,J,K)+SYC!,J,Kll•0,5                              1087     231
      297    00A6AAI    SYw=CSYCI,J,K)+SYCI-1,J,Kll•O.S                              1088     232
      29B    00A706I    SYN=CSYC!,J+1,K)+SY(I,J,Kll•0,5                              1 C89    233
      299    00A762I    SYS=(SYCI,J,K)+SY(I,J-1,K)l•0.5                              1090     234
      300    00A7BEI    SYT=(SY(I,J,K+1)+SY(!,J,K)l•0.5                              1091     235
      301    OOA818I    SY3=CSYCI,J,~l+SYC!,J,K-1ll•0.5                              1092     236
      302    00A872I    QE=GAE•CUCE•CYE+UEE•=YE+USE•SYE)                             1093     237
      303    00A8A6I    QW=GAW•(UCW•CYW+UEW•EYW+USW•SYW)                             1094     238
      304    OOA8DAI    QN=GAN•(UCN•CYN+UEN•EYN+USN•SYN)                             1095     239
      305    00A90:I    OS=GAS*(UCS•CYS+UES•EYS+USS•SYSl                             1096     240
      306    JOA942!    QT=GAT*(UCT•CYT+UET•EYT+UST*SYT)                             1097     241
      307    OOA976I    Qa=GAB•CUC!•CY3+UEB•EY9+US3•SYS)                             10 98    242
      30B    00A9AAI    SOC1=CXCI,J,Kl•C~E-~Wl+EXC!,J,Kl*(,N-QS)+SXCI,J,Kl•CQT-QB)   1099     24 3
      309    00AA4AI    JE=GAE•CVCE•CYE+VEE*EYE•VSE•SYE)                             1100     244
      310    00AA7EI    ow=GAW*(VCW•CYW+VEW•EYW+VSW•SYW)                             1101     245
      311    00AAB2I    QN=GAN•(VCN•CYN+VEN•EYN+VSN•SYN)                             1102     246
      312    OOAAE6!    QS=GAS•(VCS•CYS+VES•EYS+vsS•SYS)                             1103     247
      313    00AB1AI    QT=GAT•(VCT•CYT+VET•EYT+VST•SYT)                             1104     248
      314    OOA:l4EI   QB=GAB•CVCB•CY3+VEB•EYB+VSB•SY9l                             110 5    249
      315    00AB82I    SOC2=CY(!,J,Kl•(CE-~W)+Evc:,J,K)•CCN-QS)+SY(I,J,K)•(QT-CB)   1106     250
      316    OOAC22I    QE=GAE•CWC:•CYE+~E:•EYE+WSE•SYE)                             1107     251
      317    00AC56I    QW=GAW•(WCW•CYW+WEW•EY~•wsw•SYW)                             1108     25 2
      318    00AC8AI    CN=GAN•CWCN•CYN+WEN•EYN+WSN•SYN)                             1109     253
      319    OOACSEI    QS=GAS•CWCS•CYS+wES•EYS+WSS•SYS-)                            111 0    254
      320    00ACF2I    QT=GAT•(wCT•CYT+WET•EYT+WST•SYT)                             1111     255
      321    OOA026I    CB=GAB*(wCS•CY8+WES•EY8+wSB•SYS)                             111 2    256
      322    OOAOSAI    SOC3=CZCI,J,Kl•CCE-CW>•EZCI,J,K)•CQN-QS)+SZCI,J,Kl•CQT-QS)   111 3    257
      323    OOAOFAI    DV(I,J,K)=OVCI,J,Kl+SOC1+soc2+soc3                           1114     258
      324    00A::58I   CZE=CCZCI+1,J,K)+CZCI,J,K)l•O,S                              111 5    259
      325    00AES4I    czw=(CZCI,J,K)+CZ(I-1,J,Kl)•0.5                              1116     260
      326    OOAF10I    CZN=(CZCI,J+1,K)+CZCI,J,Kll•O.S                              111 7    261
      327    00AF6CI    CZS=CCZCI,J,K)+CZCI,J-1,Kll•0.5                              111 8    262
      328    00AFC8I    CZT=CCZ(I,J,K+1)+CZCI,J,Kl)•0,5                              1119     263
      329    OOB022I    CZS=CCZCI,J,K)+rzcr,J,K-1)) ■ 0,5                            11 20    264
      330    OO:l07CI   EZE=(EZ(I+1,J,K)+:ZCI,J,Kll•O.S                              11 21    265
      331    008003!    EZw=CEZCI,J,K)+:ZC!-1,J,Kll•0.5                              1122     266
      332    008134!    EZN=CEZCI,J+1,Kl•EZCI,J,Kll•0,5                              1123     267
      333    OO!l190I   EZS=CEZCI,J,~l•EZCI,J-1,~)l•0.5                              1124     268
      334    OOB1ECI    EZT=CEZCI,J,K+1)+EZCI,J,~l>•0.5                              11 2 5   269
      335    006246!    EZB=CEZCI,J,K)+EZCI,J,K-1))•0,S                              1126     2 70
      336    0032AOI    SZE=CSZCI+1,J,K)+SZCI,J,K)l•0.5                              11 27    271
      337    OOS2FCI    SZW=(SZCI,J,K)+SZCI-1,J,Kll•0.5                              1128     272
      3 38   00o358I    SZN=CSZCI,J+1,Kl+SZCI,J,K))•0.5                              11 29    273
      339    OOBB4I     SZS=CSZCI,J,K)•SZCI,J-1,Kll•0.5                              11 30    274
      340    0084101    SZT=CSZCI,J,K+1)+SZCI,J,Kll•0.5                              1131     275
      341    OOB46AI    SZB=CSZCI,J,K)+SZCI,J,K-1)) ■ 0,5                            1132     276
      342    OOB4C4I    QE=GAE•CUCE•CZE+UEE•Eze+uSE•SZ:)                             1133     277
C')
~
0:,
A     343    0054"8!             ~w=GAW•(UCW•CZW+UEW•EZ~•USW•SZW)                             1134     278
      344    00B52CI             ~N=GAN*(UCN•CZN+UEN•EZN•USN•SZNl                             1135     279
      345    OJS560I             ~S=GAS•CUCS•CZS+UES•EZS+USS•SZS)                             1136     280
      346    OJSS94I             ;T=GAT•CUCT•CZT•UET•EZT+UST•SZT)                             1137     281
      347    OOSSC8I             :3=GA5•(UC3•CZ3+UES•:Ze+US8•SZS)                             1138     282
      348    OOSSFC!             S0C1=CXCI,J,Kl•C:E-~Wl+!XCI,J,Kl•CCN-~S)+SX(I,J,Kl•(~T-QB)   1139     283
      349    OOS69CI             C!=GAE•CVCE•CZE+VEE•EZE+VSc•SZE)                             1140     284
      350    003oCOI             :w=GAw•(VCW•CZw•VEW•:ZW•VS~•SZW)                             11 41    285
      351    00e704I             ~N=GAN•(VCN•CZN•VEN•EZN•VSN•SZ~l                             1142     286
      352    003738!             ~S=GAS•(VCS•CZS+VES•:ZS+VSS•SZS)                             1143     287
      353    0037~CI             ~T=GAT•(VCT•CZT•VEi•!ZT•VST•SZT)                             1144     288
      3; 4   OOeHOI              ~8=GA8•CVCS•CZS+VEB•EZS•VS2•SZ8l                             1145     289
      355    J05704I             SOCZ=CY(I,J,Kl•(~E-;w)+:YCI,J,Kl•C;N-QSJ+SYC!,J,(l•CCT-CBl   11 46    290
      356    J03874I             ;:=GAE•(WCE•CZ:+W:!•EZE•wSE•SZEl                             1147     2 91
      357    J058A3!              =•=GAW•(W(W•CZw+wEW•EZ~•wSW•SZW)                            1148     292
      358    0038'.lCI           ;N=GAN•CWC~•CZN•w:N•!ZN•~SN•S!N)                             1149     293
      359    JJ,910!             ~S=GAS•C~CS•C!S+wES•!ZS+wSS•SZS)                             11 so    294
      3o0    0:J3•44I            :T=GAT•(wCT•CZT•w:T•EZT•WST•SZT)                             11 51    295
      361    CJ3973I             ~3=Gl5•CWC!•CZ3•wE9•EZS•~S!•SZ!l                             1152     296
      362    CS:39AC I           SOC3=CZ(!,J,K)•C:e-:wl•EZ(I,J,K)•(;N-:Sl•SZCI,J,Kl•(~T-Cel   1153     297
      363    003A4C I            JwCI,J,KJ=:wc:,J,Kl•SOC1•SCC2•SCC3                           1154     298
      364    ),J3AH I            Sl.CI,J,K)=SUCI,J,Kl•TJCC!,J,()                              11 5 5   299
      365    OJ331CI             SP(I,J,K)=S,((:,J,Kl•TJOCI,J,Kl                              11 56    300
      360    OG:.BU        1 5 (QlljT !NU[                                                    1157     301
      3e7    OG3~:cr             GO TC eC                                                     1158     302
      368                C-----V-SCUi<CE                                                      1159
      369    JOS3:2:       2     CONTINUE                                                     1160     303
      370    JJ3S:2I             co 25 I=IS,:T                                                1161     304
      3 71   OO!o=Ar             00 25 J=JS,JT                                                11 62    305
      372    :JO!C12I            :;c ,5 K=KS,KT                                               1163     306
      3 73   005C2AI             SUCI,J,KJ=(~VCI,J,K)+A?C(I,J,Kl•F0CI,J,Kll•TJ0(I,J,K)        1164     307
      374    005CEEI        25 CJ'<TINl,:                                                     1165     308
      375    00SD36I             GC TO cc                                                     1166     309
      376                C-----w-SCUi<CE                                                      1167
      377    00S03CI        3    CONTINUE                                                     1168     310
      3 78   003D3C!             00 35 I=IS,IT                                                1169     311
      379    OJ!.JS4I            00 35 J=JS,JT                                                1170     312
      380    OG6D6CI             DO 35 K=KS,KT                                                11 71    313
      381    GJ3~84I             Sl.(I,J,Kl=(CW(I,J,K)+APO(I,J,Kl•FO(!,J,Kll•TJO(I,J,~)       1172     314
      382    Ou:!E48I       35 CONTINUE                                                       1173     315
      383    OG5E90I             GO TO eC                                                     1174     316
      384                C-----Ti-1-SOURC:                                                    11 75
      395    006E96I       4     CONTINUE                                                     1176     317
      386    OJ3E96I             GO TO 6C                                                     1177     318
      387                C-----K-SCURCE                                                       1178
      338    003E9CI        s CONT!r-.lJE                                                     1179     319
      389    OiBE9CI             00 S 5 I=!S,IT                                               1180     320
      390    005E34I             GC 55 J=JS,JT                                                1181     3 21
      3 91   005:CC:             ;)Q 5 5 K=KS,KT                                              1182     322
      392    OOSEE4I             SU(I,J,Kl=GEN(!,J,Kl+PPCI,J,Kl+APO(I,J,K)•FO(I,J,K)          1183     323
      393    OJe"AA!             P1=CENCI,J,Kl••2                                             1184     324
      394    OOBFDEI             S?(I,J,Kl=SP~(I,J,Kl-C~U•P1•F(I,J,K)/VIS:(I,J,K)             1185     325
      395    OOCOSAI             SUCI,J,Kl=SUCI,J,Kl•TJCCI,J,Kl                               1186     326
      396    OOCOFCI             S?(I,J,Kl=SP(I,J,Kl•TJO(I,J,K)                               1187     327
      397    OGC16:I        55 CONTINLE                                                       1188     328
      398    GGC166I             GO TO ,.-~-                                                  11 89    329
      399                C-----:-SCURCE                                                       1190
      400    ooc1acr      6      C0NTINLE                                                    1191     330
      401    ooc1acr             00 65 I=IS,IT                                               1192     3 31
      402    00C104I             CO 65 J=JS,JT                                               1193     332
      403    00C1ECI             DO 65 K=KS,l(T                                              11 94    333
      404    0OC204I             P1=C:N(I,J,O••2                                             1195     334
      405    00C238I             SU(I,J,Kl=SU(!,J,Kl+C1•C~U•G=N(I,J,Kl•P1•DK(I,J,Kl/         1196     335
      406                      1            VISE(I,J,K)+AP0(!,J,K)•F0(I,J,K)                 1197
      407    00C35CI             T~0K=0K(I,J,K)•SM~UM                                        1198     336
      408    0CC38EI               S?(I,J,Kl=SPK(!,J,K)-C2•D=N<I,J,K)•~<I,J,K)/TMCK          11 99    337
      409    00C43AI            SU(I,J,Kl=SUC!,J,K)•~J0(!,J,Kl                               1200     338
      410    00C4~CI            S?Cl,J,Kl=S~C!,J,Kl•TJCCI,J,K)                               1201     339
      411    00C51EI       65 C0NTINLE                                                       1202     340
      412    00C566I            GO TO 6C                                                     1203     3 41
      413               c-----:>r=-scu,c::                                                   1204
      414    JCC56CI      7     C0NTI!,U:                                                    1205     342
      415    00C56CI            :,o 75 I=IS,I:                                               1206     343
      416    0CC5S4I            '.)'.) 75 J=JS,JT                                            1207     344
      417    C'JC59CI           DO 75 K=KS,KT                                                1205     345
      418    00C534I            SU(I,J,K)=Su(!,J,~)+J.e5•GEN(I,J,K)+AP0(I,J,Kl•F0CI,J,K)     1209     346
      419    00C6o0I            TMJK=CK(!,J,K)•SMNUM                                         1210     347
      420    00C632I            S?CI,J,Kl=SP~CI,J,K)-0:(I,J,K)/T~CK                          1 211    34$
      421    00C72C I           SUC!,J,Kl=SUC!,J,Kl•TJCCI,J,K)                               1 21 2   349
      422    00C79:I            SP(I,J,Kl=SPCI,J,Kl•TJC(I,J,Kl                               1213     350
      423    00C810I      75 C0NTINLE                                                        1214     351
      424    00C353I      60 C0NTI~U::                                                       1 21 5   352    00
      425               C-----MQ:,IFY ~ALL 3CUN2~~y CCN:ITI0NS THQU WALL FUNCTIONS                           "Tl ::0
                                                                                             1216
      426    00Cd58I             IF(IG .~E. 2) GC TO 41C                                     1217     353    "'tJ5
      427    00C86EI            CALL BCUNC(IE,F)                                             1 218    355    oz
      428    00C89CI     410 CCNTINLc:                                                       1219     356    0>
      429               C-----SET SY~~tTRIC, CYCL!C AN~ :XIT L!NK C0EFF.                     12 20           ::0   r-
      430    O0C89CI            CALL SYM0UT(Z,IE,IS,IT,JS,JT,KS,KT)                          1221     357
      431               C-----LINK CCEFF. ASSEM3LY ANC 3L0CKAGtS                                             ,0 "'tJ
      432    00C8D8I             Q0 500 I=IS,IT
                                                                                             1222
                                                                                             1223     358
                                                                                                             c:>
                                                                                                             >tO
      433    0DC8F0I             DO 500 J=JS,JT                                              1224     359    r- .,,
      434    O0C908I             DO 500 ic:=KS,KT                                            1225     360
      435    00C920!             F1(I,J,l():C(!,J,K)                                         1226     3 61   ~ti
      436    00C972I               ANA!=AE(!,J,~l•AW(I,J,K)+AN(I,J,K)•AS(I,J,K)+AT(I,J,K)+   1227     362
      437                      1         A~(I,J,K)+~P0(I,J,K)                                1228
      438    00CA82I               AP(I,J,K)=A~AS-S:>(I,J,Kl                                 1229     363
      439    00CA04I               PDUV=1 .C                                                 12 30    364
      440    00CAE0I               IF(~CCI,J,~) .LT. 1) GC TG 530                            1231     365
      441    00CB16I               AP(!,J,Kl=HF                                              1232     367
      442    00C642I               AN(I,J,Kl=0.0                                             1233     368
      443    00C56EI               AS(I,J,Kl=G.0                                             1234     369
      444    00CB9AI               AECI,J,Kl=0.'.J                                           1235     370
      445    00CBC~I               AW(I,J,K)=~.0                                             1236     3 71
      440    00C3F2I            AT(I,J,Kl=0.0                                                1237     372
      447    00CC1EI            AS ( I,J,I( l=0. ,J                                          12 38    373
      448    00CC4AI            SU(I,J,K):F(I,J,K)                                           1239     3 74
      449    00CC9CI            PCUV=0.C                                                     1240     375
      450    00CCA8I     530 CONTINUE                                                        1241     376
      4 51              c-----uNDEQ-QELAXAT!0N                                               1242
      452    00CCA8I               P1=1.2•AP(I,J,K)                                          1243     377
      453    00CCDAI               AP(I,J,Kl=APCI,J,K)/ALF                                   1244     378
      454    00CD2CI               SU(I,J,Kl=SUCI,J,K)+PDUV•C1.0-ALF)*AP(I,J,Kl•F(l,J,K)     1245     379
      455    oocaocr               IF(IE .EQ. 1) DU(I,J,Kl=TJ0CI,J,K)•P0UV/(P1-ANA8)         1246     380
      456    00CE4CI     500       CONTINi,;E                                                1247     382
0)
()1
4 57              C-----LINEA~ E~UATIONS SLOVER                                              1248
458    OOCE94I            CO 550 !=1,ISWF                                                    1249    383
459    OOCEA8I     550 CALL LI~ERX(1,IS,JS,KS,IT,JT,KT,F)                                    1250    B4
460               C-----CALCULATE ~AXIMI.JM CORRECTION OF CURRENT ITERATION                  1251
461    oocr=ocr           DO 555 I=IS,IT                                                     1252    385
462    OOCF24I            CO 555 J=JS,JT                                                     1253    386
463    OOCF3CI            DO 555 K=KS,KT                                                     1254    387
464    00CF54I            P1=A8S(F(I,J,K)-F1(!,J,K))                                         1255    388
465    OOCFCAI            :RRF=A~AX1(E~RF,P1)                                                1256    389
466    JOCF:AI     555 CONT!NUE                                                              1257    390
467    0000321            ~i:Tl.~N                                                           1258    391
468
469
                  c---------------------------------------------------------------------
                  c-----;, ECUHION
                                                                                             1259
                                                                                             1260
4 70   OOD03AI      10   CONTINUE                                                            1261    392
471    00003AI            :s=2                                                               1262    393
472    ,)QC042I           IT=L                                                               1263    394
473    00004!:I          JS=,                                                                1264    395
474    0000561           JT="                                                                1265    396
475    OOQ062I           KS=2                                                                1266    397
4 76   00006AI           I<. T=N                                                             1267    398
477               c-----sou~C!: AT PX LCCATIONS                                              1268
4 78   OC0076I           JO 310 I=!S,IT                                                      1269    399
479    OO:i08EI          DO 310 J=JS,JT                                                      1270    400
430    OODOA6I           CO 310 K=KS,!(T                                                     12 71   401
481    OOOOBEI           FCI,J,O=O.C                                                         1272    402
482    OOOOFOI           SUKCI,J,K)=O.O                                                      1273    403
483    00011CI           SPKCI,J,K>=O.O                                                      1274    404
484    0001481           SPCI,J,IO=O.O                                                       1275    405
485    OJ0174I           Oi:NE=DE~CI,J,K)                                                    1276    406
486    0001AOI           DEN~=OE~(I-1,J,K)                                                   1277    407
487    000100I           OENN=0.25•(DENCI,J,K)+CEN(I-1,J,K)+O N(I,J+1,K) ♦ QENCI-1,J+1,K))   1278    408
438    00il284I          OENS=0.25•CCENCI,J,K)+CENCI-1,J,K)+C NCI,J-1,K)+DEN(I-1,J-1,K))     1279    409
489    0003381           CENT=0.2S•(OEN(I,J,~)+CENCI-1,J,K)+O N(I,J,K+1)+CENCI-1,J,K+1))     1280    410
490    0003E8I           DENe=0.25•COENCI,J,K)+DEN(!-1,J..,K)+D NCI,J,K-1)+DENCI-1,J,K-1))   1281    411
491    000498I           UE=i.JCI,J,I()                                                      1282    412
492    0004C4I           Uw=L <r-1 ,J,K >                                                    1283    413
493    0004F4I           I.JN=C.25•CUCI,J,K)+U(I-1,J,K) ♦ U(I,J+1,K) ♦ U(I-1,J+1,K))         1284    414
494    0005A8I           US=C.25•CUCI,J,K)+U(I-1,J,K)+UCI,J-1,K) ♦ U(I-1,J-1,K))             1285    415
495    00065CI           UT=C.25•(U(I,J,K)+U(I-1,J,K)+U(I,J,K+1)+U(I-1,J,K+1))               1286    416
496    OOD70CI           U8=C.25•(UCI,J,K)+U(I-1,J~K)+UCI,J,K-1)+U(I-1,J,K-1))               1287    417
497    OOD76CI           VE=V(I,J,I()                                                        1288    418
498    0007E8I           VW=V(!-1,J,K)                                                       1289    419
499    C00818I           VN=C.25•(V(I,J,K)+V(I-1,J,K)+VCI,J+1,K)+V(I-1,J+1,K))               1290    420
500    OOD8CCI           VS=C.25•(V(I,J,K)+V(!-1,J,K)+VCI,J-1,K)+V(I-1,J-1,K))               1 291   4 21
501    0009801           VT=C.25•CV(I,J,K)+V(I-1,J,K)+V(I,J,K+1)+V(I-1,J,K+1)l               1292    422
502    000A30I           V3=C.25•(V(I,J,K)+V(I-1,J,K)+V(I,J,K-1l+V(I-1,J,K-1))               1293    423
503    OODAEOI           wi:=WCI,J,K)                                                        1294    424
504    oooaocr           ww=wCI-1,J,Kl                                                       1295    425
505    OOD63CI           ~N=G.2S•Cw(I,J,K)+W(I-1,J,K)+W(I,J+1,K)+W(I-1,J+1,K)l               1296    426
506    OOOSFOI           ws=C.25•(w(I,J,K)+w(I-1,J,K)+W(I,J-1,K)+W(I-1,J-1,K))               1297    427
507    OOOCA4I           WT=C.25*(W(I,J,K)+w(I-1,J,K)+w(I,J,K+1)+W(I-1,J,K+1))               1298    428
508    000D54I           WB=C.25•(w(I,J,K)+W(I-1,J,K)+W(I,J,K-1)+W(I-1,J,K-1))               1299    429
509    OOCE04I           CXC=O.S•CCXCI,J,K)+CXCI-1,J,K))                                     1300    430
510    OODE60I           EXQ=0.5•CEXCI,J,K)+EXCI-1,J,K))                                     1301    4 31
5 11   OOOE6CI           SXQ=0.5•(SX(I,J,K)+SxCI-1,J,K))                                     1302    432
512    00DF18I           CY~=O,S•CCYCI,J,K)+CYCI-1,J,K))                                     1303    433
513    OOCF74I           EYC=O.S•CEYC!,J,K)+EYCI-1,J,K))                                     1304    434
      514    OOOFDOI            SYQ=0.5•(SY(!,J,K)+SYCI-1,J,K))                                    1305    435
      515    OOE02CI            CZQ=C.S•(CZ(!,J,K)+CZCI-1,J,K))                                    1306    436
      516    OOE088I            EZQ=0.5•CEZCI,J,K)+EZCI-1,J,K))                                    1307    437
      51 7   OOEOE4I            SZQ=0.5•(SZ(I,J,K)+szcr-1,J,K))                                    1308    438
      518    OOE140I            CE=CENE•CU:•CXC+VE•CYQ+WE•CZQ)                                     1309    439
      519    00!:174!           CW=CENW•(UW•CXQ+VW•CYQ+WW•CZQ)                                     1310    440
      520    OOE1A8I            CN=CENN•(UN•EXC+VN•EYQ+WN•EZC)                                     1311    441
      5 21   00::1CCI           CS=CENS•(US•EXC+VS•EY~+WS•!:ZQ)                                    1312    442
      522    OOE210I            CT=C:NT•CUT•SXC+VT•SYQ+WT•SZQ)                                     131 3   443
      523    0-JE244I           CB=CENB•(U3•Sx:+vS•SYQ+W3•SZQ)                                     1314    444
      5 24   00!::278I          SUKCI,J,K)=-CCE-Cw•CN-CS+CT-CB)•(TJO(I-1,J,K)+TJOCI,J,K))•0.5      131 S   445
      525    OOE322I      310 CONTINLE                                                             131 O   446
      526                C-----SOURCE ~T Py LCCAT!Of<S                                             1317
      527    ,JQE36AI           DO 3 11 !=IS, IT                                                   1318    447
      52a    00:382!            co 311 J=JS,JT                                                     1319    448
      529    OOE39AI            :::o 311 K=KS,KT                                                   1320    449
      530    00:3:!2!           DENN=OEl\o ( I ,J,K)                                               13 21   450
      5 31   OOE3DEI            OENS=OEN(I,J-1,K)                                                  1322    451
      532    00:40EI            O!:NE=0.25•CC:NCI,J,Kl+CENCI,J-1,~)+CEN(I+1,J,Kl+OEN(l+1,J-1,K))   1323    452
      533    OOE4C2I            DEN~=O.ZS•CDENCI,J,Kl+C:NC:,J-1,~)+0:NCI-1,J,K)+QENCI-1,J-1,Kl)    1324    453
      534    OJE57oI            DENT=0.25•CC:NCI,J,K)+C:NC!,J-1,K)+CENCf,J,K+1)+DENCI,J-1,K+1))    13 25   454
      535    OOE62oI            O:Nc=0.25•CCEN(I,J,K)+C:NC!,J-1,K)+~EN(I,J,K-1)+0EN(I,J-1,K-1))    1326    455
      536    OOE6DoI            UN=LCI,J,i<.l                                                      1327    456
      537    OOE702!            US=L;(I,J-1,K)                                                     1328    457
      538    OOE732I            UE=0.25•CUCI,J,~)+UC!,J-1,K)+U(I•1,J,K)+U(I+1,J-1,K))              1329    458
      539    OOE7E6I            uw=C.25•(U(I,J,K)+u(I,J-1,K)+U(I-1,J,K)+U(I-1,J-1,K))              1330    459
      540    JOE89AI            UT=C.25•CU(I,J,K)+U(I,J-1,K)+U(I,J,K+1)+U(I,J-1,K+1))              1331    460
      541    00i:94AI           us=C.25•(U(I,J,K)+U(I,J-1,K)+U(I,J,K-1)+U(I,J-1,K-1))              1332    461
      542    OOE9FAI            VN=VCI,J,0                                                         1333    462
      543    OOEA26I            VS=VCI,J-1,Kl                                                      1334    463
      544    OOEA56I            VE=0.25•(V(I,J,K)+vc:,J-1,K)+V(I+1,J,K)+V(I+1,J-1,K))              1335    464
      545    OOEBOAI            vw=C.25•CV(!,J,K)+V(I,J-1,K)+V(I-1,J,K)+V(I-1,J-1,K))              1336    465
      546    OO!:B3EI           VT=C.25•CVCI,J,K)+V(I,J-1,K)+V(I,J,K+1)+V(I,J-1,K+1))              1337    466
      5 47   OOEC6EI            V3=C.25•(VCI,J,K)+V(I,J-1,K)+VU:,J,K-1)+VCI,J-1,K-1))              13 38   467
      548    OOED1EI            I.N=;. CI,J,K)                                                     1339    468
      549    DOE04AI            ws=i.<I,J-1,Kl                                                     1340    469
      550    00i:D7AI           WE=C.Z5•(W(I,J,K)+W(I,J-1,K)+w(I+1,J,K)+W(I+1,J-1,K))              1341    470
      5 51   OGEE2SI            ww=C.25•Cw(I,J,K)+W(I,J-1,K)+W(I-1,J,K)+W(I-1,J-1,K))              1342    4 71
      552    OOEEE2I            wT=C.25•(-.{I,J,K)+w(I,J-1,K)+W(I,J,K+1)+w(I,J-1,K+1))             1343    472
      553    OOEF92I            WB=C.Z5•Cw(I,J,K)+W(I,J-1,~)+w(I,J,K-1)+W(I,J-1,K-1))              1344    4 73
      554    00F042I            CXQ=C.S•CCXCI,J,Kl+CXC!,J-1,K))                                    1345    474
      555    00F09EI            EXC=0,5•(EX(I,J,K)+EXCI,J-1,K))                                    1346    475
      556    OOFOFAI            SXC=0.5•(SXCI,J,Kl+SX(I,J-1,K))                                    1347    476
      557    OOF156I            CY;=0.5•CCYCI,J,K)+CYCI,J-1,K))                                    1348    477
      558    OOF1S2I            EYQ=0.5•CEYCI,J,K)+EY(I,J-1~K))                                    1349    4 78
      559    OOF20EI            SYQ=0.5•CSYCI,J,K)+SYCI,J-1,Kll                                    1350    4 79
      560    OOF26Ar            CZQ=O.S•CCZCI,J,K)+CZCI,J-1,K))                                    13 51   480
      561    OOF2C6I            EZC=C.5•<:ZCI,J,K)+EZCI,J-1,K))                                    1352    481
      562    00F322I            SZC=0.5•CSZCI,J,K)+SZCI,J-1,Kll                                    1353    482
      563    00F37EI            CE=CE~E•(UE•cxc+vE•CYQ+WE•CZQl                                     1354    483
      564    OOF3B2I            CW=CENw•Cuw•cx;+vw•CYQ+ww•CZQ)                                     1355    484
      565    OOF3E6I            CN=CENN•CUN•EXC+VN•EYQ+WN•EZQ)                                     1356    485
      566    OOF41AI            CS=CENS•CUS•ExC+VS•EYQ+WS•EZQ)                                     1357    486
      567    OOF44EI            CT=CENT•CUT•SXC+VT•SYQ+WT•SZQ)                                     1358    487
      568    OOF482I            CB=CENB•CUB•SXQ+VB•SYC+W8•SZQ)                                     1359    488
      569    OOF4B6I            S?KCI,J,K)=-(CE-cw+CN-CS+CT-CB)•(TJO(I,J-1,K)+TJO(I,J,K)l•0.5      1360    489
      570    OOF560I      311   CONTINUE                                                           1361    490
O'l
-:i
CJ')
00     5 71                 C-----SOURCE AT PZ LOCATIONS                                              1362
       572    OOF5A9I              JO !12 I=IS,IT                                                     1363    491
       573    OOF5COI              DO 312 J=JS,JT                                                     1364    492
       574    OOF508I              :JC 312 K=KS,1(T                                                   1365    493
       575    QOFSFOI              :JENT=J:UI,J,Kl                                                    1366    494
       576    0Jf'o1CI             CENS=DE~CI,J,K-1)                                                  1367    495
       577    oo;:64AI             ~:N~=0.25•(C:N(I,J,K)+: NC!,J,K-1)+C ~(I,J+1,K)+OENCI,J+1,K-1))    1368    496
       578    OOF6FAI              JENS=0.25•(CEN(I,J,K)+ □ NCI,J,K-1)+C NCI,J-1,K)+CENCI,J-1,K-1))   1369    497
       5 79   OOF7AH               JE,:=G.2S•CC:~CI,J,K)+C N(!,J,K-1)+J N(I+1,J,K>+:ENCI+1,J,K-1))    1370    498
       580    UQF35~I              G:N•=0.25•CCENCI,J,Kl•C ~(I,J,K-1)+C N(I-1,J,Kl•CENCI-1,J,K-1))    1 371   499
       5 B1   00=90Al              JT=L(I,J,K)                                                        1372    500
       582    ·JOF936I             Uc=L. CI,J,K-1 l                                                   1373    501
       SS3    OJF96.:.I            J~=C.2!•(u(r,J.~l•uC!,J,K-1)•u(I,J 6 1,K)+U(I,J•1,K-1))            1374    502
       5o4    ()QCA14I             US=C.25•(U([,J,l)•UC!,J,(-1)+uc:,J-1,K)•J(!,J-1,K-1))              1375    503
       555    GCIFAC<+I            ut=~.25•CuCI,J,Kl•U(!,J,K-1)•u(I+1,J,K)+U(I+1,J,K-1))              1376    504
       586    CJ=57<+I             U~=C.25•CUCI,J,~)+J(I,J,K-1J+u(:-1,J,K)+U(I-1,J,K-1))              1377    50 5
       587    OOFC24!              VT=V(I,J,K)                                                        1378    506
       53E    OJccsor              va=vc:,J,K-1l                                                      1379    507
       B9     '.JJFC7::I           V~=C.25•CV(I,J,K)+V(!,J,K-1)+VCI,J+1,K)+V(I,J+1,K-1))              1360    508
       590    C)JC~2:!             vs=C.25•(V(I,J,K)+vc:,J,K-1J•vc:,J-1,K)~V(I,J-1,~-1))              13 81   509
       5 91   )J~J::I              VE=C.25•CV(I,J,Kl•V(I,J,K-1)•V(I+1,J,K)+V(I+1,J,K-1))              13!!2   510
       592    J-J=:8:I             v~=C.25•(V(I,J,K)+v(:,J,K-1)+V(I-1,J,K)+V(I-1,J,K-1))              1383    511
       593    oc;::r3e1            ~T=•CI,J,K)                                                        1384    512
       594    •)OF= 6 l I          •3=1.CI,J,K-1)                                                     1385    51 3
       595    00FF95!              •N=C.25•(w(I,J,~)•~CI,J,K-1)+wCI,J+1,Kl+wC!,J+1,K-1))              1380    514
       590    010'.l48I            ~s=C.25•(w(I,J,()+w(I,J,K-1)+w(I,J-1,Kl•~CI,J-1,K-1))              13!!7   515
       597    01COF8I              ~E=C.25•(w(I,J,K)•w(I,J,(-1)+w(I•1,J,K)+w(I+1,J,K-1))              1388    516
       598    J101A8I              •w=C.25•(w(I,J,K)+W(I,J,K-1)+W{!-1,J,K)+w(I-1,J,K-1))              1389    517
       599    J1025!!!             cx:=C.5•(CX(I,J,K)•CX([,J,K-1))                                    1390    518
       c:00   010252!              Ex:=O.S•CEXCI,J,K)•=X(I,J,K-1))                                    1391    519
       601    01030CI              sx:=O.S•(SX(!,J,K)+SXCI,J,K-1))                                    1392    520
       602    010366!              cv:=O.S•(CY(I,J,K)+CYCI,J,K-1))                                    1393    5 21
       603    0103:or              EY:=O.S•C:YCI,J,K)+EYCI,J,K-1))                                    13 94   522
       004    01041AI              SYQ=0.5•(SYCI,J,K)+$Y(:,J,K-1)~                                    139 5   523
       oOS    010474!              cr~=O.S•CCZ(I,J,K)•CZ(I,J,K-1))                                    1396    524
       606    0104C::I             ::z:=O.S•CEZCI,J,K)+EZCI,J,K-1))                                   1397    525
       607    010528I              sz:=O.S•CS!(I,J,K)+SZCI,J,K-1))                                    1398    526
       eos    010582!              CE=CEN:•CUE•Cx:+VE•CY:•~E•CZQ)                                     1399    527
       009    010556:              Cw=C=N••CUW•CX~•V••CYQ+ww•CZQ)                                     1400    523
       e10    0105EAI              CN=DEN~•(UN•Ex,•V~•EYC•WN•EZQ)                                     1401    529
       ¢ 11   01061 :I             CS=CE~S•(US•Ex:+vS•EY;•ws•EZQ)                                     1402    530
       c1 2   010652!              CT=CENT•(UT•sx:•VT•SY~•~T•SZ~)                                     1403    5 31
       61 3   010686I              C6=C:N5•CU3•SX~•VS•SYZ••S•SZ~)                                     1404    532
       014    01063AI              S?CI,J,Kl=-CCE-CW•C~-CS•CT-C3l•CTJOCI,J,K-1)+TJCCI,J,Kll•0.5       1405    533
       c1 5   01G762I        312 CONTINUE                                                             1406    534
       c16                  c-----LINK CCECF. ~NC SOURCE Tc,M AT CELL. CENTER                         1407
       017    0107AAI              DO 100 I=IS,IT                                                     1408    535
       018    0107C2I              DO 100 J=JS,JT                                                     1409    5 36
       61 9   0107DAI              QQ 100 K=KS,KT                                                     1410    537
       1:20   0107F2I              II=I-1                                                             1411    538
       6 21   0108COI              JJ=J-1                                                             1412    5 39
       t:22   01080EI              KK=K-1                                                             1413    540
       623    a1oa1cr              GAE=(CU(I,J,K)+CUCI,JJ,K)+Ou(I,J,KK)•DuCI,JJ,KK))•0.25             1414    541
       624    0108COI              GAW=(CU(II,J,K)+DU(II,JJ,K)+OUCII,J,KK)+DU(!I,JJ,KK))*0.25         1415    542
       625    010964I              GAN=(OLC!,J,K)+CUCII,J,Kl+OU(I,J,KK)+OU(II,J,KK)l•0.25             1416    543
       c:26   010~08!              GAS=CCU(I,JJ,K)•CU(II,JJ,K)+DU(!,JJ,KK)+CUCII,JJ,KK))*0.25         1417    544
       627    01•JAACI             GAT=CCUCI,J,K)+CUCII,J,Kl+OUCI,JJ,K)+GUC!I,JJ,Kll*0.25             1418    545
62d     010350!                GA3=(DUCI,J,KK)+CU(II,J,KK)+OU(I,JJ,KKl+OUCII,JJ,KKll•0.25            1419    546
629     010S"4I                TXXEQ=CTXXECI,J,Kl+TXXE(II,JJ,KK)l•0.5                                14 20   547
630     01GC4CI                Txx~Q=(TXX~(I,J,K)+TXXw(II,JJ,KK)l•O.S                                1421    548
6 31     01CCA4I               TYYN~=CTYY~(I,J,K)+TYYN(II,JJ,KKll•0.5                                1422    549
032     iJ 1'.J C" CI          TYYSQ=(TYYS(I,J,K)+TYYS(II,JJ,KK))•Q.5                                1423    550
033      01CD54I               TZZTQ=(TZZT(I,J,K)+TZ!T(II,JJ,KKl)•C.5                                1424    551
034      010CAC!               TZZ2~=(TZZ3(I,J,K)+TZZE(!I,JJ,KK)l•0.5                                1425    552
6 35     J10E04I               T:=CTJCCI,J,Kl+TJO(II,JJ,~K))•C.5                                     1426    553
636      010E5CI               lE(I,J,K)=T:•CG.1E•TXXEQ)                                             1427    554
637      01CE94I               Aw(I,J,Kl=TQ•(Gl~•TXXWQ)                                              1428    555
e38      010::CC               AN(!,J,K)=TQ•(~AN•TYYN;)                                              1429    556
639      J10F04I               AS(I,J,K)=T~w(GAS•TYYS;)                                              1430    5S7
640     01QF3CI                AT(!,J,Kl=T~•(GAT•TZZT:)                                              14 31   558
t 41     01'JF7i.I             •oC:,J,Kl=T;•(GA8wTZZ3C)                                              1432    559
tt.2                    C-----:>' SOLJ~C:                                                            1433
e43     Cl10"ACI               ?1=1.0                                                                1434    560
644     010,=ssr               0
                                 2=1.0                                                               1435    5 61
645     01::lFC<tI             P3:1 • 0                                                              1436    562
(;4C,   010F:OI                  o i.= 1. G                                                          1437    563
647     D10FJCI                05:1.0                                                                1438    564
61.8    010FE3:                Ot:1.Q                                                                1439    565
e "9    01GFFi.!               :F(GAN .:~. ~.0) P1=0.0                                               1440    566
050     011012!                r=(GAS .:Q. C.Cl P2=0.C                                               14 41   568
651     011030!                IF(GAE .EC. 0.0) P3=0.C                                               1442    570
t52     J1104EI                !"(GAW .sc. o.c~ P4=0.C                                               1443    572
653     01106CI                IFC~AT .:Q. 0.0) P5=0.C                                               1444    574
654     01108AI                !F(GA8 .EQ. 0.0) P6=0.C                                               1445    576
eSS     0110.16!               ?;=C.5•(CP1+P2)•CP3+P4•P5+P6)+(P3+P4)•(P1+P2+P5+P6)+                  1446    578
e56                          1          (P5+P6)•(P1+?2+03+?4))                                       1447
657     )1112AI                I=C?Q .EQ. C.Ol 0 Q=1.0                                               1448    5 79
cS!l    011148!                  SU(I,J,Kl=(P1•PS•su~CI,J,K)+?5•P2•SUK(I,J-1,K) ♦                    1449    581
659                          1                P2•P6•SU~CI,J-1,~-1l+P6•P1•SUK(I,J,K-1)+               1450
660                          2                P3•P5•SP~CI,J,K)+P5•P4•SPK(I-1,J,K)+                   14 51
661                          3                P4• 0 o•SPK(I-1,J,K-1l~?6•P3•SPK(I,J,K-1)+             1452
662                          4                P1•P3•SP(I,J,K)+P3•P2•SPCI,J-1,K)+                     1453
663                          5                ?2•P4•S?(I-1,J-1,K)+P4•P1•SP(I-1,J,K))/PC              1454
664     011'-0AI         1CO CC'ITINU':                                                              1455    582
665                     C-----LIN~ CCEFF. ASSEMSLY A~O BLOCKAGES                                     1456
0~6     011452!                CO E70 I=IS,!T                                                        1457    583
e:67    011 t.oH               CC, E70 J=JS,JT                                                       1458    534
1:68    011432!                DO E70 K=KS,KT                                                        1459    58 5
669     J1149AI                  ~NA:=A':(!,J,~)+AW(!,J,K)+ANCI,J,K)+AS(I,J,K)+AT(I,J,K)+AB(!,J,K)   1460    586
670     J11534I                APCI,J,Kl=AN~o                                                        1461    587
e 71    011530!                :F(~C(!,J,Kl .LT. 2) GC TO 870                                        1462    588
c72     0115E6I                A?(I,J,n=1.0                                                          1463    590
673     011612!                AE ( I,J,K) =0.0                                                      1464    591
1:74    01163EI                AwCI,J,K)=C.O                                                         1465    592
675     01166.H                ANCI,J,0=0.0                                                          1466    593
676     011696!                AS(I,J,Kl=C.O                                                         1467    594
677     0116C2I                AT(!,J,K)=O.J                                                         1468    595
678     0116=:I                AaCI,J,Kl=C.O                                                         1469    5 96
679     0117UI                 SU(I,J,K)=0.0                                                         1470    597
680     011746!          E70 CO"lTINUE                                                               14 71   598
¢81                     C-----LI"lEAR EQUATIONS SCLVEq                                               1472
t82     01178EI                CALL LIN5RXC2,!S,JS,KS,IT,JT,KT,F)                                    1473    599
633     0117CCI                CO ~50 !=1,!SoiF                                                      1474    600
684     0117"0!          850 CALL L!NERXC1,IS,JS,KS,IT,JT,KT,F)                                      1475    601
085              C-----PRESSURE ANO VELOCITIES CORRECTIONS                                      14 76
686   011854!           PPREF=F(2,2,2)                                                          1477     eoz
687   011864!           DO eeo I=IS,!T                                                          14?8     603
688   01187CI           oc sao J=JS,JT                                                          1479     604
689   011894!           DC 880 K=KS,KT                                                          1480     605
690   0113ACI           IF(~CCI,J,K) .GE. 2) GC TO 380                                          1481     606
691   J11dE2I           P1:F(I,J,Kl-PPQEF                                                       1482     608
e92   01191AI           P(I,J,K):D(I,J,K)+~LD•P1                                                1483     609
693   011972!           ER•F=AMAX1(EQQF,ABSC?1ll                                                141!4    610
694   0119AEI     aeo CONTINL:E                                                                 1485     611
695   0119F6I           DO tOO !=2,LT                                                           1486     612
6?6   011A0AI           00 eOO J=2,MT                                                           1487     61 3
097   011A1EI           DO tJC K=2,NT                                                           1488     614
c98   J11A32I           !FC~CCI,J,K) .GE. 1l ~C TD 600                                          1489     615
6?9   011468!           II=I+1                                                                  1490     617
?OJ   011A76I           JJ=J+1                                                                  1491     618
701   011A34I           KK=K+1                                                                  1492     619
702   J11A92I           ?E=(F(II,J,Kl+F(II,JJ,K)+FCII,J,KK)+F(!I,JJ,KK))•0.25                   1493     620
703   011:14:I          ?~=CFC!,J,K)+F(I,JJ,K)+F(I,J,KK)+F(I,JJ,KK))•0.25                       1494     621
704   011COAI           ?~:(F(I,JJ,K)+F(II,JJ,K)+F(I,JJ,KK)+F(II,JJ,KK))•0.25                   1495     622
705   011CC6I           PS=CFCI,J,K)+F(II,J,~l•FCI,J,KK)+FCII,J;KKll•0.25                       1496     e23
706   011oa2r           PT=CF(I,J,KK)+F(!!,J,K~l•F(I,JJ,KK)+F(II,JJ,KK)l•0.25                   1497     624
707   011 :3EI          P5=(F(I,J,K)+F(II,J,~)+F(I,JJ,K)+F(II,JJ,Kl)•0.25                       1493     6 25
708   011EFAI           PCXI=PE-P:,i                                                            1499     626
709   011FOCI           PEJA=P~-PS                                                              1500     627
710   011F1EI           PSCI=PT-PB                                                              1501     628
711   011F30I           cx~=CXCI,J,K)                                                           1502     629
712   011F5CI           i:X:;=EX C!,J,K)                                                        1503     630
713   011Fd8I           sx:;=SX(I,J,K)                                                          1504     ¢31
714   011F94I           cr:;=CYCI,J,K)                                                          1505     632
715   011FEOI           EY-:=EY(I,J,K)                                                          1506     033
716   01200CI           sr.::=SYCI,J,K)                                                         1507     634
717   012038I           CZ.l=CZ.CI,J,Kl                                                         1508     635
718   012064I           EZC=EZCI,J,Kl                                                           1509     636
719   012090!           SZQ=SZCI,J,0                                                            1510     637
720   0120BCI           PXX=PCX!•CXQ+PECA•EX;+PSCI•SXQ                                          1 511    638
721   0120EAI           PYY=PCXI•CYC+PECA•EYQ+PSCI•SYQ                                          1512     639
722   012118!           PZZ=PCXI•CZC+PECA•EZ~+PSCI•SZQ                                          1513     640
723   012146I           UCI,J,K)=UCI,J,Kl-CuCI,J,Kl•PXX                                         1514     ¢41
724   0121COI           V(I,J,K)=VCI,J,K)-DUCI,J,~l•PYY                                         1515     642
725   01223AI           W(I,J,K)=-(I,J,Kl-CU(!,J,K)•PZZ                                         1516     643
726   0122B4!     600   CCNTINUE                                                                1517'"   644
727   0122FCI           qi:TLRN                                                                 1518     645
728   012304!           :NG                                                                     1519     646

NO ERQORS:F70 ROS-01.0C SUBROUTINE SOLVEC        02/21/86 09:58:31      TABLE SPACE:   11! KB
STATEMENT auFFER:   20 LINES/1321 BYTES    STACK SPACE: 203 •OROS
SINGLE PRECISION FLOATING PT SUPPORT RECUiqEC FOR EXECUTION
        1   oooooor             suaROUTINE LINERX(ISOL,IS,JS,KS,LT,MT,NT,F)                   1520
        2   000004!             DIMcNSICN A(20),8(20l,C(20),0(2Cl,F(21,18,10),!3S(21,18,10)   15 21
        3   000004I             COM"ON                                                        1522
        4                     1/COEF/ AP(21,18,10),SU(21,18,10),SP(21,18,10l,SUK(21,18,10),   1523
        5                     2     SPK(21,18,10l,AE(21,18,10),AW(21,18,10),AN(21,18,10),     15 24
        6                     3     AS(21,13,10),AT(21,18,10),AB(21,18,10),AP0(21,18,10)      1525
        7              c-----LINcAR EQUATIONS SOLV::RS                                        1526
        8   000004I             GO TO (1,2>,ISOL                                              1527
        9              C-----LINE-~ELAXAT!ON USING TOMA                                       15 28
       10   O·J3C86I      1     CONTINUE                                                      1529     2
       11   003C86I             i:0 1 Q !=IS,LT                                               1530     3
       12   003C9':I            00 10 J=JS,"T                                                 1531     4
       13   003C86I             DO 1 0 K=KS,NT                                                1532     5
       14   OJ3CCEI             S5(!,J,K)=AE(I,J,Kl•~(!+1,J,K)+AN(I,J,K)•F(I,J+1,K)+          1533     6
       15                     1             sucr,J,K>                                         1534
       16   0030C8I       10 CONTir>;UE                                                       1535     7
       17   003E10I             A(KS-1>=0.C                                                   1536     8
       18   003E24I             00 100 I=IS,LT                                                1537     9
       19   003E3CI             00 100 J=JS,MT                                                1538    10
       20   003E54I             C(KS-1l=F(I,J,KS-1l                                           1539    11
       21   003E90I             00 101 K=KS,NT                                                1540    12
       22   003EA8I             A(Kl=AT(I,J,I()                                               1541    13
       23   003EDAI             S(K)=ASCI,J,Kl                                                1542    14
       24   003FOCI             C(K)=BE(I,J,K)+AW(I,J,Kl•FCI-1,J,K)+                          1543    15
       25                     1        ASCI,J,K)•~(I,J-1,K)                                   1544
       26   003FECI             D(K) =AP CI,J,Kl                                              1545    16
       27   00401E!             TER~1=C(K)-o(Kl•A(K-1)+1.E-30                                 1546    17
       28   004054I             Tc;RM=1.C/TERM1                                               1547    18
       29   004066I             A(K)=A(O•T:RM                                                 1548    19
       30   00408!3!    1 01 C(K)=(C(K)+S(K)•C(K-1)l•T':RM                                    1549    20
       31   0040::0I            00 102 K'<.=KS,NT                                             1550    21
       32   0040F8I             K=KS+NT-KK                                                    1551    22
       33   004110!     102 FCI,J,K)=A(KJ•c(I,J,K+1)+C(K)                                     1552    23
       34   00419EI     100 CONTINl:E                                                         155 3   24
       35   0041CEI             RETl:RN                                                       1554    25
       36              C-----BLOCK CORRECTION FOR PRESSURE FIELD                              1555
       37   004106!       2     CONTINUE                                                      1556    26
       38   004106!             oo 201 I=IS,LT                                                1557    27
       39   0041EEI             A(Il=O.C                                                      1558    28
       40   004202!             6(Il=O.C                                                      1559    29
       41   004216!             CCil=O.C                                                      15 60   30
       42   00422AI             D(Il=O.O                                                      1561    31
       43   00423EI             DO 201 J=JS,MT                                                1562    32
       44   004256!             00 201 K=KS,t-.lT                                             1563    33
       45   00426EI             A(I)=A(I)-AE(I,J,K)                                           1564    34
       46   004260!             S(Il=SCil-A~CI,J,Kl                                           1565    35
       47   0042F:!I            C(Il=C(Il+SU(I,J,Kl                                           1566    36
       48   004334!     201 CONTINUE                                                          1567    37
       49   00437CI             00 202 I=IS,LT                                                1568    38
       so   004394!             ANA6=-A(I)-8(Il                                               1569    39
       51   00433CI     202 O(!>=Ar,.A6•1 .5                                                  1570    40
       52   0043EEI             00 203 I=IS+1,LT                                              1571    41
       53   00440AI             TER~=B(I)/D(I-1)                                              1572    42
       54   00442EI             O(I)=O(I)-TERM•A(I-1)                                         1573    43
       55   004462!     203 C(I)=C(Il-TERM•C<I-1)                                             1574    44
       56   0044AEI             F(LT,JS,KS)=C(LT)/D(LT)                                       1575    45
       57   0044F6I             00 204 I!=IS+1,LT                                             1576    46
....
-:i
-:J
N)
      58    OQ4512I          I=IS•LT-II                                                          1577   47
      59    00452AI    204   "(I,JS,(SJ=(C(!)-A(!l•FC:+1,JS,KSJ)/O(Il                            1578   48
      60    0045CA I         DO ,05 I=IS,LT                                                      1579   49
      61    0045E2I          ?P~L~=FCI,JS,K5)                                                    1560   50
      62    004614!          :JO ,05 J=JS+1,MT                                                   1581   51
       o3   O:J4o30I         00 ,GS ~=(5~1,NT                                                    1582   52
      64    004o4CI          F(I,J,Kl=PPSLK                                                      1583   53
      OS    OJ467:I    205   CONTI\L.E                                                           1584   54
      66    0046C6I          , :: TL< N                                                          1585   55
      67    004oCEI          =~:                                                                 1586   56
      NO    RORS:F7J ~OS-01 .oc sus;cuTIN': LIN': x
            0                                          02/21/86 Q9:59:43   TA8LE SPACE:   3 K6
      STAT ~!~T BUFFER:   20 LI~ES/1321 SYTES     TAC~ SPACE: 199 ~OROS
      SING : P;ECISIC~ FLClTI~G PT S~PP~RT Q::u:, J FC~ ':XECuT!ON
 1   OOOOOOI             Su3ROUTINE SOUNCCIE,=)                                                                              1587
 2   000004!             OIMENS:CN FC21,18,10l                                                                               1588
 3   000004!             COMMON                                                                                              15 89
 4                     1/VAR/UC21,18,10l,VC21,18,10l,PC21,18,1Cl,OKC21,18,1Cl,                                               1590
 5                     2 OE(Z1,18,1Cl,:•QU,E~KV,ER•M,E•QK,cRRE,ERRW,                                                         1591
 6                     3 ?FC21,18,1Cl,W(21,18,10),TMC21,1S,10l                                                               1 592
 7                     1/Pqcp/ VISE(21,1e,1ol,CEN(21,1S,10l,VISC,DENIN,~LOWIN                                                1593
 8                     1/PCC•/ CU(21,18,10l,JVC21,13,10l,OW(21,18,10)                                                        1594
 9                     1/TUR/ SIGK,SIGE,CMU,C1,C2,C~U1,CMU2,E,CK,HINUM,SMN~M,ANV1(800),                                      1595
10                     2 YNCS0Cl,YN1(80Cl,S!NX(o00),S!NY(800l,SINZC800l,ANW1(800l,                                           1 596
11                     3 YPLN(ECOJ,TA~N(300J,I!C(800l,J8C(S00),~SC(800>,IITY(800l,                                           1597
12                     4 TALwC8COl,GENC21,13,1Cl,MCC21,18,1Cl,IJLOC21,1o,1Cl,IITO                                            1598
13                     1/CCEF/ APC21,18,10l,SUC21,13,10),SP(21,18,10),SUK(21,18,10),                                         1599
14                     2     SOK(21,18,10),A~(21,1!,10),A~(21,18,10),lN(21,18,10l,                                           1600
15                     3     AS(21,18,10l,~T(21,13,10),A8(21,18,1Cl,~P0(21,18,10)                                            1601
16   OO•JOJ4I            COM~CN                                                                                              1602
17                     1/T~~N/ X(21,18,10),Y(21,16,1Cl,LC21,18,1Cl,TJ0(21,1E,10),                                            1603
1S                     2     CXC21,13,10l,CYC21,13,1Cl,CZC21,18,1Cl,                                                         1604
19                     3     EX(21,13,10l,:Y(21,18,1Cl,:ZC21,18,1Cl,                                                         1605
20                     3     SX(21,18,10),SYC21,1~,10),SZ(21,13,10)                                                          1606
21                     1 /LI I' T/ L, ,'I, LT, MT , L1 , L2, M1 , "! 2 , LO, MO, I Si. U ,-! SW V, I SW P , I SW K, IS WE,   1607
22                     2     ALU,ALV,ALP,,LK,AL:,ALVIS,ALW,N,N1,N2,~0,ISWw,IG,NT,ALC,OTT                                     1608
23              C-----:VALUATE IIALL SCU~CA~Y CO~OITICNS USING WALL FUNCTIONS                                                1609
24   000004!             JO 150 I:I=1,!!TO                                                                                   1610     1
25   000024!             !=I2CCIII>                                                                                          1611     2
26   0000381             J=J2CCIII>                                                                                          1612     3
27   00004CI             K=l(8((II:l                                                                                         1613     4
28   OC0060I             GO TO (1,2,3,4,5,6), I!TY(III)                                                                      1614     5
29   OJ009~I             CONTINU:                                                                                            1615     6
30              C-----•IQRTr!                                                                                                1616
31   00009EI             YP=YN(II!)                                                                                          1617     7
32   000032!             YP1 =YN1 (III)                                                                                      1618     8
33   OJOOC6I             COl(=DK(I,J,Kl                                                                                      1619     9
34   OOOOF2I             CO:=OECI,J,K)                                                                                       1620    10
35   00011EI             CD:11.=0ENCI,J,0                                                                                    16 21   11
36   00014AI             C~LL WALLFN(!E,YP,YP1,COK,CaE,CD:N,SINXCIII),S!NYCIII),                                             1c 22   12
37                     1         SINZ(II:),F(I,J+1,K),ANCI,J,l(),SUCI,J,K),SP(I,J,K),                                        1623
38                     2         TALN(III),YPLNC!Ill,GENCI,J,Kl,VISECI,J,Kl,                                                 1624
39                     3         U(!,J+1,K),VC!,J+1,l(),~(I,J+1,K),UCI,J,K),VCI,J,K),                                        1625
40                     4         wCI,J,K),U(I,J-1,Kl,~CI,J-1,K),~CI,J-1,K),                                                  1626
41                     5        -SPKCI,J,K),SPKCI,J,K),AN~1CIIIl,ANw1(III),TJO(I,J,K))                                       1c27
42   OOCB4I          -. GO TO 150                                                                                            1628    13
43   OOOSSAI      2      CONTINUE                                                                                            16 29   14
44              C-----SOUTH                                                                                                  1630
45   OOOSSAI             Y? =Y'i ( I I I>                                                                                    1631    15
46   0005CEI             Y:>1=YN1CIII>                                                                                       1632    16
47   0005E2I             CDK=DKCI,J,Kl                                                                                       1633    17
48   OOC60EI             COE=DE(I,J,K)                                                                                       1634    18
49   00063AI             COci',=C:N CI, J,K l                                                                                1635    19
50   0006661             CALL wALLFN(I:,Y?,YP1,CCl(,C~E,COEN,SINXCIIIl,SINY(III),                                            1636    20
51                     1         S!II.Z(III),FCI,J-1,Kl,AN(I,J,Kl,SU(I,J,Kl,SPCI,J,Kl,                                       1637
52                     2         TALNCIII),YPLNCIIIl,GEN(I,J,K),VISE(I,J,K),                                                 1638
53                     3         U(I,J-1,K),V(I,J-1,K),WCI,J-1,K),U(I,J,Kl,VCI,J,K),                                         1639
54                     4         i.CI,J,K),U(I,J+1,l(),V(I,J+1,K),W(I,J+1,K),                                                1640
55                     5        -SPK(I,J,K),SPK(I,J,Kl,ANV1CIII),A~w1CIIIl,TJOCI,J,K))                                       1641
56   OOOAOOI             GO TC 150                                                                                           1642    21
57   000A06I      3      CONTINUE                                                                                            1643    22
~
        58                     C-----:lST                                                               1641.
"'"     59        OCOl 6I               Y"=Y'i(II!l                                                     1645       23
        60        GGCl lI               yo1=Y,_1 (!I:l                                                  H4o        24
        61        ,JQ;JA i:I            CLK='.;~(I,J,U                                                  16 4 7     25
        62        JJG32.l I             (:;:=Ci: C!,J,C l                                               1643       20
        ~3        0:0356:               CO::l\=Jcl\(:,J,Kl                                              1e 49      27
        c4        Q,j1J3d2:             CHL ~J~LF~C!~,Y 0 ,YP1,CC~,CJ~,C:~~,S!NX(:!!),SI~Y(III>,        1650       2:)
        65                           1          S:I\Z(II:J,c(I•1,J,K),J\(I,J,Kl,5UCI,J,K),SO(I,J,Kl,    1c 51
        to                           ,          TaL\(:!:l,Y?L\(:rrl,~:'i(I,J,K),V!SE(:,J,~),
                                    ~                                                                   1652
        c7                           3          ucr•1,J,~),V(:+1,J,K),~<:•1,J,Kl,U(I,J,K),V(I,J,Kl,     1653
        c5                           4          ~c:,J,~),U(I-1,J,<J,v(I-1,J,K),~(I-1,J,KJ,              1e 54
        :,9                                    -S~K(I,J,K),SD~(I,J,C),~NV1(I!:),JN~1(:!Il,TJC(I,J,K))   1655
        ?C        OGO":CI               ;c T::; 15C                                                     1 o 5 !>   ?~
        71        0.JJFF2I       I.     CJ'-.TI'iL::                                                    1657       3 ,)
        72                     C-----A~ST                                                               1053
        73        occ;:::2r             Y~=P.;(:::J                                                     16 5;      31
        74        Jj1S J~I
                        1
                                        yo1=n,1C!II>                                                    1eeG       32
        7,        •J:1CHI               C~<=C:K(I,J,0                                                   16t1       33
        76        O•J1046!              cc~='.JECI,J,o                                                  1c62       3.:.
        77        OG1-J72I              CJi:r.=J:NC:,J,0                                                166 3      35
        78        ·J010?::r             CJLL ~ALL~~,r~,YP,Y~1,CC(,CJE,CC~N,5!~x,:r:>,SI~Y(I!!),         1t t4      fo
        79                           1          SINZCIIIl,"(:-1,J,ll,A~(!,J,K),SUCI,J,Kl,SPCI,J,K),     1665
        ~,
        30                           2
                                     3
                                                T,LN(I::J,y 0 LNCI:IJ,SE~CI,J,Kl,VISE(I,J,K),
                                                ~CI-1,J,K),V(I-1,J,1),~(!-1,J,K),~(I,J,K),V(I,J,1),
                                                                                                        1tt~
                                                                                                        1t 67
        32                           I.         ~(I,J,Kl,U(I+1,J,KJ,v([+1,J,K),~(I+1,J,KJ,              1t63
        e3                           5         -s=1cr,J,~),S~~,r,J,~),~NV1(III),AN~1(II:),TJC(I,J,K))   1669
        g.,       OJ15G8I               GC TO 1 5 ,J                                                    1670       37
        dS        J~1SC::        5      CONT!NL~                                                        1671       B
        56                     C-----TQP                                                                1t72
        87        001 SC:I              YP=Y',(!I:)                                                     1673       39
        3e        ::),J1522:            Y.~1=Y'i1CII!l                                                  16 7 l.    40
        3;i       JG1536I               COK=CK(I,J,I()                                                  1e75       :.1
        ;c        001562!               COE=SEC:,J,Kl                                                   1e7c       42
        91        001 Sa EI             CC:l\=C•:l's(I,J,K)                                             1677       43
        92        00153 .. :            CALL ~ALLFN(!:',Y?,YP1,CCK,COE,CCEN,SINXC:IIJ,S:NY(!!IJ,        1o78       44
        93                           1          SI~ZCI:IJ,c(I,J,K+1),lN(I,J,~l,SUCI,J,K),SD(I,J,K),     1 e 79
        94                           2          TALN(II!),YPLN(!!I),G~NCI,J,K),VISE(I,J,K),             1eeJ
        95                           3          ucr,~-~•1),V(!,J,~+1),~(I,J,K+1),U(I,J,K),V(I,J,K),     16 81
        :;i   c                      '-         ~c:,J,~),U(I,J,K-1),vC:,J,~-,,,~c!,J,K-1),              16b2
        97                           5         -S~~CI,J,K),SP~(I,J,~l,lNV1(II:l,iN~1C!IIJ,TJOCI,J,K))   1o83
        ,a        0J1   ~nr             ~c TC 1 5 ,J                                                    1H4        45
        09        0:,1~1:r       6      ccr-..T!NL:'                                                    1o25       46
      100                      C-----50,TOM                                                             16~6
      101         O·J1A1EI              YP=YN(I!:)                                                      1687       47
      1 02        %1 l 32!              YP1=YN1 ( I ! I )                                               1653       4.:l
      1 03        ,J'.J1 He!            C::C~=D~CI,J,I()                                                1659       49
      104         OJ1A72I               C~E=JE:CI,J,,c.)                                                1690       50
      105         JJHC:I                CD::r-=c~r,, <:,J,I()                                           1691       51
      1 06
      107
                  001ACAI
                                    ,   c,LL ~ILLF~(IE,YD,YP1,CD~,CJE,CD!~,5!NX(III>,SINYCIII),
                                                SI~Z(III),~C!,J,K-1),iNCI,J,K),SU(I,J,Kl,SPCI,J,K),
                                                                                                        1c 92
                                                                                                        1eQ3
                                                                                                                   52
      108                            2          TALN(I!!J,YPL~(!IIl,~E'i(l,J,K),VISECI,J,Kl,            1e94
      1 C: 9                         3          ~(I,J,K-1),VCI,J,K-1),~CI,J,K-1),U(I,J,~),V(I,J,K),     1e'i5
      110                            4          ~CI,J,~J,UC!,J,K•1),VCI,J,K+1),~CI,J,K+1),              16 96
      111                            5         -SPK(I,J,K),SPK(I,J,K),~~V1(!I!),ANW1CII!),TJC(I,J,K))   1¢97
      11 2        '.JJ1 F23I    150 COf\eT!~◄ l..E                                                      16 9ii     53
      113         OG1F<.)I              ;icTL~'s                                                        1691'.;    5.:.
      114         DO 1 "'-o:            ~~c                                                             17GD       55
NC   ~RJRS:F7D ROS-G1,JC SU3,C~T N:     3CUN      02/21/36 1C:OC:46    TAcL: SPACE:   7 ~s
STAT ~E~T 3UF=ER:   20 LINES/1321  YT~S      TACK s 0 ACE: 13~ ~o~:s
SING C PR:CIS!CN CLCAT"NG ?T SUP?O T ~::ur~ D FOR EX=CUTICN
  1     OOOOJO!                 susaouTINE ~ALLFN(I:,YP,YP1,CK1,0:1,D:N1,S!NX1,SINY1,          1701
   2                        1         SI~l1,F1,A~1,SU1,SP1,                                    1702
   3                        2         Bl.N1 ,Y 0 L~1,G:N1 ,VISE1,                              1703
  .                         3         ~,,v1,w1,uc,vo,                                          1704
  s                         ~             ~c,u2,v2,w2,                                         1705
  C                         5      SuK1,S~K1,ANV2,A~~2,TJ01)                                   1706
  7     '.)00004 I           CO~l'ON                                                           1707
  a                         1/?,CO/ ~IS:(21,1S,1Cl,c:N(21,12,10l,VISC,OEN!N,FLOWIN             1708
  9                         1/TL,/ S!SK,S:~:,CMU,C1,C2,CMu1,CMu2,:,C~,HINUM,SMNU~,ANV1(B00),   1709
10                          2 YN(30Cl,Y~1C3CCl,SI~X(5JJl,SI~YC~CCl,S!NZ(!COl,AN~1(S00l,        1710
11                          J Y~c~CECCl,TIUN(SCCl,!!CC800l,J3C(!00l,l(SCC800l,IITY(30Cl,       1 711
12                          4 T~L.C!COl,G:N(21,1!,1:l,MC(21,18,1:1,!JL0(21,18,1Jl,IITO         1712
13                   ~-----~ALL           FL~C7!CNS LS!\~   LCGA~ITHM!C   ~lLL L~W             1713
1t.     ')OQOJ4I                Ge TC (1,2,3,4,5,o,7), I:                                      1714    1
1S      ClOC03!:I               CJ~T!:-.L;:                                                    1715     2
16                   c-----u                                                                   1716
17      00·]03:I                s~:n~=s:,nc::;1(1J                                             1717     3
1B      ]·JOOS~:                YPL~1=C:N1•SJ~T~-c~~,-,Ptvrsc                                  1718     4
19      OJ'.)07:::              :c(yPLN1 .L:. 11.63) GC TO 111                                 1719     5
2-'.)   G000~6!                 TMULT=~:N1•C~u1•s:;TK•C~/ALOG(:•YPLN1)                         1720     7
21      oo:•J:or                GO   TC    11 2                                                1721     a
22      %:JC:6!       111       TMULT=V!SC/YP                                                  1722     9
23      oooc=sr       112       T~L:~1=-T~ULT                                                  1723    10
24      0001 c~r                PTi•TJC1•5!NX1•TMULT/YP1                                       1724    11
25      0001231                 5?1=5?1-?r.l                                                   1725    12
2e      OC013AI                 SU1 =Su1 +PTA•F1                                               1726    13
27      000152!                 P1=SJqT(1.-S::\x1••2l                                          1727    14
28      OG016AI                 ANV2=~~1•S~~T(1.-S!~Y1••2)                                     1728    15
29      0001CBI                 AN~2=A~1•S~QT(1.-SINZ1••2)                                     1729    16
30      000203I                 .:.:-..1 =P1 •AN1                                              1730    17
31      JJ021AI                 <ETL~N                                                         1731    1B
32      0002201        2        CONTINLE                                                       1732    19
33                   c-----v                                                                   1733
34      00022')!                TMUL T=-T AL:\ 1                                               1734    20
35      OOG232I                 ?TA=TJC1•S:NY1•T~ULT/YP1                                       1735    21
3e      J002 SOI                SP1=SP1-PT,:                                                   1736    22
37      ·J00262I                SL:1=SU1+PTA ■ =1                                              1737    23
33      00027A I                l~1=HiV2                                                       1738    24
39      O:J0286!                                                                               1739    25
40      OOC28CI        3        CCNT!NL::                                                      1740    26
.. 1                 c-----w                                                                   1741
42      00023CI                 TMUL T=-T~i..:~1                                               1742    27
43      00,]29:!                PTA=TJC1•S!~Z1 ■ TMULT/Y?1                                     1743    28
44      00023CI                 SF1=SP1-?TA                                                    1744    29
.,5     0002CEI                 Su1=Su1+?TA•F1                                                 1745    30
46      OJ02E6I                 AN1 =4Nw2                                                      1746    31
47      0002F2!                 RETLQN                                                         1747    32
46      0002F3!         4   CONT!Nl.E                                                          1748    33
,.9                  :-----TM                                                                  1749
50      OOC2FdI             R:Tl.RN                                                            1750    34
51      0002FEI         5   CONTINU:                                                           17 51   35
52                   c-----1<                                                                  1752
53      0002FEI                 SQ,H=SCH (!JI( 1 l                                             1753    36
54      00031AI                 IF(YPLN1 .LE. 11.63) GC TO 511                                 1754    37
55      000332!                 DIT~=DEN1•CMU2•SCRTl(•ALOG(E•YPLN1)/(CK•YP)                    1755    39
56      OG'.:332!               G: iC 512                                                      1756    40
;?      OOC3Bar       511       0IT~=SE~1•CMU2•S~RTK•YPLN1/YP                                  1757    41
 58   0003ACl      512   CONT!NUE                                                             1758    42
 59   0003AC:            oou=uC-u1                                                            1759    43
 60   0003aE!            ocv=vo-v1                                                            1760    44
 61   0003001            OOW=wO-i.1                                                           1761    45
 62   OOC3E2I            ?1=COU••2+CCV••2•DCW••2                                              1762    46
 63   00042Al            QOu=u2-u1                                                            1763    47
 64   00043CI            '.l0V=V2-V1                                                          1764    48
 65   00044:I            :iow=w2-i.1                                                          1765    49
 66   0004601            cz=COU••2+CCV••2+CCW••2                                              1766    so
 67   0004A8I            YP2=2•Y;:1-YP                                                        1767    51
 68   0004COI            ~:N•=~EN1-VlSE1•P2/Y 0 2/YP2                                         1768    52
 69   0004E~I            IF(GENR .L:. C.C) G:NR=0.0                                           1769    53
 70   JJ05J4I            SU1=TJC1•CSU~1•CK1+(P1•TAUN1••2/VIS:1+GENR))                         1770    55
 71   00053:l            SF1=TJC1•CS?K1-SITM)                                                 1771    56
 72   000556~            AN1=C.C                                                              1772    57
 73   0005621            ~:TLRN                                                               1773    So
 74   0Ci•J568I     6    CONT!NU:                                                             1774    5g
 75               c-----1:                                                                    1775
 76   ')00568!           T:R~=CM~2/(C(•YP)                                                    1776    60
 77   000582I            SU1=H!t\LM•T:RM•CK1••1.5                                             1777    61
 78   000532!            SP1=-Hit\JM                                                          1778    62
 79   0005C4I            RETLi<N                                                              1779    63
 80   0005CA!       7    CONTI NU:                                                            17 80   64
 81               C-----?F                                                                    1781
 32   0005CAI            R:TL.RN                                                              1782    65
 33   000500!                                                                                 1783    C6

NO   qRQRS:F7C ROS-01.0C Su~RCUTlNE WALLFN      02/21/86 10:01:12       TABLE SPACE:   5 KB
STAT MENT :UFFE~:  20 L!NES/1321 SYTES    STACK SPACE: 122 ~OROS
SING~ pq:CISION FLCATING PT SU?PCRT qE~U!REO FO~ EXECUTION
 1       000000!             Su3ROUTINE SY~OUTC:C,IE,IS,IT,JS,JT,KS,KT)                          1784
 2       0000·)4 I           COMl'ON                                                             17 85
 3                         1/V~~/~CZ1,18,10l,VC21,18,10l,PC21,18,10l,OKC21,18,1Cl,               1786
 4                         2 0:(21,18,10),E~RU,E,RV,E"RM,ER~K,ERRE,~RRW,                         1787
 5                         3 PP(21,18,10),~(21,1d,10),TM(21,18,10)                               17!!8
 6                         1/P~CP/ VISE(21,13,10l,CENC21,1d,1Ql,VISC,OE~IN,FLOWIN                1789
 7                         1/PCCR/ DU(21,18,10),0V(21,18,10l,Ow(21,18,10)                        1790
 8                         1/CCEF/ APC21,1S,10),SUC21,18,10l,S?(21,1~,1Cl,SUKC21,18,10l,         1791
 9                         2       SPKC21,18,1Cl,A:C21,1S,10l,l~(21,13,10l,ANC21,18,1Cl,         1792
10                         3       ASC21,18,1Ql,ATC21,18,10),ABC21,18,10l,AP0(21,18,10l          1793
11       OOG004I             C0 .•11'0N                                                          1794
12                         1/TqAN/ X(21,13,10),Y(21,15,10l,Z(21,~8,10),TJ0(21,18,10),            1795
13                         2      CX(21,1S,10l,CYC21,18,10),CZC21,18,10l,                        1796
14                         3       EX(21,13,10l,EYC21,18,1Cl,EZ(21,18,1Cl,                       1797
15                         3       SX(21,16,1Gl,SYC21,1S,10l,SZC21,18,1Cl                        1798
16                         1/UNSTOY/UOC21,18,1Cl,VCC21,18,10l,wCC21,18,10l,CKOC21,18,1Cl,        1799
17                         2       ~EOC21,18,1Cl,OENOC21,1S,10l,TM0(21,18,10)                    1800
18                         1/LI~T/ L,M,LT,~T,L1,L2,M1,M2,L0,MO,IS~U,ISWV,ISwP,ISWK,!SW:,         1 ac1
19                         2       ALU,ALV,ALP,ALK,ALE,ALVIS,ALW,N,N1,N2,NO,ISWW,IG,NT,ALC,CTT   1802
20                   C-----SY~l'2TRIC, CYCLIC ANO EX!T CCNOITICNS ANO LINK MOCI~ICATIONS         1e03
21       0000041             GO TO C1,2,3l, IC                                                   1804       1
22       00002EI       1     CONTI NL=                                                           1805       2
23                   c-----aono~                                                                 18C6
24   1   00002El            K=1                                                                  1807       3
25       000036!            CO 10 I=1,L                                                          1808       4
26       000044!            CO 1C J=2,MT                                                         1809       5
27       00005El            UCI,J,Kl=UC!,J,K+1)                                                  1810       6
28       OOOOAC!            VCI,J,K)=V(I,J,~+1)                                                  1811       7
29       0000"AI            WCI,J,Kl=Q.Q                                                         1812       3
30       0001201            TM(I,J,K)=TM(I,J,K+1)                                                1813       9
31       0001741            OK(I,J,Kl=OKCI,J,K+1)                                                1814      10
32       0001C2I            C:C:,J,Kl=D:CI,J,K+1)                                                1815      11
33       0002101       10 CONTINUE                                                               1816      12
34                   c-----=~ST O~T (9ASE: ON IN=Lcw MASS ~LOW ,lTE)                             1817
35       000240!            I=IT                                                                 1818      13
36       0 □ 024CI          FLOw=O.C                                                             1819      14
37       OOC258I            ARil EN=C. 0                                                         1820      1S
38       000264!            00 50 J=2,JT                                                         1 !! 21   16
39       0002781            DO 50 K=2,KT                                                         1 a 22    17
40       00028CI            uC=(V(I,J,K)+VCI,J-1,K)+V(I,J,K-1)+V(I,J-1,K-1ll•0.25                1 !! 23   18
41       00033CI            C:NC=CCENCI,J,K)•~2NCI,J-f,Kl+CENCI,J,K-1)+0!NC!,J-1,K-1ll•0.25      1824      19
42       0003:Cl            P1=CXCI,J,K)+X(I,J,K-1)-XCI,J-1,K)-XCI,J-1,K-1ll•0.5                 1.225     20
43       □ 0049Cl           P2=CYC!,J,K)+YCI,J,K-1)-Y(I,J-1,K)-Y(I,J-1,K-1)l•0.5                 18 26     21
44       00054CI            P3=CZCI,J,K)+ZCI,J,K-1J-!(I,J-1,K)-Z(I,J-1,K-1ll•C.5                 1!!27     22
45       □ 005FCI           Q1=(X(I,J,K)+x(I,J-1,K)-X(I,J,~-1)-X(I,J-1,K-1)l•0.5                 1528      23
46       0006AC1            Q2={YCI,J,K)+Y(I,J-1,K)-Y(I,J,K-1)-Y{I,J-1,K-1ll•0.5                 1829      24
47       00075CI            :3=CZCI,J,~J+ZCI,J-1,Kl-ZC1,J,K-1)-ZCI,J-1,K-1ll•0,5                 1830      25
48       oooaoc1            AREA=SCRT(?1•P1+?2•?2+P3•F3)•SCRT(Q1•~1+Q2•Q2+Q3•Q3)                 18 31     26
49       0008A8I            FLOw=FLCW+CENC•AREA•UC                                               1832      27
50       0008C6I            ARCEN=ARDEN~OENC•AREA                                                18 33     2d
51       0008CE1       50 CONTINLIE                                                              1834      29
52       0009:JEI           UINC=(FLOW-FLOWINl/A~CEN                                             1835      30
53       0009261            DO cO J:2,JT                                                         1836      31
54       00093Al            CO eO K=2,KT                                                         1837      32
55       00094EI            uc:+1,J,Kl=u(I,J,K)                                                  1 a 38    33
56       00099EI            V(I+1,J,K)=V(!,J,K)-U!NC                                             1839      34
57       C009F41           w(!+1,J,K)=W{I,J,K)                                                   1840      35
 58   OOOA44I             CK(I+1,J,K)=JKCI,J,K)                                                18 41    36
 59   OOOA94I             DE(I+1,J,~l=D:CI,J,Kl                                                1342     37
 60   IJOOAE4I       60 CCi',TINUE                                                             1843     33
 61   JOOB14I             RETL:RN                                                              1844     39
 62                C-----LINK CC:FF. ~OCIFICAT!CNS                                             1845
 63   000B1AI         2   CONTINU:                                                             1846     40
 64                c-----e.iST OUT                                                             1847
 65   00031AI             !=IT                                                                 18 48    41
 66   000826!             CO 20G J=2,JT                                                        1e49     42
 67   OOOB3A!             JO 200 K=2,KT                                                        1850     43
 68   00064EI             A:CI,J,Kl=C.O                                                        13 s 1   44
 69   00067AI       200 CONTINUE                                                               18S2     45
 70   OOOSAAI             Rc:TL:RN                                                             18S3     46
 71                c-----uPC~TE LNST:ACY Co:i=~.                                               18S4
 72   oooasor         3   CONTINUE                                                             1855     47
 73    OOOBO!             IFCCTT .N:. O.Ol GC TO 301                                           18S6     48
 74    OOOBC8I            DO 300 I=IS,IT                                                       18S7     so
 75    0008EOI            00 300 ~=JS,JT                                                       1858     S1
 76    0006F8!            DO 300 K=KS,KT                                                       18S9     S2
 77    OOOC10I      300 ~?0(!,J,K)=0.0                                                         1860     S3
 78    IJOOC84I           'l:TLRN                                                              1€61     S4
 79    ooocs.u      301 CONTINL::                                                              1862     55
 ao    OOOC8AI            CO 310 I=IS,!T                                                       1863     56
 81   -OOOCA2I            DO 310 J=JS,JT                                                       1864     57
 o2    OOOCBAI            CO 310 K=KS,~T                                                       1865     58
 83    OOOC02I            A?OCI,J,K)=C:NOCI,J,Kl/OTT                                           1866     S9
 54    0000241            UOCI,J,Kl=UCI,J,Kl                                                   1867     60
 as    0000701            VO(I,J,K)=VCI,J,Kl                                                   1868     61
 86    OOOOSC I           w0C!,J,K)=w(!,J,K)                                                   1S69     62
 37    OOOE08I            TMOCI,J,Kl=TMCI,J,K)                                                 1870     63
 88    OOOE54I            DKOCI,J,K)=D~CI,J,Kl                                                 18 71    64
 89    OOOEAO!            OEGCI,J,Kl=OECI,J,Kl                                                 1872     65
 90    OOOEECI      310   CONTINUE                                                             1a73     66
 91    0001=34!           ~c:HQN                                                               1874     67
 92    :J00i=3AI          !:NO                                                                 1875     68
NO ERRORS:F7D ROS-01.0C SUo~CUT!N: SYMOL:T         02/21/86 10:01:5~   TABLE S 0 ACE:   7 K5
STATEMENT auFFEq:   20 LIN:S/1321 ~YTES      STACK $?ACE: 131 ~OROS
SINGLE PR:CISION FLOATING DT su 0 DORT R:~UIR:C •O~ :XECUTION                                                00
                                                                                                             .,, ::u
                                                                                                             "'CJ
                                                                                                             0 :z
                                                                                                                    e
                                                                                                             0).1'
                                                                                                             ::u r-
                                                                                                             0      "'TJ
                                                                                                             C:);)i
                                                                                                             ~ i')
                                                                                                             ,- rr.
                                                                                                             ~~
00      1    ::iOQ'JOO              S~oRCur:~E ~~LVAL(~W,IS,IT,JS,JT,~S,~T,F)
0
                                                                                                             1S76
        2    OJCuJ'-                D:McNSI:N F(21,1S,10)                                                    1 B77
        3    OOQOJ4                 CC'1,.0N                                                                 1878
                                 1/TU~/ SIGK,S:G:,CMU,C1,C2,CMU1,CMU2,:,CK,~I~UM,SMNU,.,ANV1 (800),          1879
        "5                       2 YN(e0Cl,Y~1C3CC),SINX(S0Gl,SINY(800l,SINZ(80Cl,AN~1(800l,                 1880
        0                         3 Y0 LN(!COl,TAUN(80Cl,I3CC800l,J~CC~COl,KSC(80Jl,I!TYCSOOJ,               18 81
        7                        .:. TA~wC5COl,G:NC21,1S,1Cl,~C(21,15,1Cl,!JL0(21,18,10l,IITO                1882
        3                  C-----!SSt~N ~ALL VALU:S                                                          1883
       9     ooo:;o .. r            CO 1G J=JS,JT                                                            H84      1
      10     JJOl.i23!              cc 10 K=~S,KT                                                            1865     2
      11     JOJ040:                F(!S-1,J,K)=P~•F(IS,J,K)                                                 1a86     3
      12     O•JOC~2I        10 F(IT•1,J,K): 0 w•~(!T,J,K)                                                   1687     4
      13     ::;00131,r             DO ZC !=!S-1,IT+1                                                        1868     5
      1"     JCC152I              :JC 2C:·   l(:K.S,KT                                                       1889     0
      15     JOG16~I              =cI,JS-1,K)=Pw•F(!,JS,K)                                                   1890     7
      16     OJ'.:1CC:       20   =cr,JT+1,K)=P~•;::(I,JT,K)                                                 1891     a
      17     J0025E!              JO 30 I=IS-1,!T+1                                                          1892     ~
      11:l   O'.l•J27CI           :c ~ □ J=JS-1,JT+1                                                         1893    10
      19     OCJ2'HI              FCI,J,KS-1)=~W•FC!,J,KS)                                                   1894    11
      20     OGC2;::AI       30   F(l,J,KT+1l=P~•F(I,J,KT)                                                   1695    12
      21     ,JQ,]38,H            DC 40 III,.1,IITC                                                          1896    13
      22     ooi:J3;:r            !=!~CCI!!)                                                                 1897    14
      23     0003~2r              J=JcC(Iril                                                                 1898    15
      24     O•JC3C6!             ~=K:C (II Il                                                               189~    16
      25     OiJJ3:lAr            GO TO (1,2,3,4,5..,6), I!TY(Irll                                           1900    17
      26     000.:.1 oI           FCI,J+1,K)=PW•FC!,J,K)                                                     1901    18
      27     000478:              :;c TC 4C                                                                  1902    19
      28     OCI047:r        2    F(I,J-1,K)=P~•~CI,J,K)                                                     1903    20
      29     0004:0I              (;OTO 4C                                                                   1904    21
      30     OJJ4E6I         3    F(I+1,J,K)=P~•F(!,J,K)                                                     1905    22
      31     00054SI              GO TO 4C                                                                   1906    23
      32     00054:I         4    F(I-1,J,K)=P~•F(l,J,~)                                                     1907    24
      33     JOOS:!OI             GO TO 4C                                                                   1908    25
      34     ,JC0536!        5    ~(I,J,K+1)=PW•F(I,J,K)                                                     19C9    ?6
      35     CC0616I              GO TO 4C                                                                   1910    27
     36      00061CI         6    F(I,J,K-1)=PW•FCI,J,Kl                                                     1911    29
     37      00067::I        40   CONTIN~:                                                                   1912    29
     33      00069-.!             •ETLRN                                                                     1913    30
     39      00069A!                                                                                         1914    31
     ~o =•~ORS:F70 K05-01.GC SUS<CUTI~E wALVAL         02/21/86 1C:02:24           TAeL= SPACE:       3 KS
     STITEME~T 3~FFEq:   20 LINES/1321 aYTES     STACK S?~CE: 154 WORDS
     5INGL: PR:CISION =LCATING PT SUPPORT R=QU!REO FOR EXECUTION
